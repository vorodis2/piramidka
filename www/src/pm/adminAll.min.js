!function(t){var e=window.webpackHotUpdate;window.webpackHotUpdate=function(t,i){!function(t,e){if(!_[t]||!x[t])return;for(var i in x[t]=!1,e)Object.prototype.hasOwnProperty.call(e,i)&&(m[i]=e[i]);0==--b&&0===v&&P()}(t,i),e&&e(t,i)};var i,n=!0,s="6a8af714770c8d3cbbda",a=1e4,r={},o=[],h=[];function l(t){var e=S[t];if(!e)return C;var n=function(n){return e.hot.active?(S[n]?-1===S[n].parents.indexOf(t)&&S[n].parents.push(t):(o=[t],i=n),-1===e.children.indexOf(n)&&e.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+t),o=[]),C(n)},s=function(t){return{configurable:!0,enumerable:!0,get:function(){return C[t]},set:function(e){C[t]=e}}};for(var a in C)Object.prototype.hasOwnProperty.call(C,a)&&"e"!==a&&"t"!==a&&Object.defineProperty(n,a,s(a));return n.e=function(t){return"ready"===d&&p("prepare"),v++,C.e(t).then(e,function(t){throw e(),t});function e(){v--,"prepare"===d&&(y[t]||T(t),0===v&&0===b&&P())}},n.t=function(t,e){return 1&e&&(t=n(t)),C.t(t,-2&e)},n}function u(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:i!==t,active:!0,accept:function(t,i){if(void 0===t)e._selfAccepted=!0;else if("function"==typeof t)e._selfAccepted=t;else if("object"==typeof t)for(var n=0;n<t.length;n++)e._acceptedDependencies[t[n]]=i||function(){};else e._acceptedDependencies[t]=i||function(){}},decline:function(t){if(void 0===t)e._selfDeclined=!0;else if("object"==typeof t)for(var i=0;i<t.length;i++)e._declinedDependencies[t[i]]=!0;else e._declinedDependencies[t]=!0},dispose:function(t){e._disposeHandlers.push(t)},addDisposeHandler:function(t){e._disposeHandlers.push(t)},removeDisposeHandler:function(t){var i=e._disposeHandlers.indexOf(t);i>=0&&e._disposeHandlers.splice(i,1)},check:A,apply:E,status:function(t){if(!t)return d;c.push(t)},addStatusHandler:function(t){c.push(t)},removeStatusHandler:function(t){var e=c.indexOf(t);e>=0&&c.splice(e,1)},data:r[t]};return i=void 0,e}var c=[],d="idle";function p(t){d=t;for(var e=0;e<c.length;e++)c[e].call(null,t)}var f,m,g,b=0,v=0,y={},x={},_={};function w(t){return+t+""===t?+t:t}function A(t){if("idle"!==d)throw new Error("check() is only allowed in idle status");return n=t,p("check"),(e=a,e=e||1e4,new Promise(function(t,i){if("undefined"==typeof XMLHttpRequest)return i(new Error("No browser support"));try{var n=new XMLHttpRequest,s=C.p+"hot-update/hot-update.json";n.open("GET",s,!0),n.timeout=e,n.send(null)}catch(t){return i(t)}n.onreadystatechange=function(){if(4===n.readyState)if(0===n.status)i(new Error("Manifest request to "+s+" timed out."));else if(404===n.status)t();else if(200!==n.status&&304!==n.status)i(new Error("Manifest request to "+s+" failed."));else{try{var e=JSON.parse(n.responseText)}catch(t){return void i(t)}t(e)}}})).then(function(t){if(!t)return p("idle"),null;x={},y={},_=t.c,g=t.h,p("prepare");var e=new Promise(function(t,e){f={resolve:t,reject:e}});m={};return T(0),"prepare"===d&&0===v&&0===b&&P(),e});var e}function T(t){var e;_[t]?(x[t]=!0,b++,(e=document.createElement("script")).charset="utf-8",e.src=C.p+"hot-update/hot-update.js",document.head.appendChild(e)):y[t]=!0}function P(){p("ready");var t=f;if(f=null,t)if(n)Promise.resolve().then(function(){return E(n)}).then(function(e){t.resolve(e)},function(e){t.reject(e)});else{var e=[];for(var i in m)Object.prototype.hasOwnProperty.call(m,i)&&e.push(w(i));t.resolve(e)}}function E(e){if("ready"!==d)throw new Error("apply() is only allowed in ready status");var i,n,a,h,l;function u(t){for(var e=[t],i={},n=e.slice().map(function(t){return{chain:[t],id:t}});n.length>0;){var s=n.pop(),a=s.id,r=s.chain;if((h=S[a])&&!h.hot._selfAccepted){if(h.hot._selfDeclined)return{type:"self-declined",chain:r,moduleId:a};if(h.hot._main)return{type:"unaccepted",chain:r,moduleId:a};for(var o=0;o<h.parents.length;o++){var l=h.parents[o],u=S[l];if(u){if(u.hot._declinedDependencies[a])return{type:"declined",chain:r.concat([l]),moduleId:a,parentId:l};-1===e.indexOf(l)&&(u.hot._acceptedDependencies[a]?(i[l]||(i[l]=[]),c(i[l],[a])):(delete i[l],e.push(l),n.push({chain:r.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:i}}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];-1===t.indexOf(n)&&t.push(n)}}e=e||{};var f={},b=[],v={},y=function(){console.warn("[HMR] unexpected require("+A.moduleId+") to disposed module")};for(var x in m)if(Object.prototype.hasOwnProperty.call(m,x)){var A;l=w(x);var T=!1,P=!1,E=!1,j="";switch((A=m[x]?u(l):{type:"disposed",moduleId:x}).chain&&(j="\nUpdate propagation: "+A.chain.join(" -> ")),A.type){case"self-declined":e.onDeclined&&e.onDeclined(A),e.ignoreDeclined||(T=new Error("Aborted because of self decline: "+A.moduleId+j));break;case"declined":e.onDeclined&&e.onDeclined(A),e.ignoreDeclined||(T=new Error("Aborted because of declined dependency: "+A.moduleId+" in "+A.parentId+j));break;case"unaccepted":e.onUnaccepted&&e.onUnaccepted(A),e.ignoreUnaccepted||(T=new Error("Aborted because "+l+" is not accepted"+j));break;case"accepted":e.onAccepted&&e.onAccepted(A),P=!0;break;case"disposed":e.onDisposed&&e.onDisposed(A),E=!0;break;default:throw new Error("Unexception type "+A.type)}if(T)return p("abort"),Promise.reject(T);if(P)for(l in v[l]=m[l],c(b,A.outdatedModules),A.outdatedDependencies)Object.prototype.hasOwnProperty.call(A.outdatedDependencies,l)&&(f[l]||(f[l]=[]),c(f[l],A.outdatedDependencies[l]));E&&(c(b,[A.moduleId]),v[l]=y)}var D,k=[];for(n=0;n<b.length;n++)l=b[n],S[l]&&S[l].hot._selfAccepted&&k.push({module:l,errorHandler:S[l].hot._selfAccepted});p("dispose"),Object.keys(_).forEach(function(t){!1===_[t]&&function(t){delete installedChunks[t]}(t)});for(var L,F,O=b.slice();O.length>0;)if(l=O.pop(),h=S[l]){var M={},B=h.hot._disposeHandlers;for(a=0;a<B.length;a++)(i=B[a])(M);for(r[l]=M,h.hot.active=!1,delete S[l],delete f[l],a=0;a<h.children.length;a++){var I=S[h.children[a]];I&&((D=I.parents.indexOf(l))>=0&&I.parents.splice(D,1))}}for(l in f)if(Object.prototype.hasOwnProperty.call(f,l)&&(h=S[l]))for(F=f[l],a=0;a<F.length;a++)L=F[a],(D=h.children.indexOf(L))>=0&&h.children.splice(D,1);for(l in p("apply"),s=g,v)Object.prototype.hasOwnProperty.call(v,l)&&(t[l]=v[l]);var R=null;for(l in f)if(Object.prototype.hasOwnProperty.call(f,l)&&(h=S[l])){F=f[l];var z=[];for(n=0;n<F.length;n++)if(L=F[n],i=h.hot._acceptedDependencies[L]){if(-1!==z.indexOf(i))continue;z.push(i)}for(n=0;n<z.length;n++){i=z[n];try{i(F)}catch(t){e.onErrored&&e.onErrored({type:"accept-errored",moduleId:l,dependencyId:F[n],error:t}),e.ignoreErrored||R||(R=t)}}}for(n=0;n<k.length;n++){var H=k[n];l=H.module,o=[l];try{C(l)}catch(t){if("function"==typeof H.errorHandler)try{H.errorHandler(t)}catch(i){e.onErrored&&e.onErrored({type:"self-accept-error-handler-errored",moduleId:l,error:i,originalError:t}),e.ignoreErrored||R||(R=i),R||(R=t)}else e.onErrored&&e.onErrored({type:"self-accept-errored",moduleId:l,error:t}),e.ignoreErrored||R||(R=t)}}return R?(p("fail"),Promise.reject(R)):(p("idle"),new Promise(function(t){t(b)}))}var S={};function C(e){if(S[e])return S[e].exports;var i=S[e]={i:e,l:!1,exports:{},hot:u(e),parents:(h=o,o=[],h),children:[]};return t[e].call(i.exports,i,i.exports,l(e)),i.l=!0,i.exports}C.m=t,C.c=S,C.d=function(t,e,i){C.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},C.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},C.t=function(t,e){if(1&e&&(t=C(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(C.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)C.d(i,n,function(e){return t[e]}.bind(null,n));return i},C.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return C.d(e,"a",e),e},C.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},C.p="src/adminAll/",C.h=function(){return s},l(9)(C.s=9)}([function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(t){THREE.DataTextureLoader.call(this,t),this.type=THREE.UnsignedByteType};n.prototype=Object.assign(Object.create(THREE.DataTextureLoader.prototype),{constructor:n,parse:function(t){var e=function(t,e){switch(t){case 1:console.error("RGBELoader Read Error: "+(e||""));break;case 2:console.error("RGBELoader Write Error: "+(e||""));break;case 3:console.error("RGBELoader Bad File Format: "+(e||""));break;default:case 4:console.error("RGBELoader: Error: "+(e||""))}return-1},i=function(t,e,i){e=e||1024;for(var n=t.pos,s=-1,a=0,r="",o=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));0>(s=o.indexOf("\n"))&&a<e&&n<t.byteLength;)r+=o,a+=o.length,n+=128,o+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));return-1<s&&(!1!==i&&(t.pos+=a+s+1),r+o.slice(0,s))},n=function(){var t=new Float32Array(1),e=new Int32Array(t.buffer);function i(i){t[0]=i;var n=e[0],s=n>>16&32768,a=n>>12&2047,r=n>>23&255;return r<103?s:r>142?(s|=31744,s|=(255==r?0:1)&&8388607&n):r<113?s|=((a|=2048)>>114-r)+(a>>113-r&1):(s|=r-112<<10|a>>1,s+=1&a)}return function(t,e,n,s){var a=t[e+3],r=Math.pow(2,a-128)/255;n[s+0]=i(t[e+0]*r),n[s+1]=i(t[e+1]*r),n[s+2]=i(t[e+2]*r)}}(),s=new Uint8Array(t);s.pos=0;var a,r,o,h,l,u,c=function(t){var n,s,a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,r=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,h=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(n=i(t)))return e(1,"no header found");if(!(s=n.match(/^#\?(\S+)$/)))return e(3,"bad initial token");for(l.valid|=1,l.programtype=s[1],l.string+=n+"\n";!1!==(n=i(t));)if(l.string+=n+"\n","#"!==n.charAt(0)){if((s=n.match(a))&&(l.gamma=parseFloat(s[1],10)),(s=n.match(r))&&(l.exposure=parseFloat(s[1],10)),(s=n.match(o))&&(l.valid|=2,l.format=s[1]),(s=n.match(h))&&(l.valid|=4,l.height=parseInt(s[1],10),l.width=parseInt(s[2],10)),2&l.valid&&4&l.valid)break}else l.comments+=n+"\n";return 2&l.valid?4&l.valid?l:e(3,"missing image size specifier"):e(3,"missing format specifier")}(s);if(-1!==c){var d=c.width,p=c.height,f=function(t,i,n){var s,a,r,o,h,l,u,c,d,p,f,m,g,b=i,v=n;if(b<8||b>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(b!==(t[2]<<8|t[3]))return e(3,"wrong scanline width");if(!(s=new Uint8Array(4*i*n))||!s.length)return e(4,"unable to allocate buffer space");for(a=0,r=0,c=4*b,g=new Uint8Array(4),l=new Uint8Array(c);v>0&&r<t.byteLength;){if(r+4>t.byteLength)return e(1);if(g[0]=t[r++],g[1]=t[r++],g[2]=t[r++],g[3]=t[r++],2!=g[0]||2!=g[1]||(g[2]<<8|g[3])!=b)return e(3,"bad rgbe scanline format");for(u=0;u<c&&r<t.byteLength;){if((m=(o=t[r++])>128)&&(o-=128),0===o||u+o>c)return e(3,"bad scanline data");if(m)for(h=t[r++],d=0;d<o;d++)l[u++]=h;else l.set(t.subarray(r,r+o),u),u+=o,r+=o}for(p=b,d=0;d<p;d++)f=0,s[a]=l[d+f],f+=b,s[a+1]=l[d+f],f+=b,s[a+2]=l[d+f],f+=b,s[a+3]=l[d+f],a+=4;v--}return s}(s.subarray(s.pos),d,p);if(-1!==f){switch(this.type){case THREE.UnsignedByteType:var m=f,g=THREE.RGBEFormat,b=THREE.UnsignedByteType;break;case THREE.FloatType:for(var v=f.length/4*3,y=new Float32Array(v),x=0;x<v;x++)o=y,h=3*x,l=void 0,u=void 0,l=(a=f)[(r=4*x)+3],u=Math.pow(2,l-128)/255,o[h+0]=a[r+0]*u,o[h+1]=a[r+1]*u,o[h+2]=a[r+2]*u;m=y,g=THREE.RGBFormat,b=THREE.FloatType;break;case THREE.HalfFloatType:v=f.length/4*3;var _=new Uint16Array(v);for(x=0;x<v;x++)n(f,4*x,_,3*x);m=_,g=THREE.RGBFormat,b=THREE.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:d,height:p,data:m,header:c.string,gamma:c.gamma,exposure:c.exposure,format:g,type:b}}}return null},setDataType:function(t){return this.type=t,this},load:function(t,e,i,n){return THREE.DataTextureLoader.prototype.load.call(this,t,function(t,i){switch(t.type){case THREE.UnsignedByteType:t.encoding=THREE.RGBEEncoding,t.minFilter=THREE.NearestFilter,t.magFilter=THREE.NearestFilter,t.generateMipmaps=!1,t.flipY=!0;break;case THREE.FloatType:case THREE.HalfFloatType:t.encoding=THREE.LinearEncoding,t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,i)},i,n)}})},function(t,e,i){"use strict";var n=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MenuVerh",this.fun=i,this.par=e;var n,s,a=this;this.param=e.param,this.dCont=new DCont(e.dCont),this.userLabel=null,this.userLogoutButton=null,this.init=function(){if(this.panel=new DPanel(this.dCont,0,0),this.butt=new DButton(this.panel,0,0,"",function(){},""),this.butt.boolFond=!1,this.butt.scalePic=.5,mhbd.getKeyId("group1",55,function(t){a.butt.link=t.icon}),this.dContUzer=new DCont(this.dCont),this.userLogoutButton=new DButton(this.dContUzer,-50,10,"",function(t){a.fun("openAccM")}),this.userLogoutButton.width=this.userLogoutButton.height=50,this.userLogoutButton.borderRadius=50,this.sizeWindow(),this.setParam1(),null!=mhbd.uzer&&(mhbd.uzer.icon&&(this.userLogoutButton.link=mhbd.uzer.icon),1==this.param.debug)){this.userLabel=new DLabel(this.dContUzer,-610,10,""),this.userLabel.textAlign="Right",this.userLabel.width=550;var t=mhbd.token+" \n "+JSON.stringify(mhbd.uzer.userSort)+" / "+mhbd.uzer.id;this.userLabel.text=t}},this.setParam1=function(){this.panel.height=this.param.wh2+2*this.param.otstup,this.panel.x=this.param.otstup,this.panel.y=this.param.otstup,this.butt.x=this.param.otstup,this.butt.y=this.param.otstup,this.butt.width=150+3*this.param.otstup,this.butt.height=50,this.sizeWindow()},this.sizeWindow=function(t,e,i){t&&(n=t,e,s=i),null!=this.panel&&(this.panel.width=n/s-(this.param.otstup+this.panel.x),this.dContUzer.x=this.panel.width)}};var s=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MenuLeft",this.fun=i,this.par=e;var n=this;this.param=e.param,this.dCont=new DCont(e.dCont);trace("languages",languages);this.init=function(){},this.three=new DThreeBool(this.dCont,0,0,function(t,e,i){var s="openKey"!=t?t.obj.name:e.name;null==s&&(s=e.obj.name),n.fun("sobThree",s)});var s,a,r;this.startObj=function(t){t,s=t.three.array,this.sortUzer(s);for(var e=0;e<s.length;e++)this.st(s[e])},this.sortUzer=function(t){trace("sortUzer",t);for(var e=0;e<t.length;e++)trace("sortUzer==",e,t[e]);if(mhbd.uzer&&mhbd.uzer.userSort){for(e=0;e<mhbd.uzer.userSort.length;e++)if(4==mhbd.uzer.userSort[e])return;var i=["6bc61d14-2a531bdf","334fdbe5-17ecf25Z","454a2173-56f77fb6","ac8beeb7-d89755cd","d498567b-ada85d9a"];for(e=0;e<mhbd.uzer.userSort.length;e++)2==mhbd.uzer.userSort[e]&&i.push("48f269b9-eb98c946"),5==mhbd.uzer.userSort[e]&&i.push("99c114ZZ-384b8658"),6==mhbd.uzer.userSort[e]&&(i.push("b403b2eZ-c5205a87"),i.push("d498567b-ada85d9a")),8==mhbd.uzer.userSort[e]&&(i.push("3f631fc7-91cc3c1Z"),i.push("e7b1c5fa-c85dc6d5"));for(e=t.length-1;e>=0;e--){for(var n=!1,s=0;s<i.length;s++)i[s]==t[e].uuid&&(n=!0,s=9999);0==n&&t.splice(e,1)}}else;},this.st=function(t){var e=t;if(trace(e),$.ajax({type:"GET",url:this.par.param.server+e.key+"/"+e.id+"/",success:function(t){0,e.link=t.icon,e.objIcon=t,0==mhbd.debug&&t.texts&&t.texts[window.languages.key]&&(e.title=t.texts[window.languages.key]),n.stTest()}}),t.array&&0!=t.array.length)for(var i=0;i<t.array.length;i++)this.st(t.array[i])},this.stTest=function(t){for(var e=0;e<s.length;e++)if(null==this.stTest111(s[e]))return;trace("languages three",s),this.three.setObj(s,"array","title"),n.fun("openArr",s)},this.stTest111=function(t){if(null==t.link)return null;if(t.array&&0!=t.array.length)for(var e=0;e<t.array.length;e++)if(null==this.stTest111(t.array[e]))return null;return!0},this.setParam=function(){this.three.x=this.param.otstup,this.three.y=4*this.param.otstup+this.param.wh2,this.three.heightBut=this.param.wh,1==this.param.mobile?this.three.width=this.param.wh+2*this.param.otstup:this.three.width=this.param.wb+2*this.param.otstup,this.sizeWindow()},this.openField=function(t){this.three.openKey("name",t)},this.sizeWindow=function(t,e,i){t&&(t,a=e,r=i),this.three.height=a/r-(5*this.param.otstup+this.param.wh)}};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var u=function(t){function e(t,i,n,s,r){var h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),h=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(e).call(this));var u=l(l(h));h.type="MDLeng",null==dcmParam&&(dcmParam=new DCM),h.x=i||0,h.y=n||0,h.fun=r,h.type="MTovars",h._width=840,h._height=500,h._value=null,h._xzbool=-1,h.w=100,h.www=h._width/2,h.hhh=140,h.wh=28,h.otstup=2,h.wb=180;var d=(h._width-h.wb-4*h.otstup)/2;h._glavLabel=null,h.dContLabel=new DCont(l(l(h))),h.dContLabel.x=h.x,h.dContLabel.y=h.y,h.panelLabel=new DPanel(h.dContLabel),h.panelLabel.width=h._width,h.panelLabel.height=h.hhh,h.labelG=void 0,h.dCont=new DCont(l(l(h))),h.dCont.x=h.x,h.dCont.y=h.y,h.panel=new DPanel(h.dCont,h.otstup,h.otstup),h.panel.width=d,h.panel.height=h.hhh,h.panel1=new DPanel(h.dCont,h.otstup,h.otstup),h.panel1.width=2*(h.wh+h.otstup)+h.otstup,h.panel1.height=h.wh+2*h.otstup,h.panel.visible=!1;var p=h.otstup;h.chek=new DCheckBox(h.panel1,p,h.otstup," ",function(){u.xzbool=this.value,u._index=-1,u.index=0}),h.chek.width=h.chek.height=h.wh,p+=h.chek.width+h.otstup,h.bat0=new DButton(h.panel1,p,h.otstup,"",function(){null==u.obj.array&&(u.obj.array=[]),u.obj.array.unshift(u.getNewObj()),u.dragBat(),u._index=-1,u.index=0,u.fun("saveTime")}),h.bat0.width=h.bat0.height=h.wh,p+=h.bat0.width+h.otstup,mhbd.getKeyId("group1",2,function(t){u.bat0.link=t.icon}),h.bat1=new DButton(h.panel1,p,h.otstup,"",function(){if(u.obj.array[u.index]){var t=u.index;--t<0&&(t=0),u.obj.array.splice(u.index,1),u.dragBat(),u.index=t,u.fun("saveTime")}}),h.bat1.width=h.bat1.height=h.wh,p+=h.bat1.width+h.otstup,mhbd.getKeyId("group1",25,function(t){u.bat1.link=t.icon}),h.chek1=new DCheckBox(h.panel1,p,h.otstup," ",function(){u.oCild.b=this.value,u.fun("saveTime")}),h.chek1.width=h.chek1.height=h.wh,h.chek1.x=d-2*h.wh,p+=h.chek.width+h.otstup,h.chek2=new DCheckBox(h.panel1,p,h.otstup," ",function(){u.oCild.b1=this.value,u.fun("saveTime")}),h.chek2.width=h.chek2.height=h.wh,h.chek2.x=d-h.wh,p+=h.chek2.width+h.otstup,h.panel4=new DPanel(h.dCont,h.otstup,h.otstup),h.panel4.width=d,h.panel4.x=h.panelLabel.width-h.panel4.width-h.otstup,h.panel4.height=h.hhh,h.label=new DTextArea(h.panel4,h.otstup,h.otstup),h.label.fontSize=12,h.label.width=h.panel4.width-2*h.otstup,h.label.textAlign="left",h.label.height=h.panel4.height-2*h.otstup,h.panel2=new DPanel(h.dCont,h.otstup,4*h.otstup+h.wh),h.panel2.width=1.5*(h.wb+h.otstup),h.panel2.height=h.hhh-h.panel2.y-2*h.otstup,h.imag=new DImage(h.panel4,h.otstup,h.otstup,null,function(){this.width=this.picWidth*(this.height/this.picHeight)}),h.imag.height=h.label.height;var f=[];f.push({id:1,name:"1 Не приорит",help:"Данная ветка не будет приоритетной, но если да то бедет как Площадь Ид 2"}),f.push({id:2,name:"2 Площадь",help:"считаем площадь от обьектов в ней,\n формула счета:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\n(arae/((width+num[0])*(height+num[0])))*num[1]\n"}),f.push({id:3,name:"3 отГраней",help:"Вокруг обьекта, обьем, формула счета.\n var a=0;\n if(bool[0]) a+=width*delph*num[0]\nif(bool[1]) a+=height*delph*num[1]\nif(bool[2]) a+=width*height*num[2]\n str[0]-хрень для выборки товара из gpoup "}),f.push({id:4,name:"4 к.Цоколь",help:"Считает толщину тены, вычитая толщину красты цоколя. Делем на обьем кирпича с отступами от num: \n (delhpSten/(delhpSten-пирогКро)*(среднию длину стены))/((width+num[0])*(height+num[1])*(delph+num[2]))\n"}),f.push({id:5,name:"5 пстЛиния",help:"Применяеться к посто оброботчику. Берет длину стены и по ней добовляет товары \n if(bool[0]==true)  if(bool[1]==true) Переборка товар.delph==max== num[1] если false первый в списке if(bool[2]==true) то умножим длину на num[2]\n\nif(bool[0]==false)длина*глубину пирога*num[0] - этот обьем поделим на обьем товара"}),f.push({id:7,name:"7 Сложный Выбор",help:"Подбор if(bool[0,1,2]==true) ширене/высоте/глубине \n num[0] количество на метр квадратный \nnum[1] размер поиска от выбора bool[] num[2] добовляет глубину к поиску  ",idLink:173}),f.push({id:8,name:"8 ПлЦоколь+",help:"считаем площадь от обьектов в ней,\n формула счета:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\n(arae/((width+num[0])*(height+num[0])))*num[1]\n",idLink:190});for(var m=[],g=0;g<f.length;g++)m.push(f[g].name);h.panel3=new DPanel(h.dCont,h.otstup,h.otstup),h.panel3.x=(h._width-h.wb)/2,h.panel3.width=h.wb,h.panel3.height=h.panel.height-3*h.otstup,h.panel3.visible=!1,h.comboBox=new DComboBoxOld(h.panel3,h.otstup,h.otstup,m,function(){u.oCild.tId=f[this.index].id,u.label.text=f[this.index].help,f[this.index].idLink?(mhbd.getKeyId("group1",f[this.index].idLink,function(t){u.imag.link=t.icon}),u.imag.visible=!0):u.imag.visible=!1,u.fun("saveTime")}),h.comboBox.width=h.panel3.width-2*h.otstup,h.comboBox.height=h.wh,p+=h.otstup,h.comboBox1=new DComboBoxOld(h.panel,p-2*h.wh,h.otstup,m,function(){u.oCild.id=u.data[this.index].id,u.dragBat();var t=u.index;u._index=-1,u.index=t,u.fun("saveTime")}),h.comboBox1.width=d-p,h.comboBox1.height=h.wh+4,h.comboBox1.visible=!1,h.panel5=new DPanel(h.dCont,h.otstup,2*h.otstup+h.wh),h.panel5.width=d,h.panel5.height=h.hhh-h.wh-2*h.otstup,h.panel5.alpha=.75,h.gallery=new c(h.panel2,h.otstup,h.otstup,function(t){u.index=this.index},l(l(h))),h.gallery.width=h.panel5.width-2*h.otstup,h.gallery.height=h.panel5.height-2*h.otstup,h.gallery.kolII=1,h.gallery.widthPic=h.gallery.width-2*h.otstup,h.gallery.heightPic=32;var b=2*h.otstup+h.wh;for(g=0;g<3;g++)h.llll=new DLabel(h.panel3,h.otstup+50+(32+h.otstup)*g,b,g+" ");b+=16+h.otstup,h.bbb=[],h.nnn=[],h.sss=[],new DLabel(h.panel3,h.otstup,b+10,"bool");for(g=0;g<3;g++)h.bbb[g]=new DCheckBox(h.panel3,h.otstup+50+(32+h.otstup)*g,b," ",function(){u.oCild.bool[this.idArr]=this.value,u.fun("saveTime")}),h.bbb[g].idArr=g;b+=24+h.otstup,new DLabel(h.panel3,h.otstup,b+10,"num");for(g=0;g<3;g++)h.nnn[g]=new DInput(h.panel3,h.otstup+50+(32+h.otstup)*g,b," ",function(){u.oCild.num[this.idArr]=1*this.value,u.fun("saveTime")}),h.nnn[g].idArr=g,h.nnn[g].width=32,h.nnn[g].height=h.wh;b+=h.wh+h.otstup,new DLabel(h.panel3,h.otstup,b+10,"str");for(g=0;g<3;g++)h.sss[g]=new DInput(h.panel3,h.otstup+50+(32+h.otstup)*g,b," ",function(){u.oCild.str[this.idArr]=this.value+"",u.fun("saveTime")}),h.sss[g].idArr=g,h.sss[g].width=32,h.sss[g].height=h.wh;return b+=h.wh+h.otstup,h.textUpdate=function(){this.labelG=new DLabel(this.panelLabel,this.otstup,this.otstup,""),this.labelG.width=700,this.labelG.text=this._glavLabel,this.dCont.y=this.labelG.fontSize+2*this.otstup,this.reSize()},h.reSize=function(){var t=this.hhh;null!=this.labelG&&(t+=16+2*this.otstup),this.height=t+2,u.fun("ReSize")},h.data,h.setGroup=function(t){this.data=t,this.panel.visible=!0;for(var e=[],i=0;i<t.length;i++)e.push(t[i].id+":"+t[i].name);u.comboBox1.array=e,u.comboBox1.userData=t,this.dragBat();var n=u.index;u._index=-1,u.index=n,this.reSize()},h.getNewObj=function(){var t={};return this.data?t.id=this.data[this.comboBox1.index].id:t.id=1,t.tId=f[0].id,t.bool=[!1,!1,!1,!1],t.num=[0,0,0],t.str=["","",""],t},h.array=[],h.obj,h.setObj=function(t){this.obj=t,null!=this.obj&&null!=this.obj||(this.obj={}),"string"==typeof this.obj&&(this.obj={}),null==this.obj.obj&&(this.obj.obj=this.getNewObj(),u.fun("saveTime")),this.claer(),null==this.obj.array&&(this.obj.array=[],u.fun("saveTime")),this.dragBat(),this._value=this.obj,u._index=-1,u.index=0,this.xzbool=!1},h.dragBat=function(){this.claer(),this.obj&&this.obj.array&&this.gallery.start(this.obj.array)},h.claer=function(){for(var t=0;t<this.array.length;t++)this.array[t].visible=!1},h.oCild,h.dragChild=function(t){this.oCild=t;for(var e=0;e<this.bbb.length;e++)this.bbb[e].value=this.oCild.bool[e];for(e=0;e<this.nnn.length;e++)this.nnn[e].value=this.oCild.num[e];for(e=0;e<this.sss.length;e++)this.sss[e].value=this.oCild.str[e];for(e=0;e<f.length;e++)t.tId==f[e].id&&(this.label.text=f[e].help,this.comboBox.index=e,f[e].idLink?(mhbd.getKeyId("group1",f[e].idLink,function(t){u.imag.link=t.icon}),this.imag.visible=!0):this.imag.visible=!1);1==t.b?this.chek1.value=!0:this.chek1.value=!1,1==t.b1?this.chek2.value=!0:this.chek2.value=!1},mhbd.getKeyList("group",function(t){u.setGroup(t)}),h.xzbool=!1,h}var i,n,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,DCont),i=e,(n=[{key:"xzbool",set:function(t){this._xzbool=t,this.comboBox1.visible=t,this.comboBox1.activMouse=t,this.bat1.activMouse=t,this.bat0.activMouse=t,this.chek.value=t,this.panel5.visible=!t},get:function(){return this._xzbool}},{key:"glavLabel",set:function(t){this._glavLabel=t,this.textUpdate()},get:function(){return this._glavLabel}},{key:"value",set:function(t){this._value=t,this.setObj(t)},get:function(){return trace("vvvvvv",this._value),this.obj}},{key:"index",set:function(t){this._index!=t&&(this._index=t,this.gallery.index=t,this.obj&&this.obj.array&&(this.obj.array[t]?(this.dragChild(this.obj.array[t]),this.panel3.visible=!0):this.panel3.visible=!1),0==this._xzbool&&this.obj&&(this.dragChild(this.obj.obj),this.panel3.visible=!0))},get:function(){return this._index}},{key:"x",set:function(t){this._x=t,this.panel&&(this.panel.x=t)},get:function(){return this._x}},{key:"y",set:function(t){this._y=t,this.panel&&(this.panel.y=t)},get:function(){return this._y}},{key:"width",set:function(t){this._width!=t&&(this._width=t)},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t)},get:function(){return this._height}}])&&r(i.prototype,n),s&&r(i,s),e}();function c(t,e,i,n,s){DGallery.call(this,t,e,i,n);this.type="Gall44",this.par=s,this.createZamen=function(){return new d(this.content,0,0,this.downBtn,this)}}function d(t,e,i,n,s){DBox.call(this,t,e,i,n),this.type="BoxXZ44";var a,r=this;this.par=s,this.label.activMouse=!1,this.startLoad=function(t){this.object=t,r.funLoad();var e="resources/image/notpic.png",i="Не нашол";if(this.par.par.data)for(var n=this.par.par.data.length-1;n>=0;n--)this.par.par.data[n].id==t.id&&(e=this.par.par.data[n].icon,i=this.par.par.data[n].name);this.label.text=t.id+" : "+i,this.label.visible=!0,this.image.link=e,this.image.visible=!0},this.draw=function(){this.image.visible=!1,this.label.x=350,this.label.y=10;this._height;a=this._height/this.image.picHeight,this.image.width=this.image.picWidth*a,this.image.height=this.image.picHeight*a,this.image.x=0,this.image.y=0,this.label.x=this.image.width+5,this.label.y=this._height-24,this.label.width=this.panel.width,this.image.visible=!0,this.postDraw&&this.postDraw()}}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}c.prototype=Object.create(DGallery.prototype),c.prototype.constructor=c,Object.defineProperties(c.prototype,{index:{set:function(t){null!=this.array[t]&&this.korektPoIndex(t),this._index=t;for(var e=0;e<this.array.length;e++)this._index==e?this.array[e].activ=!0:this.array[e].activ=!1},get:function(){return this._index}}}),d.prototype=Object.create(DBox.prototype),d.prototype.constructor=d;var v=function(t){function e(t,i,n,s,a){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?b(t):e}(this,m(e).call(this));var o=b(b(r));r.type="MDLeng",null==dcmParam&&(dcmParam=new DCM),r.x=i||0,r.y=n||0,r.fun=a,r._arrayKey=[],r._value=null,r._glavLabel=null,r._width=100,r._height=100,r.otstup=5,r.dCont=new DCont(b(b(r))),r.panel=new DPanel(r.dCont,0,0),r.panel.x=r.x,r.panel.y=r.y,r.panel.width=r.width,r.panel.height=r.height,r.dtaHeight=28,r.dtaWidth=208,r.label=void 0,r.aa=[],r.claer=function(){for(var t=0;t<this.aa.length;t++)this.aa[t].visible=!1,this.aa[t].ooo.visible=!1},r.sob=function(){o._value[this.key]=this.value,o.fun()},r.redxz=function(){this.claer(),null==this._value&&(this._value={}),this._glavLabel&&(this.label=new DLabel(this.panel,this.otstup,this.otstup,this._glavLabel));for(var t=0;t<this._arrayKey.length;t++)null==this.aa[t]&&(this.aa[t]=new DTextArea(this.panel,100,t*(28+this.otstup)+this.otstup,"",o.sob),this.aa[t].height=this.dtaHeight,this.aa[t].width=this.dtaWidth,this.aa[t].ooo=new DLabel(this.panel,0,t*(28+this.otstup)+this.otstup,"")),this.aa[t].ooo.text=this._arrayKey[t],this.aa[t].key=this._arrayKey[t],null!=this._value[this._arrayKey[t]]?this.aa[t].value=this._value[this._arrayKey[t]]:this.aa[t].value="",this.aa[t].visible=!0,this.aa[t].ooo.visible=!0;o.setSize(),this.height=this._arrayKey.length*(o.dtaHeight+this.otstup)+this.otstup,o.fun("ReSize")},r.redAK=function(){this.redxz()};var h=0,l=0;return r.setSize=function(){this.panel.width=this.width,null!=this.label&&(l=1.5*this.label.getTextWidth());for(var t=0;t<this.aa.length;t++){var e=this.aa[t].ooo.getTextWidth();e>h&&(h=e)}for(t=0;t<this.aa.length;t++)this.aa[t].ooo.x=l+this.otstup,this.aa[t].x=h+l+2*this.otstup,this.aa[t].width=this._width-(h+l+3*this.otstup)},mhbd.getKeyList("langs",function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);o.arrayKey=e,o.redxz()}),r}var i,n,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(e,DCont),i=e,(n=[{key:"glavLabel",set:function(t){this._glavLabel=t,this.redxz()},get:function(){return this._glavLabel}},{key:"value",set:function(t){this._value=t,this.redxz()},get:function(){return this._value}},{key:"arrayKey",set:function(t){this._arrayKey=t,this.redAK()},get:function(){return this._arrayKey}},{key:"x",set:function(t){this._x=t,this.panel&&(this.panel.x=t)},get:function(){return this._x}},{key:"y",set:function(t){this._y=t,this.panel&&(this.panel.y=t)},get:function(){return this._y}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.panel.width=t,this.setSize())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.panel.height=t)},get:function(){return this._height}}])&&f(i.prototype,n),s&&f(i,s),e}();function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var _=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MCParam",this.par=e;var s,a,r=this;this.fun=n,this._active=!0,this._bool=!1,this.typeComp=i,this.fontSize=16,this._x=0,this._y=0,this._otstup=this.par._otstup,this._verticel=e._verticel,this.param=void 0,this._width=100,this._height=0==this._verticel?this.par.height-2*this.otstup:22,this._colorText=this.par.colorText,this._titleHron=void 0,this.title=void 0,this.cmena=void 0,this.cmenaGal=void 0,this.value=void 0,this.idArr=-1,this.uuid=Math.random(),this.typePosit=void 0,this.priority=50,this.upPanel=[],this.panel=void 0,this.dCont=new DCont,this.init=function(){this.label=new DLabel(this.dCont,this.otstup,0,"null"),this.label.bold=!0,this.label.color=this.par.colorText,this.label.activMouse=!0,this.pan=new DPanel(this.dCont,0,0),this.pan.height=.5,this.pan.x=this.label.x,this.pan.y=this.height-this.otstup/2-this.pan.height,this.pan.color="#ffffff",this.pan.alpha=1,this.pan.visible=!1,this.panel=new DPanel(this.dCont,0,0),this.panel.height=this._height,this.panel.alpha=0,this.panel.div.addEventListener("mousedown",r.mousedown),this.comp=this.addComponent(this.typeComp)},this.down=function(t){},this.object=void 0,this.setObj=function(t){this.object=t,t.width&&(this.width=t.width),t.height&&(this.height=t.height),this.param=t.param,this.title=t.title,//!=undefined?o.title:undefined
"null"==t.title&&(this.title=void 0),this.cmena=t.cmena,//!=undefined?o.cmena:undefined
"null"==t.cmena&&(this.cmena=void 0),this.value=t.value,t.priority&&(this.priority=t.priority),this.applyObj()},this.obj,this.setObjParam=function(t){this.obj=t;var e=!1;for(var i in t)i==this.param&&(e=!0);if(0!=e)if(null==this.cmena){if(this.pan.visible=!1,a=!0,this.title&&(this.title+="",-1!=this.title.indexOf("getTypeSort"))){this.label.value="";var n=(s=this.title.split(","))[2]||"name";mhbd.getKeyList(s[1],function(t){for(var e=0;e<t.length;e++)t[e].id==r.obj[r.param]&&(r.label.value=t[e][n],r.titleHron=t[e][n])}),a=!1}if("up"==this.param){if(0==this.obj[this.param])if(this.label.value="Не заапрувлен",this.label.visible=!1,null==this.upPanel[0]){var o=new DPanel(this.dCont,this.otstup,0);o.width=o.height=20,o.color=dcmParam.color,o.alpha=.4,o.y=this.height-o.height,this.upPanel.push(o)}else for(var h=0;h<this.upPanel.length;h++)this.upPanel[h].visible=!1,0==h&&(this.upPanel[h].visible=!0);if(1==this.obj[this.param])if(this.label.value="Заапрувлен",this.label.visible=!1,null==this.upPanel[1]){var l=new DPanel(this.dCont,this.otstup,0);l.width=l.height=20,l.color=dcmParam.colorActive,l.alpha=1,l.y=this.height-l.height,this.upPanel.push(l)}else for(h=0;h<this.upPanel.length;h++)this.upPanel[h].visible=!1,1==h&&(this.upPanel[h].visible=!0);a=!1}if(a&&(this.titleHron=this.obj[this.param],this.title=this.obj[this.param],this.label.value=this.obj[this.param]),this.label._text){if(this.label.fontSize*this.label._text.length*.7>this._width){var u=Math.floor(this._width/(.7*this.label.fontSize));this.label.value=this.label._text.slice(0,u)+".."}else this.label.value=this.titleHron;this.label.y=this._height-1.5*this.fontSize}}else"DImage"==this.comp.type&&(this.comp.link=t[this.param])},this.applyObj=function(){this.label.value=this.title,this.label.width=this.width,this.pan.width=this.label.getTextWidth(),this.title&&this.cmena?this.pan.visible=!0:this.pan.visible=!1;var t=!0;if(null==this.title&&(t=!1),this.bool=!t,t=!0,null==this.cmena&&(t=!1),this.panel.visible=t,null!=this.cmena&&("MDLeng"==this.cmena&&(this.comp.value=this.value,this.title&&(this.label.visible=!1,this.comp.glavLabel=this.title)),"MTovars"==this.cmena&&(this.comp.value=this.value,this.title&&(this.label.visible=!1,this.comp.glavLabel=this.title))),null!=this.value&&null!=this.cmena){if("null"==this.value&&(this.value=" "),"DComboBox"==this.cmena)if(this.value&&-1!=(this.value+"").indexOf("getTypeSort")){s=(this.value+"").split(",");var e=[],i=s[2]||"name";mhbd.getKeyList(s[1],function(t){for(var n=0;n<t.length;n++)e.push(t[n][i]);"group"==s[1]&&(r.getObjThree(t),e=o,t=h),trace("=========",s[1],r.comp.array),r.comp.array=e,r.comp.arrayXZ=t,r.comp.arrayIdentification=s[1];var a=(r.param+"").split(",");if("sobSmenaDB"==a[0]&&a[1]&&a[2])for(n=0;n<t.length;n++)t[n].id==a[2]&&(r.comp.index=n)})}else this.comp.array=(this.value+"").split(",");if("DButton"==this.cmena){if("string"==typeof this.value){var n;t=!0;"png"!=(n=this.value.split("."))[n.length-1]&&"jpg"!=n[n.length-1]&&"gif"!=n[n.length-1]||(this.comp.text="",this.comp.link=this.value,t=!1),(n=this.value.split(","))[2]&&"iconId"==n[0]&&(this.comp.text="",this.comp.link=this.value,t=!1,mhbd.getKeyId(n[1],1*n[2],function(t){r.comp.link=t.icon})),t&&(this.comp.text=this.value)}"object"==y(this.value)&&this.value.id&&this.value.key&&mhbd.getKeyId(this.value.key,this.value.id,function(t){r.comp.link=t.icon}),1==this.object.bool&&this.comp.startFile()}"DImage"==this.cmena&&(this.comp.link=this.value),"DCheckBox"==this.cmena&&(this.comp.value=this.value),"DInput"==this.cmena&&(this.comp.text=this.value)}(0==this._verticel?r.comp&&(r.comp.x=0,r.comp.y=0):r.comp&&(this.panel.visible=!1,r.comp.x=this.par.width/2,r.comp.width=this.par.width/2-2*this._otstup,r.comp.height=22,r.comp.y=0,this.comp.visible=!0,this.dCont.add(this.comp),"MDLeng"!=r.comp.type&&"MTovars"!=r.comp.type||(r.comp.x=0,r.comp.width=20,r.width=r.par.width-2*this.otstup,r.height=r.comp._height),"DImage"==r.comp.type&&(r.comp.width=128,r.comp.height=128,r.height=r.comp.width),"DButton"==r.comp.type&&""==r.comp.text&&"icon"==r.param&&(r.comp.width=128,r.comp.height=128,r.width=r.comp.width,r.height=r.comp.width)),null==this.comp&&null==this.title)&&(new DPanel(null,0,0," ").alpha=0,this.pan.visible=!1)};var o=[],h=[],l={};this.getObjThree=function(t){t,l={},o=[],h=[];for(var e=0;e<t.length;e++)l[t[e].id]=t[e];var i=[];for(e=0;e<t.length;e++)if(-2==t[e].parent){i=this.getObjThree1(t[e]);break}for(e=t.length-1;e>=0;e--)if(-1==t[e].parent){var n={};n.id=t[e].id,n.object=t[e],n.array=[],i.push(n)}trace(i),this.setRecurs(i,"")},this.getObjThree1=function(t){for(var e=[],i=t.children.split(","),n=0;n<i.length;n++)if(null!=l[1*i[n]]){var s={};s.id=1*i[n],s.object=l[1*i[n]],s.array=this.getObjThree1(s.object),e.push(s)}return e},this.setRecurs=function(t,e){for(var i=0;i<t.length;i++)0==t[i].array.length?(o.push(e+t[i].object.name),h.push(t[i].object)):(o.push(e+t[i].object.name),h.push(t[i].object),this.setRecurs(t[i].array,e+"-----"))},this.loadPic=function(){var t=r.height/this.comp.picHeight;r.width/this.comp.picWidth<t&&(t=r.width/this.comp.picWidth),this.comp.height=this.comp.picHeight*t,this.comp.width=this.comp.picWidth*t,this.comp.y=(this.height-this.comp.height)/2},this.sobCmena=function(t){this.object.activComp=this.comp,r.fun("sobCmena",r.object,t)},this.addComponent=function(t){var e=null;return"DComboBox"==t&&(e=new DComboBoxOld(null,0,0,[],function(){null==this.arrayIdentification?r.sobCmena(this.array[this.index]):r.sobCmena(this.arrayXZ[this.index].id)})),"DButton"==t&&((e=new DButton(null,0,0,"",function(t){null!=t?r.sobCmena(this.files[0]):r.sobCmena("delete")})).fun_mousedown=function(){r.sobCmena()}),"DImage"==t&&(e=new DImage(null,0,0,null,function(){r.loadPic()})),"DInput"==t&&(e=new DInput(null,0,0," ",function(){r.sobCmena(this.text.trim())})),"DCheckBox"==t&&(e=new DCheckBox(null,0,0," ",function(){r.sobCmena(this.value)})),"MDLeng"==t&&(e=new v(null,0,0,null,function(t){if("ReSize"==t)return r.height=this.height,void r.fun("ReSize");r.sobCmena(JSON.stringify(this.value))})),"MTovars"==t&&(e=new u(null,0,0,null,function(t){if("ReSize"==t)return r.height=this.height,void r.fun("ReSize");"saveTime"==t&&null!==this.value&&"null"!==this.value&&" "!==this.value&&r.sobCmena(JSON.stringify(this.value))})),e&&(e.visible=!1),e&&e.height&&(e.height=this._height),e&&e.width&&(e.width=this._width),e&&e.fontSize&&(e.fontSize=this.fontSize),e},this.setColor=function(){this.label&&(this.label.color=this._colorText),this.comp&&this.comp.text&&this.comp._colorText&&(this.comp._colorText=this._colorText),this.comp&&this.comp.text&&this.comp._colorText1&&(this.comp._colorText1=this._colorText)},this.setSize=function(){if(this.label&&(this.label.width=this._width,this.label.height=this._height,this.label._text))if(this.label.fontSize*this.label._text.length*.7>this._width){var t=Math.floor(this._width/this.label.fontSize);this.label.value=this.label._text.slice(0,t).trim()+".."}else{var e=this.title;null!=this.titleHron&&null!=this.titleHron&&"null"!=this.titleHron&&(e=this.titleHron),this.label.value=e}this.panel&&(this.panel.width=this._width,this.panel.height=this._height),this.comp&&(this.comp.width=this._width,this.comp.height=this._height),this.comp&&"DImage"==this.comp.type&&this.loadPic()},this.mousedown=function(t){r.bool=!0,r.fun("mdBool",r)},this.clear=function(){if(this.active=!1,this.bool=!1,this.upPanel&&this.upPanel[0])for(var t=0;t<this.upPanel.length;t++)this.upPanel[t].visible=!1},this.setBool=function(t){null==this.title&&(t=!0),this.bool=t},this.init()}var e,i,n;return e=t,(i=[{key:"bool",set:function(t){this._bool!=t&&(this._bool=t,1==this._bool?(this.label&&(this.label.visible=!1),this.pan.visible=!1,this.comp&&(this.comp.visible=!0,this.dCont.add(this.comp)),this.dCont.remove(this.panel),this.panel.div.removeEventListener("mousedown",self.mousedown)):(this.label&&(this.label.visible=!0,this.label.getTextWidth&&(this.pan.width=this.label.getTextWidth()),this.pan.visible=!0),this.comp&&(this.comp.visible=!1,this.dCont.remove(this.comp)),this.dCont.add(this.panel),this.panel.div.addEventListener("mousedown",self.mousedown)))},get:function(){return this._bool}},{key:"verticel",set:function(t){this._verticel!=t&&(this._verticel=t)},get:function(){return this._verticel}},{key:"titleHron",set:function(t){this._titleHron!=t&&(this._titleHron=t)},get:function(){return this._titleHron}},{key:"colorText",set:function(t){this._colorText!=t&&(this._colorText=t,this.setColor())},get:function(){return this._colorText}},{key:"otstup",set:function(t){this._otstup!=t&&(this._otstup=t)},get:function(){return this._otstup}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=t)},get:function(){return this._active}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.setSize())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.setSize())},get:function(){return this._height}},{key:"x",set:function(t){this._x!=t&&(this._x=t,this.dCont.x=t)},get:function(){return this._x}},{key:"y",set:function(t){this._y!=t&&(this._y=t,this.dCont.y=t)},get:function(){return this._y}}])&&x(e.prototype,i),n&&x(e,n),t}();function w(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var A=function(){function t(e,i,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var a=this;this.type="MCPScrol",this.par=n,this.fun=s,this.idArr=this.par.idArr,this._x=this.par._x,this._y=this.par._y,this._wh=this.par._wh,this._width=this.par._width,this._height=this.par._height,this.otstup=this.par._otstup,this._activePanel=this.par._activePanel,this._active=!1,this.server=this.par.server,this._colorText=this.par._colorText,this._widthSwap=this.par._widthSwap,this._verticel=this.par._verticel,this.sahDelta=50,this.dragNotEvent=dcmParam.dragNotEvent,this._heightContent=0,this._boolWheel=!1,this.dCont=e,this.dCont1=i,this.scrollBarV=void 0,this.init=function(){null==this.scrollBarV&&(this.scrollBarV=new DScrollBarV(this.dCont1,this.width-2*this.otstup,0,function(){a.scrolPos(!1)}),this.scrollBarV.offsetHit=3,this.scrollBarV.height=this.height,this.scrollBarV.width=this.otstup/2,this.scrollBarV.visible=this._active,this.boolWheel=!1)};var r=void 0;this.dragActiv=!1,this.mouseDown=function(t){a.dragActiv=!0,r=void 0,1==a.dragNotEvent&&(document.body.style.pointerEvents="none")},this.mouseup=function(t){a.dragActiv=!1,r=void 0,1==a.dragNotEvent&&(document.body.style.pointerEvents=null)};var o,h,l=0;this.mousemove=function(t){0!=a.dragActiv&&null!=a.scrollBarV&&0!=a.scrollBarV.visible&&(h=a.scrollBarV.heightContent-a.scrollBarV.height,0==dcmParam.mobile?(null==r&&(r={y:t.clientY,y1:a.dCont.y}),r.ys=t.clientY):(null==r&&(r={y:t.targetTouches[0].clientY,y1:a.dCont.y}),r.ys=t.targetTouches[0].clientY),(l=r.y1-(r.y-r.ys))>=0&&(l=0),l<=-(h+a.otstup)&&(l=-(h+a.otstup)),a.dCont.y=l,a.scrolPos(!0))},this._bmd=!1,this.startMouseDown=function(){1==this._bmd?(0==dcmParam.mobile?(this.dCont.div.addEventListener("mousedown",this.mouseDown),window.addEventListener("mouseup",this.mouseup)):(this.dCont.div.addEventListener("touchstart",this.mouseDown),window.addEventListener("touchend",this.mouseup)),dcmParam.addFunMove(a.mousemove)):(0==dcmParam.mobile?(this.dCont.div.removeEventListener("mousedown",this.mouseDown),window.removeEventListener("mouseup",this.mouseup)):(this.dCont.div.removeEventListener("touchstart",this.mouseDown),window.removeEventListener("touchend",this.mouseup)),dcmParam.removeFunMove(a.mousemove))},this.bmd=!0,this.scrolPos=function(t){1==t?a.scrollBarV.value=this.dCont.y/(this._height-a.scrollBarV.heightContent)*100:a.dCont.y=a.scrollBarV.value/100*(this._height-a.scrollBarV.heightContent),a.skrollRect(a.panel)},this.recurs=function(t){return o=null,null!=t.offsetParent&&(o=t.offsetParent),null!=t.parentElement&&(o=t.parentElement),null!=o&&(!!o.blaGrabla||this.recurs(o))},this.mousewheel=function(t){var e=!1;if(t.target&&(t.target.offsetParent||t.target.parentElement)&&(e=a.recurs(t.target)),1!=e){h=a.scrollBarV.heightContent-a.scrollBarV.height;var i=-1,n=t.delta;null==t.wheelDelta&&(n=t.wheelDelta),t.delta&&t.delta<0&&(i=1),t.deltaY&&t.deltaY<0&&(i=1),t.detail&&t.detail<0&&(i=1),null!=t.wheelDelta&&(i=t.wheelDelta>0?-1:1),n=i,a.scrollBarV.visible&&(n<0?a.dCont.y>=0?a.dCont.y=0:a.dCont.y+=a.sahDelta:a.dCont.y<=-(h+a.otstup)?a.dCont.y=-(h+a.otstup):a.dCont.y-=a.sahDelta),a.scrolPos(!0),a.skrollRect(a.panel)}},this.skrollRect=function(t){this.dCont1.div.style.clip="rect("+Math.round(0)+"px "+Math.round(this.width+4*this.otstup)+"px "+Math.round(this.height)+"px "+Math.round(0)+"px)"},this.start=function(){this.init()},this.setSize=function(){this.skrollRect(this.panel)}}var e,i,n;return e=t,(i=[{key:"bmd",set:function(t){this._bmd!=t&&(this._bmd=t,this.startMouseDown())},get:function(){return this._bmd}},{key:"boolWheel",set:function(t){this._boolWheel!=t&&(this._boolWheel=t,this.interactive=this._boolWheel,1==this._boolWheel?(this.dCont.div.addEventListener("mousewheel",this.mousewheel),this.dCont.div.addEventListener("DOMMouseScroll",this.mousewheel)):(this.dCont.div.removeEventListener("mousewheel",this.mousewheel),this.dCont.div.removeEventListener("DOMMouseScroll",this.mousewheel),this.dCont.y=this.otstup/2),this.scrollBarV.visible=this._boolWheel)},get:function(){return this._boolWheel}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.scrollBarV&&(this.boolWheel=t))},get:function(){return this._active}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.scrollBarV.x=this._width+this.otstup,this.setSize())},get:function(){return this._width}},{key:"heightContent",set:function(t){this._heightContent!=t&&(this._heightContent=t,this.scrollBarV.heightContent=this.heightContent,this.setSize())},get:function(){return this._heightContent}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.scrollBarV.height=this.height,this.setSize())},get:function(){return this._height}}])&&w(e.prototype,i),n&&w(e,n),t}();function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var E=function(){function t(e,i){T(this,t),this.type="MCPanel",this.fun=i;var n,s,a,r,o,h,l,u,c,d,p,f=this;this.idArr=-1,this._x=0,this._y=0,this._wh=32,this._width=100,this._height=this.wh,this._otstup=5,this._activePanel=!0,this.server="",this._colorText=dcmParam._colorText,this._widthSwap=50,this.heightContent=0,this._verticel=!1,this.array=[],this.arrayCesh=[],this.dCont1=new DCont(e),this.dCont1.x=this.x,this.dCont1.y=this.y,this.dCont1.visible=this._activePanel,this.dCont=new DCont(this.dCont1),this.dCont.visible=this._activePanel,this.panel=new DPanel(this.dCont,0,0),this.panel.color1=dcmParam.color,this.panel.height=this._height,this.scrol=new A(this.dCont,this.dCont1,this,function(){}),this.ak=[],this.startKey=function(t){this.clear();for(var e=0;e<this.ak.length;e++)this.ak[e].name==t&&f.setVisi(this.ak[e].array)},this.setKey=function(t,e){this.ak.push(new S(this,t,e))},this.setSob=function(t,e,i){"List"!=t?"Drag"!=t||f.setVisi(e):this.activePanel=!0},this.sobxzP=function(t,e,i){if("mdBool"==t)for(var n=!0,s=0;s<f.array.length;s++)n=!1,e&&e.uuid==f.array[s].uuid&&(n=!0),f.array[s].setBool(n);"sobCmena"==t&&f.fun("sobCmena",e,i),"ReSize"==t&&f.korrectPositionY()},this.getXZP=function(t){for(var e=0;e<this.arrayCesh.length;e++)if(1!=this.arrayCesh[e].active&&this.arrayCesh[e].typeComp==t)return this.arrayCesh[e].active=!0,this.arrayCesh[e];return this.arrayCesh.push(new _(this,t,this.sobxzP)),this.dCont.add(this.arrayCesh[this.arrayCesh.length-1].dCont),this.arrayCesh[this.arrayCesh.length-1].idArr=this.arrayCesh.length-1,this.arrayCesh[this.arrayCesh.length-1]},this.clear=function(t){f.array.length=0;for(var e=0;e<this.arrayCesh.length;e++)this.arrayCesh[e].clear()},this.korrektSortList=function(t){},this.calculatSize=function(){n=s=0;for(var t=0;t<f.array.length;t++)f.array[t].active=!0,-1!=f.array[t].typePosit?n+=f.array[t].width+this.otstup:s++;return{allWidth:n,unikComp:s}},this.korrectActive=function(t,e){f.korrektSortList("priority");for(var i=f.array.length-1;i>=0;i--)if(0!=f.array[i].active&&-1!=f.array[i].typePosit?(f.array[i].active=!1,t-=f.array[i].width+this.otstup):0!=f.array[i].active&&-1==f.array[i].typePosit&&(f.array[i].active=!1,t-=f.array[i].width+this.otstup,e-=1),this.width-t>50)return{allWidth:t,unikComp:e}},this.modifyPosition=function(){f.korrektSortList("idArr"),a=this.otstup,this.otstup;for(var t=0;t<f.array.length;t++)0!=f.array[t].active&&(t==f.array.length-1&&(a=this.width-f.array[t].width),f.array[t].x=a,a+=f.array[t].width+this.otstup);return"completCorrected"},this.modifySize=function(t){if(r=t.allWidth,o=t.unikComp,c=!0,this.width>=r){if(o>0)if((h=this.width-r)>50){l=(h-this.otstup)/o;for(var e=0;e<f.array.length;e++)-1==f.array[e].typePosit&&1==f.array[e].active?f.array[e].width=l:-1==f.array[e].typePosit&&(o-=1,l=(h-this.otstup)/o)}else c=!1}else c=!1;if(0==c&&(u=f.korrectActive(r,o),f.modifySize(u)),1==c)return f.modifyPosition()},this.korrectPositionY=function(){f.korrektSortList("idArr"),d=this.otstup,this.otstup;for(var t=0;t<f.array.length;t++)f.array[t].y=d,d+=f.array[t].height+this.otstup;this.heightContent=d,this.setSize()},this.deligateResize=function(t,e){if(null==t&&(p=f.calculatSize(),"completCorrected"==f.modifySize(p)))return f.array};var m,g,b=0,v=0;this.setVisi=function(t){this.clear(),b=this.otstup,v=this.otstup;for(var e=0;e<t.length;e++){var i=this.getXZP(t[e].cmena);i.verticel=this._verticel,i.setObj(t[e]),i.x=b,i.y=v,t[e].width<1&&(i.typePosit=t[e].width),t[e].width<1&&(i.width=f.widthSwap),f.array.push(i),0==this._verticel?b+=i.width+this.otstup:v+=i.height+this.otstup}1==this._verticel?e>=t.length&&f.korrectPositionY():this.deligateResize()},this.dragDebug=function(t,e,i,n,s){if("testIcon"==i){m=null,g=null;for(var a=0;a<this.array.length;a++)this.array[a].object.param==t&&(m=this.array[a]),this.array[a].object.param==e&&(g=this.array[a]);if((m||g)&&m.comp&&"DImage"==m.comp.type){m.comp.picWidth!==n&&!1,m.comp.picHeight!==s&&!1}}if("loadIcon"==i){trace("dragDebug",t,e,i,n,s),m=null;for(a=0;a<this.array.length;a++)this.array[a].object.param==t&&(m=this.array[a]);if(m&&m.comp&&"DButton"==m.comp.type){var r=new DButton(m.dCont,370+m.width-25,0+m.height-25,null,function(){var t=new Image;t.onload=function(){var e=document.createElement("canvas");e.width=m.comp.image.picWidth,e.height=m.comp.image.picHeight,e.getContext("2d").drawImage(t,0,0,e.width,e.height);var i=document.createElement("a");i.href=e.toDataURL("image/png"),i.download="image",i.click()},t.setAttribute("crossorigin","anonymous"),t.src=m.comp.image._link});r.width=r.height=25,r.color=dcmParam.colorActive}}},this.obj,this.setObjParam=function(t){this.obj=t;for(var e=0;e<f.array.length;e++)f.array[e].setObjParam(this.obj)},this.setColor=function(){for(var t=0;t<f.array.length;t++)f.array[t]._colorText=this._colorText,f.array[t].setColor()},this.setSize=function(){for(var t=0;t<f.array.length;t++)0==this._verticel?(f.array[t].height=this.height-2*this.otstup,0==f.array[t].typePosit&&(f.array[t].width=this.widthSwap),f.array[t].setSize(),f.scrol.active=!1):1==this._verticel&&(f.scrol.start(),f.scrol.height=f.height,f.scrol.heightContent=f.heightContent,f.scrol.width=f.width,f.heightContent>=f.height?f.scrol.active=!0:f.scrol.active=!1)}}var e,i,n;return e=t,(i=[{key:"x",set:function(t){this._x!=t&&(this._x=t,this.dCont1.x=this._x)},get:function(){return this._x}},{key:"y",set:function(t){this._y!=t&&(this._y=t,this.dCont1.y=this._y)},get:function(){return this._y}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.panel.width=t,this.setSize())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.panel.height=t,this.setSize())},get:function(){return this._height}},{key:"colorText",set:function(t){this._colorText!=t&&(this._colorText=t,this.setColor())},get:function(){return this._colorText}},{key:"verticel",set:function(t){this._verticel!=t&&(this._verticel=t)},get:function(){return this._verticel}},{key:"activePanel",set:function(t){this._activePanel!=t&&(this._activePanel=t,this.panel.visible=this._activePanel)},get:function(){return this._activePanel}},{key:"otstup",set:function(t){this._otstup!=t&&(this._otstup=t)},get:function(){return this._otstup}},{key:"widthSwap",set:function(t){this._widthSwap!=t&&(this._widthSwap=t,this.setSize())},get:function(){return this._widthSwap}},{key:"wh",set:function(t){this._wh!=t&&(this._wh=t)},get:function(){return this._wh}}])&&P(e.prototype,i),n&&P(e,n),t}(),S=function t(e,i,n){T(this,t),this.type="HronMPS",this.par=e;this.name=i,this.array=n};function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function D(t,e,i){return e&&j(t.prototype,e),i&&j(t,i),t}var k=function(){function t(e,i,n,s){C(this,t),this.type="SwitchPage";var a=this;this.dCont=new DCont(e),this.dCont.visible=this._active,this._kol=i,this.fun=n,this.param=s,this._activMouse=!0,this._index=-1,this._active=!0,this.width=0,this.height=0,this.array=[],this.drag=function(){this.clear();for(var t=0;t<this._kol;t++)null==this.array[t]&&(this.array[t]=new L(this.dCont,t,this.sob,this.param)),this.array[t].active=!0,this.width+=this.array[t].wh,this.height=this.array[t].wh},this.sob=function(t,e,i){"index"==t&&(a.index=e,a.fun("sobKol",e))},this.clear=function(){this.width=0;for(var t=0;t<this.array.length;t++)this.array[t].active=!1}}return D(t,[{key:"index",set:function(t){if(this._index!=t){if(this._index=t,t<0)return;for(var e=0;e<this.array.length;e++)this.array[e].idArr==t?this.array[e].button.color=dcmParam._colorActive:this.array[e].button.color=dcmParam._color}},get:function(){return this._index}},{key:"kol",set:function(t){this._kol!=t&&(this._kol=t,this.drag())},get:function(){return this._kol}},{key:"x",set:function(t){this._x!=t&&(this._x=t,this.dCont.x=t)},get:function(){return this._x}},{key:"y",set:function(t){this._y!=t&&(this._y=t,this.dCont.y=t)},get:function(){return this._y}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=t)},get:function(){return this._active}},{key:"activMouse",set:function(t){if(this._activMouse!=t){this._activMouse=t;for(var e=0;e<this.array.length;e++)this.array[e].activMouse=t}}}]),t}(),L=function(){function t(e,i,n,s){C(this,t),this.type="SwitchGron";var a=this;this.dCont=new DCont(e),this.idArr=i,this.fun=n,this.param=s,this._activMouse=!0,this.otstup=this.param.otstup,this._wh=32,this._x=(this._wh+this.otstup)*this.idArr,this._y=0,this._active=!0,this.button=new DButton(this.dCont,this._x,this._y,this.idArr+1,function(){n("index",a.idArr)}),this.button.width=this.wh,this.button.height=this.wh}return D(t,[{key:"x",set:function(t){this._x!=t&&(this._x=t,this.dCont.x=t)},get:function(){return this._x}},{key:"y",set:function(t){this._y!=t&&(this._y=t,this.dCont.y=t)},get:function(){return this._y}},{key:"wh",set:function(t){this._wh!=t&&(this._wh=t,this.button.width=this.wh,this.button.height=this.wh)},get:function(){return this._wh}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=t)},get:function(){return this._active}},{key:"activMouse",set:function(t){this._activMouse!=t&&(this._activMouse=t,this.button.activMouse=t)}}]),t}();function F(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function M(t,e,i){return e&&O(t.prototype,e),i&&O(t,i),t}var B=function(){function t(e,i){F(this,t),this.type="MCGal",this.fun=i,this.par=e;var n=this;this.param=e.param,this.otstup=this.param.otstup,this._keshParam="null",this._keshSort="null",this._boolSort=!1,this.kolSig=12,this._sahpos=0,this._x=0,this._y=0,this._width=0,this._height=0,this.dCont=new DCont(this.par.dCont),this.dContGal=new DCont(this.dCont),this._activeGaleri=!1,this.hronGal=null,this._objID=-1,this.ak=[],this.startKey=function(t){this.clear();for(var e=0;e<this.ak.length;e++)this.ak[e].name==t&&(this.ak[e].active=!0,this.hronGal=this.ak[e])},this.setKey=function(t,e){this.ak.push(new I(this,t,e))},this.arrayList=[],this.setSob=function(t,e,i){if("List"==t&&null!=this.hronGal&&(this._keshSort="null",this.arrayList=e,this._sahpos=0,this.sortList(),n._objID>-1)){var s=n._objID;n._objID=-1,n.objID=s}"sobKol"==t&&(n.sahpos=e),"serchId"==t&&(n.objID=e)};var s,a,r,o=0,h=[],l=[];this.arrayActive=[],this.sortList=function(){"null"==this.keshParam&&"null"==this.keshSort&&0==this.sahpos||n.fun("setGalSortParam"),h=[],l=[];for(var t=0;t<this.arrayList.length;t++)h.unshift(this.arrayList[t]);var e,i;if("null"!=this._keshSort){e=this._keshParam+"";for(t=h.length-1;t>=0;t--)i=!1,null!=h[t][this._keshSort]&&(h[t][this._keshSort]+"",0==this._boolSort&&-1!=(h[t][this._keshSort]+"").indexOf(e)&&(i=!0),1==this._boolSort&&h[t][this._keshSort]+""==e&&(i=!0)),1!=i&&h.splice(t,1)}this.arrayActive=h,o=Math.ceil(h.length/this.kolSig);for(t=0;t<this.kolSig;t++)h[this._sahpos*this.kolSig+t]&&l.push(h[this._sahpos*this.kolSig+t]);this.swith.kol=o,this.swith.x=(this.width-this.swith.width-this.otstup)/2,this.swith.active=o>1,this.swith.index=this.sahpos<o?this.sahpos:0,this.hronGal.gallary.start(l),this.sizeWindow()},this.swith=new k(this.dCont,0,this.setSob,this.param),this.clear=function(){this.hronGal=null,this.swith.active=!1;for(var t=0;t<this.ak.length;t++)this.ak[t].clear()},this.setParam=function(){this.x=0,this.y=this.param.wh+this.otstup;for(var t=0;t<this.ak.length;t++)this.ak[t].setParam();this.sizeWindow()},this.sizeWindow=function(t,e,i){t&&(s=t,a=e,r=i),this.width=s/r,this.height=a/r-(2*this.param.otstup+this.param.wh),this.swith.x=(this.width-this.swith.width-this.otstup)/2,this.swith.y=this.height-80-this.param.otstup;for(var n=0;n<this.ak.length;n++)this.ak[n].sizeWindow(s,a-(50+this.param.wh+this.param.otstup),r)}}return M(t,[{key:"objID",set:function(t){if(this._objID!=t){this._objID=t;var e=this.arrayList;if(null!=this.arrayActive[0]&&(e=this.arrayActive),e[0]){for(var i=0,n=0;n<e.length&&(n>0&&n%this.kolSig==0&&i++,!(e[n].id<=t));n++);this._sahpos=-1,this.sahpos=i,this._objID=-1}}},get:function(){return this._objID}},{key:"sahpos",set:function(t){this._sahpos!=t&&(this._sahpos=t,this.sortList())},get:function(){return this._sahpos}},{key:"keshParam",set:function(t){this._keshParam!=t&&(this._keshParam=t)},get:function(){return this._keshParam}},{key:"keshSort",set:function(t){this._keshSort!=t&&(this._keshSort=t)},get:function(){return this._keshSort}},{key:"boolSort",set:function(t){this._boolSort!=t&&(this._boolSort=t)},get:function(){return this._boolSort}},{key:"x",set:function(t){this._x!=t&&(this._x=t,this.dCont.x=this.x)},get:function(){return this._x}},{key:"y",set:function(t){this._y!=t&&(this._y=t,this.dCont.y=this.y)},get:function(){return this._y}},{key:"width",set:function(t){this._width!=t&&(this._width=t)},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t)},get:function(){return this._height}},{key:"activeGaleri",set:function(t){this._activeGaleri!=t&&(this._activeGaleri=t)},get:function(){return this._activeGaleri}}]),t}(),I=function(){function t(e,i,n){F(this,t),this.type="HronMPS",this._active=!1,this.par=e;var s,a,r=this;this.param=this.par.param,this.name=i,this.nameKey=i.split("List")[0],this.array=n,this.dCont=new DCont(e.dContGal),this.dCont.visible=this._active,this.dCont.y=0,this.dCont.x=0,this.down=function(t,e,i,n){"komp"==t&&(e.param&&"openCreat"==e.param&&r.par.swith&&(r.par.swith.active=!1),r.par.fun(t,e,i,n,r.nameKey))},this.gallary=new R(this.dCont,0,0,this.down,this),this.gallary.kolII=1,this.gallary.widthPic=100,this.gallary.heightPic=64,this.gallary.width=1002,this.gallary.otstup=2,this.gallary.height=100,this.gallary.sahDelta=100,this.gallary.setVisi(this.array),this.clear=function(){this.active=!1},this.setParam=function(){this.gallary.x=0},this.sizeWindow=function(t,e,n){t&&(s=t,a=e,i=n),this.gallary.width=s/i,this.gallary.widthPic=s/i-4,this.gallary.height=a/i-(2*this.param.otstup+this.param.wh)}}return M(t,[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active)},get:function(){return this._active}}]),t}();function R(t,e,i,n,s){DGallery.call(this,t,e,i,n),this.par=s,this.param=this.par.param;var a=this;this.type="DGallary1",this.bRadius=s.bRadius,this.color=dcmParam.color1,this.scrollBarV.but.x+=1,this.scrollBarV.but.color1=dcmParam._colorText1,this.scrollBarH.but.color1=dcmParam._colorText1,this.fff=function(t){a.fun("komp",{param:"openCreat",cmena:"DButton"},void 0,a.obj)},this.fff1=function(t){trace("fff1",t)},this.downBtn=function(){1==dcmParam.mobile&&dragPic.testDrag(5,a.fff,a.fff1),a.index=this.idArr,a.obj=a.array[this.idArr].object,a.fun&&a.fun()},this.createZamen=function(){return new z(this.content,0,0,this.downBtn,this)},this.parAr,this.setVisi=function(t){this.parAr=t}}function z(t,e,i,n,s){DBox.call(this,t,e,i,n),this.type="BXZ1";var a=this;this._idArr=-1,this.par=s,this.param=this.par.param,this.debug=this.param.debug,this.mcPan=new E(this,function(t,e,i){a.par.fun("komp",e,i,a.object)}),this.mcPan.idArr=this._idArr,this.mcPan.setVisi(s.parAr),this.mcPan.activePanel=!1,this.mcPan.colorText=dcmParam._colorText1,this.panel.boolLine=!1,this.panel.x+=-1.5,this.clik=function(){var t="https://alphakp.ru/www/adminAll.html?key=group3&type=creat&id="+this.text;window.open(t)},this.arrBBB=[];this.startLoad222=function(t){for(var e=0;e<t.length;e++)null==this.arrBBB[e]&&(this.arrBBB[e]=new DButton(this,120+30*e,10,"",this.clik),this.arrBBB[e].width=28,this.arrBBB[e].height=12,this.arrBBB[e].fontSize=10),null==this.arrBBB[e].parent&&this.add(this.arrBBB[e]),this.arrBBB[e].text=t[e]},this.clearrrr=function(t){for(var e=0;e<this.arrBBB.length;e++)if(null!=this.arrBBB[e].parent)this.arrBBB[e].parent.remove(this.arrBBB[e]);else if(0==e)return},this.startLoad=function(t){this.object=t,this.mcPan.setObjParam(t),trace(t),this.clearrrr(),null!=t.products&&this.startLoad222(t.products),this.idArr%2==0?this.panel.color1=this.panel.color=this.color=this.color1=dcmParam.compToHexArray(dcmParam.hexDec(this.par.color),-5):this.panel.color1=this.panel.color=this.color=this.color1=this.par.color,1==this.debug&&setTimeout(function(){a.mcPan.dragDebug("icon","id","testIcon",200,200)},2e3),a.funLoad(),this.draw(),a.funLoad(),this.image.visible=!1,this.label.visible=!1};this.draw=function(){this.image.visible=!1,this.label.visible=!1,this.mcPan.widthSwap=2*this.param.wh,this.mcPan.height=this.height,this.mcPan.width=this.width-4,this.mcPan.deligateResize(),this.postDraw&&this.postDraw()},this.mouseOver1=function(t){a.boolOut=!1,0==a._activ?a.panel.color1=dcmParam.compToHexArray(dcmParam.hexDec(a._color1),-3):a.panel.color1=dcmParam.compToHexArray(dcmParam.hexDec(a._color),-3),a.funOver&&a.funOver(a)},this.mouseOut1=function(t){0==a._activ?a.panel.color1=a._color1:a.panel.color1=a._color,a.funOut&&a.funOut(a)},0==dcmParam.mobile&&(this.panel.div.removeEventListener("mouseout",this.mouseOut),this.panel.div.removeEventListener("mouseover",this.mouseOver),this.panel.div.addEventListener("mouseout",this.mouseOut1),this.panel.div.addEventListener("mouseover",this.mouseOver1))}function H(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}R.prototype=Object.create(DGallery.prototype),R.prototype.constructor=R,Object.defineProperties(R.prototype,{index:{set:function(t){this._index!=t&&(this._index=t)},get:function(){return this._index}}}),z.prototype=Object.create(DBox.prototype),z.prototype.constructor=z,Object.defineProperties(z.prototype,{activ:{set:function(t){this._activ!=t&&(this._activ=t,this._activ?this.label.color="#93c32f":this.label.color="#000000",this._activ,this.panel.color1=this._color1)},get:function(){return this._activ}},idArr:{set:function(t){this._idArr!=t&&(this._idArr=t,this.mcPan&&(this.mcPan.idArr=t))},get:function(){return this._idArr}}});var N=function(){function t(e,i,n,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=this;this.type="MCOScrol",this.par=s,this.fun=a,this.dragNotEvent=dcmParam.dragNotEvent,this._active=!1,this._width=this.par.width,this._height=this.par.height,this._heightContent=this.par.heightContent,this._x=0,this.otstup=this.par.otstup,this.sahDelta=50,this._boolWheel=!0,this.dCont=e,this.dCont1=i,this.dContXZ=n,this._widthSkroll=2,this.scrollBarV=void 0,this.init=function(){null==this.scrollBarV&&(this.scrollBarV=new DScrollBarV(this.dCont1,this.width-2*this.otstup,this.otstup,function(){r.scrolPos(!1)}),this.scrollBarV.offsetHit=3,this.scrollBarV.width=this.widthSkroll,this.boolWheel=!1,this.setSize())};var o=void 0;this.dragActiv=!1,this.mouseDown=function(t){r.dragActiv=!0,o=void 0,1==r.dragNotEvent&&(document.body.style.pointerEvents="none")},this.mouseup=function(t){r.dragActiv=!1,o=void 0,1==r.dragNotEvent&&(document.body.style.pointerEvents=null)};var h,l,u=0;this.mousemove=function(t){0!=r.dragActiv&&0!=r.scrollBarV.visible&&(l=r.scrollBarV.heightContent-r.scrollBarV.height,0==dcmParam.mobile?(null==o&&(o={y:t.clientY,y1:r.dCont.y}),o.ys=t.clientY):(null==o&&(o={y:t.targetTouches[0].clientY,y1:r.dCont.y}),o.ys=t.targetTouches[0].clientY),(u=o.y1-(o.y-o.ys))>=0&&(u=0),u<=-(l+r.otstup)&&(u=-(l+r.otstup)),r.dCont.y=u,r.scrolPos(!0))},this._bmd=!1,this.startMouseDown=function(){1==this._bmd?(0==dcmParam.mobile?(this.dCont.div.addEventListener("mousedown",this.mouseDown),window.addEventListener("mouseup",this.mouseup)):(this.dCont.div.addEventListener("touchstart",this.mouseDown),window.addEventListener("touchend",this.mouseup)),dcmParam.addFunMove(r.mousemove)):(0==dcmParam.mobile?(this.dCont.div.removeEventListener("mousedown",this.mouseDown),window.removeEventListener("mouseup",this.mouseup)):(this.dCont.div.removeEventListener("touchstart",this.mouseDown),window.removeEventListener("touchend",this.mouseup)),dcmParam.removeFunMove(r.mousemove))},this.bmd=!0,this.scrolPos=function(t){1==t?r.scrollBarV.value=this.dCont.y/(this._height-r.scrollBarV.heightContent)*100:r.dCont.y=r.scrollBarV.value/100*(this._height-r.scrollBarV.heightContent),r.skrollRect(r.panel)},this.recurs=function(t){return h=null,null!=t.offsetParent&&(h=t.offsetParent),null!=t.parentElement&&(h=t.parentElement),null!=h&&(!!h.blaGrabla||this.recurs(h))},this.mousewheel=function(t){var e=!1;if(t.target&&(t.target.offsetParent||t.target.parentElement)&&(e=r.recurs(t.target)),1!=e){l=r.scrollBarV.heightContent-r._height;var i=-1,n=t.delta;null==t.wheelDelta&&(n=t.wheelDelta),t.delta&&t.delta<0&&(i=1),t.deltaY&&t.deltaY<0&&(i=1),t.detail&&t.detail<0&&(i=1),null!=t.wheelDelta&&(i=t.wheelDelta>0?-1:1),n=i,r.scrollBarV.visible&&(n<0?r.dCont.y>=0?r.dCont.y=0:r.dCont.y+=r.sahDelta:r.dCont.y<=-(l+r.otstup)?r.dCont.y=-(l+r.otstup):r.dCont.y-=r.sahDelta),r.scrolPos(!0),r.skrollRect(r.panel)}},this.skrollRect=function(t){this.dContXZ.div.style.clip="rect("+Math.round(this.otstup)+"px "+Math.round(this.width)+"px "+Math.round(this.height+this.otstup)+"px "+Math.round(0)+"px)"},this.start=function(){this.init()},this.setSize=function(){this.scrollBarV.heightContent=this.heightContent,this.scrollBarV.height=this.height,this.scrollBarV.heightContent>this.scrollBarV.height?this.boolWheel=!0:this.boolWheel=!1,this.skrollRect(this.panel)},this.init()}var e,i,n;return e=t,(i=[{key:"bmd",set:function(t){this._bmd!=t&&(this._bmd=t,this.startMouseDown())},get:function(){return this._bmd}},{key:"boolWheel",set:function(t){this._boolWheel!=t&&(this._boolWheel=t,this.interactive=this._boolWheel,1==this._boolWheel?(this.dCont.div.addEventListener("mousewheel",this.mousewheel),this.dCont.div.addEventListener("DOMMouseScroll",this.mousewheel)):(this.dCont.div.removeEventListener("mousewheel",this.mousewheel),this.dCont.div.removeEventListener("DOMMouseScroll",this.mousewheel),this.dCont.y=this.otstup/2),this.scrollBarV.visible=this._boolWheel)},get:function(){return this._boolWheel}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.scrollBarV&&(this.boolWheel=t))},get:function(){return this._active}},{key:"widthSkroll",set:function(t){this._widthSkroll!=t&&(this._widthSkroll=t,this.scrollBarV.widthSkroll=t)},get:function(){return this._widthSkroll}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.setSize())},get:function(){return this._width}},{key:"heightContent",set:function(t){this._heightContent!=t&&(this._heightContent=t,this.scrollBarV.heightContent=t,this.dCont.y=this.otstup/2,this.setSize())},get:function(){return this._heightContent}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.scrollBarV.height=t,this.dCont.y=this.otstup/2,this.setSize())},get:function(){return this._height}},{key:"x",set:function(t){this._x!=t&&(this._x=t,this.scrollBarV.x=t)},get:function(){return this._x}}])&&H(e.prototype,i),n&&H(e,n),t}();function X(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var U=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.type="HronCase",this.par=e,this.fun=i,this.param=this.par.param,this.otstup=this.param.otstup,this.otstupLabel=15,this.otstupLabelXX=80,this.contentFontSize=16,this._active=!1,this.dCont=new DCont(e.dCont),this.dCont.visible=this._active,this._width=this.param.whCr+10,this._height=100,this.heightStart=0,this.numInput=5,this.okrugInput=10,this.label=new DLabel(this.dCont,this.otstup,this.otstup," "),this.label.bold=!0,this.label.fontSize=12,this.panel=new DPanel(this.dCont,this.otstup,this.otstup+this.label.fontSize+2),this.funPostSO,this.object,this.key,this.id,this.startObj=function(t,e){this.object=t,this.key=e,this.id=t.id,this.funPostSO&&this.funPostSO()},this.drag=function(){},this.sizeW1,this.sizeW=function(){this.label.width=this.width,this.panel.width=this.width,this.panel.height=this._height-(this.label.fontSize+this.otstup+2),this.sizeW1&&this.sizeW1()},this.height=this.label.fontSize+this.otstup,this.heightStart=this.label.fontSize+this.otstup}var e,i,n;return e=t,(i=[{key:"width",set:function(t){this._width!=t&&(this._width=t,this.sizeW())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.sizeW())},get:function(){return this._height}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active)},get:function(){return this._active}}])&&X(e.prototype,i),n&&X(e,n),t}();function W(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var V=function(){function t(e,i){W(this,t),this.type="BaseMC",this.fun=i,this.par=e;var n,s,a,r,o,h,l=this;this.param=e.param,this._active=!1,this.key="null",this._width=90,this.width=900,this._height=500,this.sahDelta=50,this.heightContent=0,this.otstup=this.param.otstup,this.panel=void 0,this.scrollBarV=void 0,this.dCont1=new DCont(e.dCont),this.dCont1.visible=this._active,this.dContXZ=new DCont(e.dCont),this.dCont=new DCont(this.dContXZ),this.dCont.visible=this._active,this.array=[],this.creatObj=function(t){var e={url:this.param.server+this.key+"/",type:"POST",data:{name:t},success:function(t){l.start(t,null,l.key)},error:function(t){console.error("не верная загрузка xУУУУУz")}};e.headers={Authorization:"Token "+mhbd.token},$.ajax(e)},this.obj,this.aParam,this.postStart=void 0,this.start=function(t,e,i){this.obj=t,trace("obj, aParam, key",t,e,i),e&&(this.aParam=e);var n=i.split("Creat");this.key=n[0],null!=this.obj?(this.active=!0,this.sizeWindow(),null!=this.postStart?this.postStart():(this.active=!0,this.startObj(t,l.key))):null!=i&&(console.warn("CREATE OBJ"),this.par.par.par.mSupCr.setXZ("Создать объект","Подтвердите создание объекта:",function(t){l.creatObj(t)},function(){l.backToList()}))},this.backToList=function(){l.par.par.par.menuLeft.openField(l.key+"List")},this.clear=function(){this.active=!1},this.postInit=void 0,this.init=function(){this.scrollBarV||(this.scrollBarV=new N(this.dCont,this.dCont1,this.dContXZ,this,function(){})),this.postInit&&(trace("^^^ INIT ^^^"),this.postInit())},this.object,this.startObj=function(t,e){this.init(),this.object=t;for(var i=0;i<this.array.length;i++)this.array[i].startObj(t,e);this.sizeWindow(),this.sizeW()},this.osw={},this.postSW=void 0,this.sizeWindow=function(t,e,i){t&&(n=t,s=e,a=i),0!=this._active&&(r=n,r=1==this.param.mobile?n-7*this.param.otstup-this.param.wh:n-7*this.param.otstup-this.param.wb,o=s-2*this.param.wh-6*this.param.otstup,this.osw.w=n,this.osw.h=s,this.osw.s=a,this.osw.w1=r,this.osw.h1=o,this.height=s/a-(this.param.wh2+this.param.wh+8*this.param.otstup),this.panel&&(this.panel.height=this.height,this.panel.width=this.width,this.scrollBarV.height=this.height,this.scrollBarV.x=this.width+this.otstup),this.sizeW())},this.sizeW=function(){h=this.otstup;for(var t=0;t<this.array.length;t++)this.array[t].dCont.y=h,h+=this.array[t].height+this.otstup;this.heightContent=h-this.otstup,this.scrollBarV.heightContent=h+2*this.otstup,this.scrollBarV.height=this.height,this.scrollBarV.widthSkroll=this.otstup/2,null!=this.postSW&&this.postSW()}}var e,i,n;return e=t,(i=[{key:"active",set:function(t){if(this._active!=t){this._active=t,this.init(),this.dCont.visible=this._active,this.dCont1.visible=this._active;for(var e=0;e<this.array.length;e++)this.array[e].active=t;null!=this.postActive&&this.postActive()}},get:function(){return this._active}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.sizeWindow())},get:function(){return this._height}},{key:"wigth",set:function(t){this._wigth!=t&&(this._wigth=t,this.sizeWindow())},get:function(){return this._wigth}}])&&G(e.prototype,i),n&&G(e,n),t}();function Y(t){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,s=!1,a=void 0;try{for(var r,o=t[Symbol.iterator]();!(n=(r=o.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){s=!0,a=t}finally{try{n||null==o.return||o.return()}finally{if(s)throw a}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Z(t){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function K(t,e){return(K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function q(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var J=function(t){function e(t,i){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==Y(e)&&"function"!=typeof e?q(t):e}(this,Z(e).call(this,t,i))).type="MCOBase";var s=q(q(n));return n.saveFile=function(t,e){$.ajax({type:"GET",url:this.param.server+this.key+"/"+this.obj.id+"/",success:function(i){if("string"==typeof i.json){var n=JSON.parse(i.json);s.object=n}else s.object=i.json;null==s.object&&(s.object={}),s.object[e.param]={},s.object.id=s.obj.id,mhbd.setFile(t,s.obj,s.key,e.param,function(t){e.activComp.link=t})},error:function(t){console.error("не верная загрузка textur")}}),mhbd.getKeyList(this.key,function(t){},!0)},n.mcPanel=new E(n.dCont,function(t,e,n){if("sobCmena"==t&&e&&e.cmena&&("DInput"!=e.cmena&&"up"!=e.param||(mhbd.setParam(s.key,s.obj.id,e.param,n),s.obj[e.param]=n),"MDLeng"!=e.cmena&&"MTovars"!=e.cmena||(mhbd.setParam(s.key,s.obj.id,e.param,n),s.obj[e.param]=n),"DButton"==e.cmena&&null!=n&&("icon"==e.param&&s.saveFile(n,e),"delete"==e.param&&(mhbd.deleteId(s.key,s.obj.id,i),s.backToList()))),e&&e.cmena&&"DComboBox"==e.cmena&&null!=n){var a=Q((e.param+"").split(","),3),r=a[0],o=a[1];a[2];o&&"sobSmenaDB"==r&&mhbd.setParam(s.key,s.obj.id,o,n)}}),n.mcPanel.verticel=!0,n.mcPanel.height=n.param.wh,n.mcPanel.panel.color1=dcmParam.color1,n.mcPanel.colorText=dcmParam.textColor,n.postStart=function(){trace(this.obj),trace(this.aParam);for(var t=0;t<this.aParam.length;t++)for(var e in this.obj){var i=Q((this.aParam[t].param+"").split(","),3),n=i[0],a=i[1],r=i[2];"sobSmenaDB"==n&&a&&a==e&&(this.obj[e]&&(r=this.obj[e]),this.aParam[t].param=[n,a,r].join(",")),this.aParam[t].param==e&&(this.aParam[t].value=this.obj[e])}this.mcPanel.setVisi(this.aParam),1==this.param.debug&&setTimeout(function(){s.mcPanel.dragDebug("icon","id","loadIcon",200,200)},1500)},n.postSW=function(){this.mcPanel.x=this.param.otstup,this.mcPanel.y=this.param.otstup,this.mcPanel.height=this.osw.h/this.osw.s-90,0==dcmParam.mobile?this.mcPanel.width=this.param.whCr:this.mcPanel.width=this.osw.w/this.osw.s-75},n._active=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}(e,V),e}();function tt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var et=function(){function t(e,i,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MCOPGal",this.fun=n,this.par=e,this.link=s,this.param=e.param;var a=this;this._active=!1,this.height=255,this.width=515,this.heightGal=207,this.otstup=this.param.otstup,this.kolSig=10,this._sahpos=0,this._objID=-3,this._keshParam="null",this._keshSort="null",this._boolSort=!1,this._tempId="null",this._tempSahpos="null",this._xzBool=!1,this.dCont=new DCont(i),this.dCont.visible=this._active,this.linkXZ="null",this.openList=function(t){trace("link",t),this.linkXZ=t,mhbd.getKeyList(t,function(t){for(var e=[],i=0;i<t.length;i++)e.unshift(t[i]);a.gallery.start(e),a.array=e,a.sortList();var n=a._objID;a._objID=-2,a.objID=n})},this.array=[],this.arrayActive=[],this.init=function(){void 0===this.w&&(this.w=new DPanel(this.dCont,0,0),this.w.width=this.width,this.w.height=this.heightGal,this.w.dragBool=!1,this.w.hasMinimizeButton=!1,this.gallery=new it(this.w.content,0,0,function(t){a.index=this.index,a.fun("retJson",this.array[this.index].object.id,this.obj),a.tempId!=this.array[this.index].object.id&&(a.tempId=this.array[this.index].object.id),a.tempSahpos!=a._sahpos&&(a.tempSahpos=a._sahpos)},this),this.gallery.xzBool=this.xzBool,this.gallery.width=this.w.width,this.gallery.height=this.w.height,this.gallery.kolII=5,this.gallery.widthPic=100,this.gallery.heightPic=100,this.swith=new k(this.w.content,0,function(t,e,i){"sobKol"==t&&(a.sahpos=e)},this.param),this.openList(this.link))},this.init();var r=0;this.kol=r;var o=[],h=[];this.sortList=function(){o=[],h=[];for(var t=0;t<this.array.length;t++)o.push(this.array[t]);var e,i;if("null"!=this._keshSort){e=this._keshParam+"";for(t=o.length-1;t>=0;t--)i=!1,null!=o[t][this._keshSort]&&(o[t][this._keshSort]+"",0==this._boolSort&&-1!=(o[t][this._keshSort]+"").indexOf(e)&&(i=!0),1==this._boolSort&&o[t][this._keshSort]+""==e&&(i=!0)),1!=i&&o.splice(t,1)}this.arrayActive=o,r=Math.ceil(o.length/this.kolSig),this.kol=r;for(t=0;t<this.kolSig;t++)o[this._sahpos*this.kolSig+t]&&h.push(o[this._sahpos*this.kolSig+t]);this.swith.kol=r,this.swith.x=(this.width-this.swith.width-this.otstup)/2,this.swith.activMouse=r>1,this.swith.index=this._sahpos,a.gallery&&a.gallery.start(h),this.sizeWindow(),this.tempSahpos==this._sahpos&&(this._index=-1,this.index=this._tempId)},this.sizeWindow=function(){this.swith.y=this.heightGal+this.otstup,this.swith.x=(this.w.width-this.swith.width)/2}}var e,i,n;return e=t,(i=[{key:"xzBool",set:function(t){this._xzBool!=t&&(this._xzBool=t,this.gallery.xzBool=this._xzBool)},get:function(){return this._xzBool}},{key:"tempId",set:function(t){this._tempId!=t&&(this._tempId=t)},get:function(){return this._tempId}},{key:"tempSahpos",set:function(t){this._tempSahpos!=t&&(this._tempSahpos=t)},get:function(){return this._tempSahpos}},{key:"sahpos",set:function(t){if(this._sahpos!=t){if(this._sahpos=t,t<0)return;this.sortList()}},get:function(){return this._sahpos}},{key:"keshParam",set:function(t){this._keshParam!=t&&(this._keshParam=t)},get:function(){return this._keshParam}},{key:"keshSort",set:function(t){this._keshSort!=t&&(this._keshSort=t)},get:function(){return this._keshSort}},{key:"boolSort",set:function(t){this._boolSort!=t&&(this._boolSort=t)},get:function(){return this._boolSort}},{key:"objID",set:function(t){if(this._objID!=t){if(this._objID=t,t<=0)return;var e=this.array;null!=this.arrayActive[0]&&(e=this.arrayActive);for(var i=0,n=0;n<e.length&&(n>0&&n%10==0&&i++,!(e[n].id<=t));n++);this._sahpos=-1,this.sahpos=i,this.swith.index=-1,this.swith.index=i,this._index=-1,this.index=t}},get:function(){return this._objID}},{key:"index",set:function(t){if(this._index!=t){if(this._index=t,t<=0)return;for(var e=0;e<this.gallery.array.length;e++)if(this.gallery.array[e].object.id==t){this.gallery.index=e,this.fun("newTexture",t,this.gallery.array[e].object);break}this.tempId=t,this.tempSahpos=this._sahpos}},get:function(){return this._index}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active,this.init())},get:function(){return this._active}}])&&tt(e.prototype,i),n&&tt(e,n),t}();function it(t,e,i,n,s){DGallery.call(this,t,e,i,n);this.type="Gall33",this.par=s,this._xzBool=!1,this.createZamen=function(){return new nt(this.content,0,0,this.downBtn,this)}}function nt(t,e,i,n,s){DBox.call(this,t,e,i,n),this.type="BoxXZ";var a=this;this.par=s,this._xzBool=this.par._xzBool,this.dBat,1==this._xzBool&&(trace("this._xzBool",this._xzBool),this.dBat=new DButton(this,0,0,"",function(){var t="https://alphakp.ru/www/admin.html?"+a.par.par.linkXZ+"="+this.text;window.open(t)}),this.dBat.width=40,this.dBat.height=18),this.startLoad=function(t){this.object=t,a.funLoad();var e="resources/image/notpic.png";if(t.icon&&(e=t.icon),null!=t.id&&(this.label.text=t.id,this.label.div.style.pointerEvents="none",this.label.fontSize=12,this.label.y=this.height-this.label.fontSize,this.label.glowSah=1,this.label.bold=!0,this.label.color="#000000",this.dBat)){this.dBat.text=""+t.id;var i=!1;t.json&&t.json.title&&(i=!0,this.label.text=t.json.title),this.label.visible=i,trace(t)}null!=t.icon?(this.image.visible=!0,this.image.link==e?a.funLoad&&a.funLoad():(this.image.width=100,this.image.height=100,this.image.link=e)):this.image.visible=!1},this.draw=function(){this.dBat&&(this.dBat.y=this._height-20,this.label.y=this.dBat.y+6,this.label.x=this.dBat.x+this.dBat.width+2)}}it.prototype=Object.create(DGallery.prototype),it.prototype.constructor=it,Object.defineProperties(it.prototype,{xzBool:{set:function(t){if(this._xzBool!=t){this._xzBool=t;for(var e=0;e<this.array.length;e++)this.array[e].xzBool=t}},get:function(){return this._xzBool}},index:{set:function(t){null!=this.array[t]&&this.korektPoIndex(t),this._index=t;for(var e=0;e<this.array.length;e++)this._index==e?this.array[e].activ=!0:this.array[e].activ=!1},get:function(){return this._index}}}),nt.prototype=Object.create(DBox.prototype),nt.prototype.constructor=nt;var st=i(3);function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t){this.type="SceneSB",this.visi3D=t;this.array=[],this.object=void 0,this.array.push(new ut("ambient",t)),this.array.push(new lt("shadow",t)),this.array.push(new ct("sky",t)),this.array.push(new dt("mirror",t)),this.array.push(new pt("visi3D",t)),this.array.push(new ft("effect",t)),this.array.push(new mt("fog",t)),this.setObj=function(t){this.object=t;for(var e=0;e<this.array.length;e++)void 0===this.object[this.array[e].name]&&(this.object[this.array[e].name]={}),this.array[e].setBasa(this.object[this.array[e].name]);visi3D.shadowNeedsUpdate=!0}}function ot(t,e){this.type="SceneBox";this.name=t,this.array=[],this.object=null,this.objArray={},this.plus=function(t,e){this.array.push(new ht(t,e)),this.objArray[t.param]=this.array[this.array.length-1]},this.setValue=function(t,e,i){null==i?this.object[t]=e:this.drahKeyParam(t,e)},this.drahKey=function(t){null==this.objArray.works||0!=this.object.works?(null!=this.objArray[t]&&(1==this.objArray[t].tipP&&("object"===at(this.objArray[t].param[t])?this.objArray[t].param[t]=this.object[t]:this.objArray[t].param[t]!=this.object[t]&&(this.objArray[t].param[t]=this.object[t])),2==this.objArray[t].tipP&&this.objArray[t].param(this.object[t])),e.intRend=1):"active"==t&&this.objArray.active.param&&(this.objArray.active.param(this.object.active),e.intRend=1)},this.drahKeyParam=function(t,i){null!=this.objArray[t]&&(1==this.objArray[t].tipP&&("object"===at(this.objArray[t].param[t])?this.objArray[t].param[t]=i:this.objArray[t].param[t]!=i&&(this.objArray[t].param[t]=i)),2==this.objArray[t].tipP&&this.objArray[t].param(i)),e.intRend=1},this.setBasa=function(t){this.object=t;for(var e=0;e<this.array.length;e++)null==t[this.array[e].object.param]&&(t[this.array[e].object.param]=this.array[e].object.valueStart);this.drahKeys()},this.drahKeys=function(){for(var t=0;t<this.array.length;t++)this.drahKey(this.array[t].object.param)},this.plus({name:"check10",typeParam:"DCheckBox",param:"works",title:"works//false не работает",valueStart:!0})}function ht(t,e){this.type="SceneGron";this.object=t,this.param=e,this.tipP=0,null!=e&&("object"===at(e)&&(this.tipP=1),"function"==typeof e&&(this.tipP=2))}function lt(t,e){ot.call(this,t,e),this.type="SceneBox1";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){e.utility.sunActiv(t)}),this.plus({name:"slider10",typeParam:"DSliderBig",param:"mapSize",title:"mapSize",min:64,max:8192,value:2048,okrug:1,valueStart:e.SHADOW_WH},function(t){t=t||e.SHADOW_WH,e.sunLight.shadow.mapSize.width!=t&&(e.sunLight.shadow.mapSize.width=t,e.sunLight.shadow.mapSize.height=t)}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",valueStart:e.LIGHT_COLOR},function(t){var i=t;if("string"==typeof i&&-1!=i.indexOf("x")){var n=i.split("x");i="#"+n[1]}e.sunLight.color=new THREE.Color(i)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"bias",title:"bias",min:-.05,max:.05,value:0,okrug:1e4,valueStart:e.LIGHT_BIAS},e.sunLight.shadow),this.plus({name:"slider1",typeParam:"DSliderBig",param:"intensity",title:"intensity",min:0,max:5,value:1,okrug:100,valueStart:e.SHADOW_INTENSITY},e.sunLight),this.plus({name:"slider2",typeParam:"DSliderBig",param:"radius",title:"radius",min:0,max:50,value:1,valueStart:e.SHADOW_RADIUS},e.sunLight.shadow),this.plus({name:"check2",typeParam:"DCheckBox",param:"bAlphaForCoating",title:"SAMPLE_ALPHA..",value:!0,valueStart:!1},function(t){var i=e.renderer.getContext();t?i.enable(i.SAMPLE_ALPHA_TO_COVERAGE):i.disable(i.SAMPLE_ALPHA_TO_COVERAGE)}),this.plus({name:"check3",typeParam:"DCheckBox",param:"fixation",title:"fixation",value:!1,valueStart:e.utility.FIXATION},e.utility),this.plus({name:"slider4",typeParam:"DSliderBig",param:"rotationX",title:"rotationX",min:-Math.PI,max:Math.PI,okrug:100,value:0,valueStart:e.utility.ROTATION_X},e.utility),this.plus({name:"slider5",typeParam:"DSliderBig",param:"rotationZ",title:"rotationZ",min:-Math.PI,max:Math.PI,okrug:100,value:0,valueStart:e.utility.ROTATION_Z},e.utility),this.plus({name:"slider6",typeParam:"DSliderBig",param:"distance",title:"distance",min:0,max:1e4,value:0,valueStart:e.utility.DISTANCE},e.utility),this.plus({name:"slider7",typeParam:"DSliderBig",param:"cubWidth",title:"cubWidth",min:10,max:1e4,value:0,valueStart:e.utility.CUB_WIDTH},e.utility),this.plus({name:"slider8",typeParam:"DSliderBig",param:"cubHeight",title:"cubHeight",min:10,max:1e4,value:0,valueStart:e.utility.CUB_HEIGHT},e.utility),this.plus({name:"slider9",typeParam:"DSliderBig",param:"distanceUpdateShadow",title:"distUpdateShadow ",min:-1,max:500,value:0,valueStart:e.utility.distanceUpdateShadow},e.utility)}function ut(t,e){ot.call(this,t,e);var i=this;this.type="SceneBox2",this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!0},function(t){e.utility.ambientActiv(t)}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",tipParam:2,valueStart:e.AMBIEN_COLOR},function(t){var n=t;if("string"==typeof n&&-1!=n.indexOf("x")){var s=n.split("x");n="#"+s[1]}i.setValue(this.object.param,n),e.ambientLight.color=new THREE.Color(n)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"intensity",title:"intensity",min:0,max:5,okrug:100,valueStart:e.AMBIEN_INTENSITY},e.ambientLight)}function ct(t,e){ot.call(this,t,e),this.type="SceneBox3";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){e.utility.sky.active=t}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",valueStart:e.utility.sky.COLOR},e.utility.sky),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"link",title:"LoadPic",valueStart:e.utility.sky.LINK},e.utility.sky),this.plus({name:"slider",typeParam:"DSliderBig",param:"radius",title:"radius",min:10,max:15e3,okrug:1,valueStart:e.utility.sky.RADIUS},e.utility.sky)}function dt(t,e){ot.call(this,t,e),this.type="SceneBox5";this.plus({name:"text1",typeParam:"DLabel",param:"xz",title:"Load",valueStart:"reflect"}),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"link",title:"Load",valueStart:"null"},function(t){e.cubeMap.link=t}),this.plus({name:"sliderExp",typeParam:"DSliderBig",param:"exposure",title:"exposure",min:-10,max:10,okrug:100,valueStart:-1},function(t){e.cubeMap.exposure=t}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"gamma",title:"gamma//в хдр",min:-10,max:10,okrug:100,valueStart:-1},function(t){e.cubeMap.gamma=t}),this.plus({name:"text1",typeParam:"DLabel",param:"xz",title:"Load",valueStart:"refract"}),this.plus({name:"contLoader1",typeParam:"DVisualLoader",param:"link1",title:"Load",valueStart:"null"},function(t){e.cubeMap1.link=t}),this.plus({name:"sliderExp1",typeParam:"DSliderBig",param:"exposure1",title:"exposure",min:-10,max:10,okrug:100,valueStart:-1},function(t){e.cubeMap1.exposure=t}),this.plus({name:"slider2",typeParam:"DSliderBig",param:"gamma1",title:"gamma//в хдр",min:-10,max:10,okrug:100,valueStart:-1},function(t){e.cubeMap1.gamma=t})}function pt(t,e){ot.call(this,t,e),this.type="SceneBox6";var i=this;this.plus({name:"check0",typeParam:"DCheckBox",param:"alwaysRender",title:"autoRender",valueStart:!1},function(t){e.alwaysRender!==t&&(e.alwaysRender=t)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"fov",title:"fov",min:0,max:90,okrug:1,valueStart:e.FOV}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"far",title:"far",min:100,max:5e4,okrug:1,valueStart:e.FAR},function(t){e.camera.far!=t&&(e.camera.far=t,e.camera.updateProjectionMatrix())}),this.plus({name:"slider2",typeParam:"DSliderBig",param:"minZum",title:"minZum",min:0,max:2e4,okrug:1,valueStart:0},function(t){e.minZum=t,e.minZum>e.maxZum&&(e.maxZum=e.minZum,i.setValue("maxZum",t))}),this.plus({name:"slider3",typeParam:"DSliderBig",param:"maxZum",title:"maxZum",min:0,max:2e4,okrug:1,valueStart:2e4},function(t){e.maxZum=t,e.maxZum<e.minZum&&(e.minZum=e.maxZum,i.setValue("minZum",t))}),this.plus({name:"slider4",typeParam:"DSliderBig",param:"zume",title:"powerZum",min:1,max:2e4,okrug:1,valueStart:250}),this.plus({name:"slider11",typeParam:"DSliderBig",param:"powerZum",title:"zoom",min:1,max:100,okrug:1,valueStart:50},function(t){e.position3d.powerZum!==t&&(e.position3d.powerZum=t)}),this.plus({name:"slider5",typeParam:"DSliderBig",param:"minRotationX",title:"minAngel",min:0,max:3,okrug:100,valueStart:2.5},function(t){e.minRotationX!==t&&(e.minRotationX=t)}),this.plus({name:"slider6",typeParam:"DSliderBig",param:"maxRotationX",title:"maxAngel",min:0,max:3,okrug:100,valueStart:0},function(t){e.maxRotationX!==t&&(e.maxRotationX=t)}),this.plus({name:"check1",typeParam:"DCheckBox",param:"debug",title:"debug",valueStart:!0},function(t){e.utility.debug!==t&&(e.utility.debug=t)}),this.plus({name:"check2",typeParam:"DCheckBox",param:"isDragPan",title:"isDragPan",valueStart:!0},function(t){e.position3d.isDragPan!==t&&(e.position3d.isDragPan=t)}),this.plus({name:"check3",typeParam:"DCheckBox",param:"alphaAd",title:"alpha Админ для фотки",valueStart:!1}),this.plus({name:"slider7",typeParam:"DSliderBig",param:"zume",title:"zoom",min:5,max:2e3,okrug:1,valueStart:250},function(t){e.zume=t}),this.plus({name:"slider8",typeParam:"DSliderBig",param:"rotationX",title:"rotationX",min:-Math.PI,max:Math.PI,okrug:100,valueStart:0},function(t){e.rotationX=t}),this.plus({name:"slider9",typeParam:"DSliderBig",param:"rotationZ",title:"rotationZ",min:-Math.PI,max:Math.PI,okrug:100,valueStart:0},function(t){e.rotationZ=t}),this.plus({name:"slider10",typeParam:"DSliderBig",param:"globZ",title:"globZ",min:-1e3,max:1e3,okrug:1,valueStart:0},function(t){e.yVerh=t})}function ft(t,e){ot.call(this,t,e),this.type="SceneBox7";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},e.efect),this.plus({name:"slider",typeParam:"DSliderBig",param:"edgeStrength",title:"edgeStrength",min:0,max:10,okrug:100,valueStart:e.efect.edgeStrength},e.efect),this.plus({name:"slider1",typeParam:"DSliderBig",param:"edgeGlow",title:"edgeGlow",min:0,max:1,okrug:100,valueStart:e.efect.edgeGlow},e.efect),this.plus({name:"slider2",typeParam:"DSliderBig",param:"edgeThickness",title:"edgeThickness",min:0,max:5,okrug:100,valueStart:e.efect.edgeThickness},e.efect),this.plus({name:"slider3",typeParam:"DSliderBig",param:"pulsePeriod",title:"pulsePeriod",min:0,max:5,okrug:100,valueStart:e.efect.pulsePeriod},e.efect),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"linkTextur",title:"linkTextur",valueStart:e.efect.linkTextur},e.efect),this.plus({name:"color",typeParam:"DColor",param:"visibleEdgeColor",title:"vEdgeColor",valueStart:e.efect.visibleEdgeColor},e.efect),this.plus({name:"color1",typeParam:"DColor",param:"hiddenEdgeColor",title:"hEdgeColor",valueStart:e.efect.hiddenEdgeColor},e.efect)}function mt(t,e){ot.call(this,t,e),this.type="SceneBox9";e.sbfog=new gt(e),this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){e.sbfog.active=t}),this.plus({name:"color1",typeParam:"DColor",param:"color",title:"outlineColor1",valueStart:e.sbfog._color},function(t){var i=t;e.sbfog.color=i}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"near",title:"near",min:0,max:1e4,okrug:1,valueStart:50},e.sbfog),this.plus({name:"slider2",typeParam:"DSliderBig",param:"far",title:"far",min:0,max:2e4,okrug:1,valueStart:100},e.sbfog)}function gt(t){this._active=!1,this._color="#ffffff",this._near=50,this._far=1e3,this.visi=t,this.fog=new THREE.Fog(this._color,this._near,this._far)}gt.prototype={set active(t){this._active!=t&&(this._active=t,1==this._active?this.visi.scene.fog=this.fog:this.visi.scene.fog=null)},get active(){return this._active},set color(t){this._color!=t&&(this._color=t,this.fog.color=new THREE.Color(t))},get color(){return this._color},set near(t){this._near!=t&&(this._near=t,this.fog.near=t)},get near(){return this._near},set far(t){this._far!=t&&(this._far=t,this.fog.far=t)},get far(){return this._far}};var bt=i(5);function vt(t,e,i){this.type="PMMat";this.par=t,this.visi3D=e,this.objbase=i,this.pmTexture=this.par.tex,this.ser=window.location.href;var n,s,a=window.location.href.split("?")[0].split("/");this.server="";for(var r=0;r<a.length-1;r++)this.server+=a[r]+"/";this.aOBase={},this.aO={},this.matBag=new THREE.MeshBasicMaterial({color:16711680}),this.objCesh={},this.getIDObj=function(t,e){if(null!=this.objCesh[t]){for(var i=0;i<this.objCesh[t].length;i++)if(1==this.testM(this.objCesh[t][i].userData,e))return this.objCesh[t][i]}else this.objCesh[t]=[];if(n=this.par.mat.getIDReturn(t,!0),null!=e)for(s in e)if("color"==s){var a=new THREE.Color(e[s]);n.color=a}return n.userData=e,this.objCesh[t].push(n),n},this.testM=function(t,e){if(null==t){if(null==e)return!0}else if(null!=e){for(s in!1,e){if(!t[s])return!1;if(t[s]!==e[s])return!1}return!0}return!1},this.getIDReturn=function(t){return this.matBag}}function yt(t){THREE.Group.call(this),this.type="MeshCombined",this._meshes=t,this._ready=!1,this.init()}yt.prototype=Object.create(THREE.Group.prototype),yt.constructor=yt,Object.defineProperties(yt.prototype,{}),yt.prototype.canAnalyze=function(){return this._meshes.reduce(function(t,e){return t&&e.geometry},!0)},yt.prototype._getMaterialKey=function(t){return t.material.uuid},yt.prototype.init=function(){var t=this;if(this._ready||!this.canAnalyze)return!1;var e=[],i={};return this._meshes.forEach(function(t){var e=t.geometry.uuid;i[e]||(i[e]=[]),i[e].push(t)}),Object.keys(i).forEach(function(n){var s=i[n],a=s[0].geometry;if(1!==s.length){var r={};s.forEach(function(e){var i=t._getMaterialKey(e);r[i]||(r[i]=[]),r[i].push(e)}),Object.keys(r).forEach(function(t){var i=r[t],n=i[0].material,s=i.length,o=new THREE.InstancedMesh(a,n.clone(),s);e.push(o),i.forEach(function(t,e){o.setQuaternionAt(e,t.quaternion),o.setPositionAt(e,t.position),o.setScaleAt(e,t.scale)}),o.needsUpdate()})}else e.push(s[0])}),e.forEach(function(e){return t.add(e)}),!0};var xt=new THREE.MeshDepthMaterial;xt.depthPacking=THREE.RGBADepthPacking,xt.clipping=!0,xt.defines={INSTANCE_TRANSFORM:""};var _t=THREE.ShaderLib.distanceRGBA,wt=THREE.UniformsUtils.clone(_t.uniforms),At=new THREE.ShaderMaterial({defines:{USE_SHADOWMAP:"",INSTANCE_TRANSFORM:""},uniforms:wt,vertexShader:_t.vertexShader,fragmentShader:_t.fragmentShader,clipping:!0});THREE.InstancedMesh=function(t,e,i){THREE.Mesh.call(this,(new Pt).setGeometry(t),e);var n=this;this.type="InstancedMesh",this.numInstances=i||1,this.customDepthMaterial=xt,this.customDistanceMaterial=At,this.onAfterRender=function(t,e,i,s,a,r){n.geometry.update(i)}},THREE.InstancedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.InstancedMesh.constructor=THREE.InstancedMesh,Object.defineProperties(THREE.InstancedMesh.prototype,{material:{set:function(t){this._material=t,this._material.defines=this._material.defines||{},this._material.defines.INSTANCE_TRANSFORM="",this._material.needsUpdate=!0},get:function(){return this._material}},geometry:{set:function(t){t instanceof Pt?this._geometry=t:this._geometry.setGeometry(t)},get:function(){return this._geometry}},numInstances:{set:function(t){this._numInstances=t,this.geometry.setCount(this.numInstances)},get:function(){return this._numInstances}}}),THREE.InstancedMesh.prototype.setPositionAt=function(t,e){this.geometry.setPositionAt(t,e)},THREE.InstancedMesh.prototype.setQuaternionAt=function(t,e){this.geometry.setQuaternionAt(t,e)},THREE.InstancedMesh.prototype.setScaleAt=function(t,e){this.geometry.setScaleAt(t,e)},THREE.InstancedMesh.prototype.getPositionAt=function(t,e){return this.geometry.getPositionAt(t,e)},THREE.InstancedMesh.prototype.getQuaternionAt=function(t,e){return this.geometry.getQuaternionAt(t,e)},THREE.InstancedMesh.prototype.getScaleAt=function(t,e){return this.geometry.getScaleAt(t,e)},THREE.InstancedMesh.prototype.needsUpdate=function(){this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere()};var Tt;new THREE.BoxBufferGeometry(1,1,1),new THREE.MeshNormalMaterial({wireframe:!0});function Pt(){THREE.InstancedBufferGeometry.call(this),this.count=0;var t=this;this.boundOrigin=new THREE.Box3,this.arrTransform=[],this.gridTransform=new St(this.arrTransform),this.setCount=function(t){if(this.count=t,(this.maxInstancedCount||0)<t&&(!this.attributes.instanceQuaternion||this.attributes.instanceQuaternion.count<t)){var e={instanceQuaternion:new Float32Array(4*t),instancePosition:new Float32Array(3*t),instanceScale:new Float32Array(3*t)};this.setAttribute("instanceQuaternion",new THREE.InstancedBufferAttribute(e.instanceQuaternion,4)),this.setAttribute("instancePosition",new THREE.InstancedBufferAttribute(e.instancePosition,3)),this.setAttribute("instanceScale",new THREE.InstancedBufferAttribute(e.instanceScale,3)),this.needsUpdate=!0}for(var i=0;i<t;i++)this.arrTransform[i]=new Et(this.boundOrigin);this.maxInstancedCount=t},this.setGeometry=function(t){return this.copy(t),this.boundOrigin.setFromBufferAttribute(this.attributes.position),this};var e=new THREE.Frustum,i=new THREE.Matrix4;this.arrTransformVisible=[],this.update=function(n){i.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),e.setFromMatrix(i);var s=0;this.arrTransformVisible=[];for(var a=0;a<this.gridTransform.arrGridIndex.length;a++){var r=this.gridTransform.arrGridIndex[a];if(e.intersectsBox(r.boundingBox))for(var o=0;o<r.arrTransform.length;o++){var h=r.arrTransform[o];this.arrTransformVisible.push(h),this.setTransformAt(s++,h)}}t.maxInstancedCount=s,t.needsUpdate=!0},this.updateGrid=function(){this.gridTransform.updateGrid()}}function Et(t){this.boundOrigin=t,this._boundingBox=null,this.p=new THREE.Vector3,this.s=new THREE.Vector3(1,1,1),this.q=new THREE.Quaternion,this.setP=function(t){this.p.copy(t)},this.setS=function(t){this.s.copy(t)},this.setQ=function(t){this.q.copy(t)}}function St(t){var e=this;this.arrTransform=t;var i=100;function n(t){var n="x"+Math.floor(t.x/i)+"y"+Math.floor(t.y/i)+"z"+Math.floor(t.z/i);return e.cache[n]||(e.cache[n]=new Ct),e.cache[n]}this.arrGridIndex=[],this.cache={},this.updateGrid=function(){this.arrGridIndex.length=0,this.cache={};for(var t=0;t<this.arrTransform.length;t++){var e=this.arrTransform[t];n(e.p).arrTransform.push(e)}for(var i in this.cache)this.cache[i].computeBoundingBox(),this.arrGridIndex.push(this.cache[i])}}function Ct(){this.arrTransform=[],this._boundingBox=null}Pt.prototype=Object.create(THREE.InstancedBufferGeometry.prototype),Pt.constructor=Pt,Pt.prototype.setTransformAt=function(t,e){this.attributes.instanceScale.setXYZ(t,e.s.x,e.s.y,e.s.z),this.attributes.instancePosition.setXYZ(t,e.p.x,e.p.y,e.p.z),this.attributes.instanceQuaternion.setXYZW(t,e.q.x,e.q.y,e.q.z,e.q.w)},Pt.prototype.setPositionAt=function(t,e){this.arrTransform[t].setP(e),this.setTransformAt(t,this.arrTransform[t])},Pt.prototype.setQuaternionAt=function(t,e){this.arrTransform[t].setQ(e),this.setTransformAt(t,this.arrTransform[t])},Pt.prototype.setScaleAt=function(t,e){this.arrTransform[t].setS(e),this.setTransformAt(t,this.arrTransform[t])},Pt.prototype.getPositionAt=function(t,e){return e?e.copy(this.arrTransform[t].p):this.arrTransform[t].p},Pt.prototype.getQuaternionAt=function(t,e){return e?e.copy(this.arrTransform[t].q):this.arrTransform[t].q},Pt.prototype.getScaleAt=function(t,e){return e?e.copy(this.arrTransform[t].s):this.arrTransform[t].s},Pt.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.computeBoundingBox(),this.boundingBox.getBoundingSphere(this.boundingSphere),this.updateGrid()},Pt.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.makeEmpty();for(var t=0,e=this.count;t<e;t++)this.boundingBox.union(this.getBoundingBoxAt(t))},Pt.prototype.getBoundingBoxAt=function(t){return this.arrTransform[t].boundingBox},Object.defineProperties(Pt.prototype,{needsUpdate:{set:function(t){this.attributes.instancePosition.needsUpdate=t,this.attributes.instanceQuaternion.needsUpdate=t,this.attributes.instanceScale.needsUpdate=t},get:function(){return!1}}}),Et.prototype.computeBoundingBox=(Tt=new THREE.Matrix4,function(){return this._boundingBox||(this._boundingBox=new THREE.Box3),Tt.compose(this.p,this.q,this.s),this.boundingBox.copy(this.boundOrigin),this.boundingBox.applyMatrix4(Tt),this.boundingBox}),Object.defineProperties(Et.prototype,{boundingBox:{set:function(t){this._boundingBox=t},get:function(){return this._boundingBox||this.computeBoundingBox()}}}),Ct.prototype.computeBoundingBox=function(){this._boundingBox||(this._boundingBox=new THREE.Box3),this.boundingBox.makeEmpty();for(var t=0,e=this.arrTransform.length;t<e;t++)this.boundingBox.union(this.arrTransform[t].boundingBox);return this.boundingBox},Object.defineProperties(Ct.prototype,{boundingBox:{set:function(t){this._boundingBox=t},get:function(){return this._boundingBox||this.computeBoundingBox()}}});var jt=["#ifndef INSTANCE_TRANSFORM","vec3 transformed = vec3( position );","#else","#ifndef INSTANCE_MATRIX","mat4 _instanceMatrix = getInstanceMatrix();","#define INSTANCE_MATRIX","#endif","vec3 transformed = ( _instanceMatrix * vec4( position , 1. )).xyz;","#endif"].join("\n"),Dt=["#ifdef USE_COLOR","diffuseColor.rgb *= vColor;","#endif","#if defined(INSTANCE_COLOR)","diffuseColor.rgb *= vInstanceColor;","#endif"].join("\n"),kt=["#ifdef USE_COLOR","varying vec3 vColor;","#endif","#if defined( INSTANCE_COLOR )","varying vec3 vInstanceColor;","#endif"].join("\n"),Lt=["#ifdef USE_COLOR","vColor.xyz = color.xyz;","#endif","#if defined( INSTANCE_COLOR ) && defined( INSTANCE_TRANSFORM )","vInstanceColor = instanceColor;","#endif"].join("\n"),Ft=["#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","#ifndef INSTANCE_TRANSFORM","vec3 transformedNormal = normalMatrix * objectNormal;","#else","#ifndef INSTANCE_MATRIX ","mat4 _instanceMatrix = getInstanceMatrix();","#define INSTANCE_MATRIX","#endif","#ifndef INSTANCE_UNIFORM","vec3 transformedNormal =  transposeMat3( inverse( mat3( modelViewMatrix * _instanceMatrix ) ) ) * objectNormal ;","#else","vec3 transformedNormal = ( modelViewMatrix * _instanceMatrix * vec4( objectNormal , 0.0 ) ).xyz;","#endif","#endif"].join("\n"),Ot=["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )","varying vec2 vUv;","uniform mat3 uvTransform;","#endif","#ifdef INSTANCE_TRANSFORM","mat3 inverse(mat3 m) {","float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];","float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];","float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];","float b01 = a22 * a11 - a12 * a21;","float b11 = -a22 * a10 + a12 * a20;","float b21 = a21 * a10 - a11 * a20;","float det = a00 * b01 + a01 * b11 + a02 * b21;","return mat3(b01, (-a22 * a01 + a02 * a21), ( a12 * a01 - a02 * a11),","b11, ( a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),","b21, (-a21 * a00 + a01 * a20), ( a11 * a00 - a01 * a10)) / det;","}","attribute vec3 instancePosition;","attribute vec4 instanceQuaternion;","attribute vec3 instanceScale;","#if defined( INSTANCE_COLOR )","attribute vec3 instanceColor;","varying vec3 vInstanceColor;","#endif","mat4 getInstanceMatrix(){","vec4 q = instanceQuaternion;","vec3 s = instanceScale;","vec3 v = instancePosition;","vec3 q2 = q.xyz + q.xyz;","vec3 a = q.xxx * q2.xyz;","vec3 b = q.yyz * q2.yzz;","vec3 c = q.www * q2.xyz;","vec3 r0 = vec3( 1.0 - (b.x + b.z) , a.y + c.z , a.z - c.y ) * s.xxx;","vec3 r1 = vec3( a.y - c.z , 1.0 - (a.x + b.z) , b.y + c.x ) * s.yyy;","vec3 r2 = vec3( a.z + c.y , b.y - c.x , 1.0 - (a.x + b.x) ) * s.zzz;","return mat4(","r0 , 0.0,","r1 , 0.0,","r2 , 0.0,","v  , 1.0",");","}","#endif"].join("\n");function Mt(t,e,i){this.type="PMFilt";var n=this;this.par=t,this.visi3D=e,this.objbase=i,this.ceshGeom=new zt(this),this.setObjS=function(t,e){!0,t.object.filt&&0!=t.object.filt.length?new Bt(this,t,e):this.finalObjS(t,e)},this.finalObjS=function(t,e){t.object.param&&(1==t.object.param.kesh&&n.ceshGeom.set(t.content3d),null!=t.object.param.sG&&1==t.object.param.sG&&n.ceshGeom.groupGeometri(t.content3d)),e()},this.dragParam=function(t,e){if(t.children)for(var i=t.children.length-1;i>=0;i--)this.dragParam(t.children[i],e);null==t.bs&&(t.castShadow=e.tOt,t.receiveShadow=e.tNa);var n=e.rO;t.iz&&t.iz.renderOrder&&(n=t.iz.renderOrder),t.renderOrder=n},this.dragPozition=function(t){var e=!1;t.object&&t.object.psm&&(e=!0,null!=t.object.psm.active&&0==t.object.psm.active&&(e=!1)),1==e?(t.content3d.position.set(t.object.psm.p[0],t.object.psm.p[1],t.object.psm.p[2]),t.content3d.rotation.set(t.object.psm.r[0],t.object.psm.r[1],t.object.psm.r[2]),t.content3d.scale.set(t.object.psm.s[0],t.object.psm.s[1],t.object.psm.s[2])):(t.content3d.position.set(0,0,0),t.content3d.rotation.set(0,0,0),t.content3d.scale.set(1,1,1))}}function Bt(t,e,i){this.type="StartFilt";this.par=t,this.hron=e,this.fun=i,this.hron.filt=this,this.array=[];var n,s=0;this.dragFilt=function(){s!=this.hron.object.filt.length?(n=this.hron.object.filt[s].type,s++,"mark"==n&&this.array.push(new Rt(this,this.hron.object.filt[s-1],this.array.length)),"material"==n&&this.array.push(new It(this,this.hron.object.filt[s-1],this.array.length))):this.par.finalObjS(this.hron,this.fun)},this.dragFilt()}function It(t,e,i){this.type="PMMaterial";this.par=t,this.obj=e,this.idArr=i,this.mat=this.par.par.par.mat.getTestTitle(e.id),null!=this.mat?(this.parsing=function(t){if(t.children)for(var e=t.children.length-1;e>=0;e--)this.parsing(t.children[e]);null!=t.material&&(t.material=this.mat)},this.parsing(t.hron.content3d),this.par.dragFilt()):this.par.dragFilt()}function Rt(t,e,i){this.type="PMMark";var n=this;if(this.par=t,this.obj=e,this.idArr=i,this.idKey=e.id,this.c3d=t.hron.content3d,this.arrName=[],this.arrayObj=[],"null"!=this.idKey){var s,a=!0;if(-1!=e.id.indexOf("|")){for(var r=e.id.split("|"),o=r[0].split(","),h=r[1].split(","),l=0;l<o.length;l++)this.arrName[l]={name:o[l],id:1*h[l],obCont:null};a=!1}else a=!0,this.arrName[0]={name:"null",id:e.id,obCont:null};this.parsing=function(t){if(t.children)for(var e=t.children.length-1;e>=0;e--)this.parsing(t.children[e]);if("Mesh"==t.type)if(a)s=this.arrName[0].obCont.clone(),t.parent.add(s),s.position.set(t.position.x,t.position.y,t.position.z),s.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),s.scale.set(t.scale.x,t.scale.y,t.scale.z),t.parent.remove(t);else if(t.name)for(e=this.arrName.length-1;e>=0;e--)if(-1!=t.name.indexOf(this.arrName[e].name))return s=this.arrName[e].obCont.clone(),t.parent.add(s),s.position.set(t.position.x,t.position.y,t.position.z),s.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),s.scale.set(t.scale.x,t.scale.y,t.scale.z),void t.parent.remove(t)},this.loadMMM=function(t){this.par.par.par.getId(1*t.id,function(e){t.obCont=e,n.loadMod()})},this.loadMod=function(){for(var t=0;t<this.arrName.length;t++)if(null==this.arrName[t].obCont)return void this.loadMMM(this.arrName[t]);this.parsing(this.c3d),this.par.dragFilt()},this.loadMod()}else this.par.dragFilt()}function zt(t){this.type="CeshGeom";var e=this;e.kolCount=9999,this.par=t;var i,n,s={};function a(t,e,i,n){i&&e.updateMatrixWorld(),n&&t.updateMatrixWorld();var s=(new THREE.Matrix4).getInverse(e.matrixWorld);t.parent&&s.multiply(t.parent.matrixWorld),t.applyMatrix(s),e.add(t)}this.set=function(t){for(var i in s={},e.fillObjMesh(t),s)s[i].length>=2&&new Ht(this,t,s[i])},this.sliteGeom=new Nt,this.groupGeometri=function(t){s={},e.fillObjMesh(t);var r=!1;for(var o in s)if(s[o].length>=2){r=!0,this.sliteGeom.start(s[o][0].geometry.clone());for(var h=s[o].length-1;h>=0;h--)a(i=s[o][h],t),this.sliteGeom.setMesh(i),i.parent.remove(i);this.sliteGeom.final(),n=new THREE.Mesh(this.sliteGeom.creatGeom,i.material),t.add(n)}r&&e.killNull(t)},e.killNull=function(t){if(t.children)for(var i=t.children.length-1;i>=0;i--)e.killNull(t.children[i]);null!=t.geometry||null==t.children||0!=t.children.length||null==t.parent||t.parent.remove(t)},e.fillObjMesh=function(t){for(var i=function t(e){var i=[];e.updateMatrixWorld();e instanceof THREE.Mesh&&i.push(e);for(var n=0;n<e.children.length;n++)for(var s=t(e.children[n]),a=0;a<s.length;a++)i.push(s[a]);return i}(t),n=0;n<i.length;n++)i[n].geometry&&i[n].geometry.index&&i[n].geometry.index.count<e.kolCount&&(s[i[n].geometry.uuid]=s[i[n].geometry.uuid]||[],s[i[n].geometry.uuid].push(i[n]))},this.moveObject=function(t,e,i,n){a(t,e,i,n)}}function Ht(t,e,i){this.type="LoadTime";var n,s=this;this.par=t,this.c3d=e,this.arr=i,this.mesh=i[0],this.geom=i[0].geometry,this.mate=i[0].material;var a=!0;this.initLoad=function(){a=!1,s.mate&&null!=s.mate.idObj&&0==s.mate.loadTexure&&(a=!0),0==a?setTimeout(function(){s.initLoad()},50):s.creat()},this.creat=function(){for(var t=i.length-1;t>=0;t--)n=i[t],this.par.moveObject(n,e),n.parent.remove(n);this.meshCombined=new yt(i),e.add(this.meshCombined);for(this.meshCombined._meshes,t=0;t<this.meshCombined.children.length;t++)this.meshCombined.children[t].castShadow=n.castShadow,this.meshCombined.children[t].receiveShadow=n.receiveShadow,this.meshCombined.children[t].renderOrder=n.renderOrder;this.par.killNull(e)},this.initLoad()}function Nt(){this.type="SliteGeom";var t;this.geometry,this.kol,this.ah=[],this.sah=0,this.sahMesh=0,this.creatGeom,this.ap=[],this.ai=[],this.auv=[],this.start=function(t){this.geometry=t,this.creatGeom=new THREE.BufferGeometry,this.sah=0,this.sahMesh=0,this.ap=[],this.ai=[],this.auv=[],this.sPosit()},this.sPosit=function(){for(var t=0;t<this.geometry.index.count;t++)null==this.ah[this.sah]&&(this.ah[this.sah]=new Xt),this.ah[this.sah].posOld.set(this.geometry.attributes.position.array[3*this.geometry.index.array[t]],this.geometry.attributes.position.array[3*this.geometry.index.array[t]+1],this.geometry.attributes.position.array[3*this.geometry.index.array[t]+2]),this.ah[this.sah].uv.set(this.geometry.attributes.uv.array[2*this.geometry.index.array[t]],this.geometry.attributes.uv.array[2*this.geometry.index.array[t]+1]),this.ah[this.sah].index=this.geometry.index.array[t],this.sah++},this.setMesh=function(e){t=this.sahMesh*this.sah;for(var i=0;i<this.sah;i++)this.ah[i].setMesh(e),this.ap.push(this.ah[i].pos.x,this.ah[i].pos.y,this.ah[i].pos.z),this.auv.push(this.ah[i].uv.x,this.ah[i].uv.y),this.ai.push(this.ah[i].index+t);this.sahMesh++},this.final=function(){this.creatGeom.setIndex(this.ai),this.creatGeom.addAttribute("position",new THREE.BufferAttribute(new Float32Array(this.ap),3)),this.creatGeom.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(this.auv),2)),this.creatGeom.attributes.position.needsUpdate=!0,this.creatGeom.attributes.uv.needsUpdate=!0,this.creatGeom.computeVertexNormals(),this.creatGeom.attributes.normal.needsUpdate=!0,this.creatGeom.computeBoundingBox(),this.creatGeom.computeBoundingSphere()}}function Xt(){this.type="SliteGeom",this.pos=new THREE.Vector3,this.posOld=new THREE.Vector3,this.uv=new THREE.Vector2,this.index=0,this.setMesh=function(t){this.pos.set(this.posOld.x,this.posOld.y,this.posOld.z),this.pos.applyMatrix4(t.matrix)}}function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wt(t,e,i){this.type="PMFilt";var n,s,a,r=this;this.par=t,this.visi3D=e,this.objbase=i,this.setHron=function(t,e){var i,n;i=t.object.iz,n=t.content3d,e&&(n=e),null!=n&&null!=i&&1==i.a&&this.setMod(n,this.strToObj(i.str),i.st)},this.strToObj=function(t){for(var e="",i=0;i<t.length;i++)"|"==t[i]?e+='"':e+=t[i];return JSON.parse(e)},this.getIz=function(t){if(n++,null!=t.iz){var e=0;null!=t.iz.renderOrder&&(0==e&&(e={}),e.renderOrder=t.iz.renderOrder),null!=t.iz.bs&&(0==e&&(e={}),e.bs=t.iz.bs),null!=t.iz.mod&&(0==e&&(e={}),e.mod=t.iz.mod),null!=t.iz.position&&(0==e&&(e={}),e.position=t.iz.position),null!=t.iz.scale&&(0==e&&(e={}),e.scale=t.iz.scale),null!=t.iz.rotation&&(0==e&&(e={}),e.rotation=t.iz.rotation),null!=t.iz.visible&&(0==e&&(e={}),e.visible=t.iz.visible),null!=t.iz.material&&(0==e&&(e={}),e.material=t.iz.material),0!=e&&(e.sah=n),s.push(e)}else s.push(0);if(t.children&&null==t.notPar)for(var i=0;i<t.children.length;i++)this.getIz(t.children[i])},this.getMod=function(t){return n=-1,s=[],this.getIz(t),s},this.setIz=function(t,e){if(a[++n]&&0!=a[n]){if(t.iz={},null!=a[n].mod){e&&(t.iz.mod=a[n].mod);for(var i=new THREE.Object3D,s=0,o=0;o<t.parent.children.length;o++)t.parent.children[o].uuid==t.uuid&&(s=o);i.notPar=!0,t.parent.add(i),t.parent.remove(t),i.parent.children.splice(i.parent.children.length-1,1),i.parent.children.splice(s,0,i),r.par.getId(a[n].mod,function(t){i.add(t)})}null!=a[n].renderOrder&&(e&&(t.iz.renderOrder=a[n].renderOrder),t.renderOrder=a[n].renderOrder),null!=a[n].bs&&(e&&(t.iz.bs=a[n].bs),t.bs=a[n].bs),null!=a[n].position&&(e&&(t.iz.position=a[n].position),t.position.set(a[n].position.x,a[n].position.y,a[n].position.z)),null!=a[n].scale&&(e&&(t.iz.scale=a[n].scale),t.scale.set(a[n].scale.x,a[n].scale.y,a[n].scale.z)),null!=a[n].rotation&&(e&&(t.iz.rotation=a[n].rotation),t.rotation.set(a[n].rotation.x,a[n].rotation.y,a[n].rotation.z)),null!=a[n].visible&&(e&&(t.iz.visible=a[n].visible),t.visible=a[n].visible),null!=a[n].material&&t.material&&(null==t.oldName&&(t.oldName=t.material.name),e&&(t.iz.material=a[n].material),t.material=r.par.mat.getIDReturn(a[n].material))}if(t.children&&null==t.notPar)for(o=0;o<t.children.length;o++)this.setIz(t.children[o])},this.setMod=function(t,e,i){"object"==Ut(e)&&null!=e[0]&&(a=e,n=-1,this.setIz(t,i))},this.setMat=function(t,e,i,n){if(null!=n&&(n=!0),null!=t.material&&(null==t.oldName&&(t.oldName=t.material.name),e=this.par.mat.getIDReturn(e,n),null==i?(t.material=e,null==t.iz&&(t.iz={}),t.iz.material=e.idUz):t.oldName&&-1!=t.oldName.indexOf(i)&&(t.material=e,null==t.iz&&(t.iz={}),t.iz.material=e.idUz)),t.children&&null==t.notPar)for(var s=0;s<t.children.length;s++)this.setMat(t.children[s],e,i,n)}}function Gt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}THREE.ShaderChunk.begin_vertex=jt,THREE.ShaderChunk.color_fragment=Dt,THREE.ShaderChunk.color_pars_fragment=kt,THREE.ShaderChunk.color_vertex=Lt,THREE.ShaderChunk.defaultnormal_vertex=Ft,THREE.ShaderChunk.uv_pars_vertex=Ot;var Vt=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="PMTexture",this.par=e,this.param=this.par.param,this.nameType="textures",this.visi3D=i,this.objbase=n,this.loader=new THREE.TextureLoader,this.textureCache={},window.textureCache=this.textureCache}var e,i,n;return e=t,(i=[{key:"getById",value:function(t,e){var i=this;if(this.textureCache[t]&&this.textureCache[t].loaded)return e&&setTimeout(function(){return e(i.textureCache[t].texture)},0),this.textureCache[t].texture;var n=this.getObj(t);return this.loadTexture(n,e)}},{key:"loadTexture",value:function(t,e){var i=this;if(this.textureCache[t.id]&&this.textureCache[t.id].callbacks||(this.textureCache[t.id]={callbacks:[]}),!this.textureCache[t.id].texture){var n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAACXBIWXMAAB7CAAAewgFu0HU+AAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAABtJREFUeNpi+M/A8B8KGRgYGP43AAAAAP//AwA/UwZ7TELoKQAAAABJRU5ErkJggg==";t.obj&&t.obj.res&&(n=t.obj.res.src);var s=this.loader.load(n,function(e){i.visi3D&&(i.visi3D.intRend=1),e.obj={},i.textureCache[t.id].callbacks.forEach(function(t){return t(e)}),delete i.textureCache[t.id].callbacks,i.textureCache[t.id].loaded=!0});s.arrMat=[],s.arrRun=[],s.wrapS=s.wrapT=THREE.RepeatWrapping,t.obj&&t.obj.res&&(s.repeat.x=t.obj.rx,s.repeat.y=t.obj.ry),this.textureCache[t.id].texture=s}return e&&this.textureCache[t.id].callbacks.push(e),this.textureCache[t.id].texture}},{key:"updateTexture",value:function(t,e){var i=this;if(trace("updateTexture",t,e),this.textureCache[t.id])if(e){var n=new Image,s=window.location.href.split("/");s.pop(),n.src=s.join("/")+"/resources/data/"+t.id+"/pic."+t.type,n.crossOrigin=null,this.textureCache[t.id].texture.image=n,this.textureCache[t.id].loaded=!1,n.onload=function(){delete i.textureCache[t.id].callbacks,i.textureCache[t.id].loaded=!0,i.textureCache[t.id].texture.needsUpdate=!0}}else this.textureCache[t.id].texture.repeat.x=t.rx,this.textureCache[t.id].texture.repeat.y=t.ry}},{key:"getObj",value:function(t){for(var e=0;e<this.param[this.nameType].length;e++)if(t==this.param[this.nameType][e].id){var i=void 0;return i="string"==typeof this.param[this.nameType][e].json?JSON.parse(this.param[this.nameType][e].json):this.param[this.nameType][e].json,this.param[this.nameType][e].obj=i,this.param[this.nameType][e]}return null}}])&&Gt(e.prototype,i),n&&Gt(e,n),t}();function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qt(t,e,i){this.type="PM";this.objbase=e,this.visi3D=t,this.param=i,this.plus="?1",this.loaderGLTF=new THREE.GLTFLoader,this.tex=new Vt(this,t,e),this.mat=new bt.a(this,t,e),this.filt=new Mt(this,t,e),this.iz=new Wt(this,t,e),this.matDop=new vt(this,t,e),this.arrayHron=[],this.getId=function(t,e,i){if(1==i)for(var n=0;n<this.arrayHron.length;n++)1==this.arrayHron[n].testId(t)&&this.arrayHron.splice(n,1);for(n=0;n<this.arrayHron.length;n++)if(1==this.arrayHron[n].testId(t))return void this.arrayHron[n].setFun(e);this.arrayHron.push(new Zt(this,t,e))},this.clear=function(){}}function Zt(t,e,i){this.type="Hron";var n,s,a=this;if(this.par=t,this.idObj=e,this.id=void 0,this.object=void 0,this.link=void 0,this.filt=void 0,this.content3d=void 0,this.param=this.par.param,this.nameType=this.param.arrayName[0],this.objBig=void 0,this.array=[],this.array.push(i),this.boolClone=!0,this.setFun=function(t){if(null!=this.content3d)return(n=1==a.boolClone?a.content3d.clone():a.content3d).hron=this,this.par.iz.setHron(this,n),this.object.param&&this.par.filt.dragParam(n,this.object.param),void t(n);this.array.push(t)},this.finalLoad=function(t){this.getObj3D(t),this.content3d=t,t.name="hron_"+this.id,this.par.mat.setObjS(this.content3d,this.object,this.finalLoad1)},this.finalLoad1=function(){a.par.filt.setObjS(a,a.finalLoad2)},this.finalLoad2=function(){for(var t=0;t<a.array.length;t++)(n=1==a.boolClone?a.content3d.clone():a.content3d).hron=a,a.par.iz.setHron(a,n),a.object.param&&a.par.filt.dragParam(n,a.object.param),a.array[t](n)},this.loadObject=function(){},this.start=function(){if(null==this.object&&(this.object={}),null==this.object&&(this.object={}),null==this.object.res)this.finalLoad(new THREE.Mesh(new THREE.BoxBufferGeometry(100,100,100)));else{var t=this.object.res.src.replace("http://","https://");this.par.loaderGLTF.load(t,function(t){a.finalLoad(t.scene)})}},this.testId=function(t){return s="number"==typeof t?t:t.id,(null==this.id?this.idObj.id:this.id)==s},this.getObj3D=function(e){if(null!=e.material&&null!=e.material.roughnessMap&&t.visi3D&&(e.material.envMap=t.visi3D.cubeMap.getTexture()),null!=e){if(null!=e.children)for(var i=e.children.length-1;i>=0;i--)this.getObj3D(e.children[i]);"Default_light"==e.name&&e.parent.remove(e)}},"object"==Yt(e))return a.object=e,void this.start(e);"number"==typeof e&&(this.id=e);for(var r=null,o=0;o<this.param[this.nameType].length;o++)if(this.param[this.nameType][o].id==this.id){this.param[this.nameType][o].json&&(r="string"==typeof this.param[this.nameType][o].json?JSON.parse(this.param[this.nameType][o].json):this.param[this.nameType][o].json);break}if(null!=r)return a.object=r,void a.start();var h={type:"GET"};h.url=this.param.server+this.nameType+"/"+e+"/",h.success=function(t){a.objBig=t,"string"==typeof t.json?a.object=JSON.parse(t.json):a.object=t.json,a.start()},$.ajax(h)}function Kt(){THREE.BufferGeometry.call(this),this.type="GeometrySten",this._rect={x:0,y:0,width:100,height:100},this._arrBox=[],this._textureWidth=256,this._textureHeight=256,this._depth=256,this._z=0,this._prossentWidth=0,this._prossentHeight=0,this._isInside=!1,this._isInverse=!1,this._okrog=5;var t,e,i,n,s=[],a=[],r=[],o=[],h=0,l=0,u=[],c=[],d=[],p=0,f=[],m=new THREE.Vector3,g=new THREE.Vector3,b=new THREE.Vector3,v=new THREE.Vector3,y=new THREE.Vector2,x=new THREE.Vector2,_=new THREE.Vector2,w=new THREE.Vector2,A=0;this.setRect=function(t,e,i,n){this._rect.x=t,this._rect.y=e,this._rect.width=i,this._rect.height=n,this.update()},this.startArrRect=function(){A=0;for(var t=0;t<a.length;t++)a[t]=0;for(t=0;t<s.length;t++)s[t]=0;if(this._isInside)for(t=0;t<this._arrBox.length;t++)n=this._arrBox[t],this.fillPointFromBox(n.x,n.y,n.width,n.height);else this.fillPointExcludeBox()},this.fillPointExcludeBox=function(){h=0,l=0;for(var t=!1,e=0;e<this._arrBox.length;e++)n=this._arrBox[e],this._rect.x<n.x+n.width&&this._rect.y<n.y+n.height&&this._rect.x+this._rect.width>n.x&&this._rect.y+this._rect.height>n.y&&(this._rect.x<=n.x&&(u[h++]=n.x),this._rect.x+this._rect.width>=n.x+n.width&&(u[h++]=n.x+n.width),this._rect.y<=n.y&&(c[l++]=n.y),this._rect.y+this._rect.height>=n.y+n.height&&(c[l++]=n.y+n.height));0==h&&0==l&&(t=!0);for(e=this._rect.x+this._textureWidth;e<this._rect.x+this._rect.width;e+=this._textureWidth)u[h++]=e;for(e=this._rect.y+this._textureHeight;e<this._rect.y+this._rect.height;e+=this._textureHeight)c[l++]=e;u[h++]=this._rect.x,u[h++]=this._rect.x+this._rect.width,c[l++]=this._rect.y,c[l++]=this._rect.y+this._rect.height,c.length=l,u.length=h,c.sort(function(t,e){return t-e}),u.sort(function(t,e){return t-e});for(e=0;e<u.length;e++)u[e]==u[e+1]&&(u.splice(e+1,1),e--);for(e=0;e<c.length;e++)c[e]==c[e+1]&&(c.splice(e+1,1),e--);for(e=0;e<c.length;e++){null==f[e]&&(f[e]=[]);for(var i=0;i<u.length;i++)f[e][i]=this.inBox(u[i],c[e],u[i+1],c[e+1])}if(t)this.fillPointFromBox(u[0],c[0],Math.abs(u[u.length-1]-u[0]),Math.abs(c[c.length-1]-c[0]));else for(e=0;e<c.length-1;e++)for(i=0;i<u.length-1;i++)f[e][i]||this.fillPointOptimiz(i,e)},this.fillPointFromBox=function(t,e,i,n){if(this._rect){if(e+n<=this._rect.y)return;if(t+i<=this._rect.x)return;if(e>=this._rect.y+this._rect.height)return;if(t>=this._rect.x+this._rect.width)return}l=0,h=0;for(var s=this._rect.x+this._textureWidth;s<t+i;s+=this._textureWidth)s>=t&&s<=t+i&&(r[h++]=s);for(s=this._rect.y+this._textureHeight;s<e+n;s+=this._textureHeight)s>=e&&s<=e+n&&(o[l++]=s);t>=this._rect.x?r[h++]=t:r[h++]=this._rect.x,t+i<=this._rect.x+this._rect.width?r[h++]=t+i:r[h++]=this._rect.x+this._rect.width,e>=this._rect.y?o[l++]=e:o[l++]=this._rect.y,e+n<=this._rect.y+this._rect.height?o[l++]=e+n:o[l++]=this._rect.y+this._rect.height,o.length=l,r.length=h,o.sort(function(t,e){return t-e}),r.sort(function(t,e){return t-e});for(s=0;s<r.length;s++)(r[s]==r[s+1]||r[s+1]>this._rect.x+this._rect.width)&&(r.splice(s+1,1),s--);for(s=0;s<o.length;s++)(o[s]==o[s+1]||o[s+1]>this._rect.y+this._rect.height)&&(o.splice(s+1,1),s--);this.fillPointSetka()},this.pluspoli=function(t){this._isInverse&&(t=!t),t?(a[18*A+0]=m.x,a[18*A+1]=m.y,a[18*A+2]=m.z,a[18*A+3]=g.x,a[18*A+4]=g.y,a[18*A+5]=g.z,a[18*A+6]=b.x,a[18*A+7]=b.y,a[18*A+8]=b.z,a[18*A+9]=m.x,a[18*A+10]=m.y,a[18*A+11]=m.z,a[18*A+12]=b.x,a[18*A+13]=b.y,a[18*A+14]=b.z,a[18*A+15]=v.x,a[18*A+16]=v.y,a[18*A+17]=v.z,s[12*A+0]=y.x,s[12*A+1]=y.y,s[12*A+2]=x.x,s[12*A+3]=x.y,s[12*A+4]=_.x,s[12*A+5]=_.y,s[12*A+6]=y.x,s[12*A+7]=y.y,s[12*A+8]=_.x,s[12*A+9]=_.y,s[12*A+10]=w.x,s[12*A+11]=w.y):(a[18*A+0]=m.x,a[18*A+1]=m.y,a[18*A+2]=m.z,a[18*A+3]=b.x,a[18*A+4]=b.y,a[18*A+5]=b.z,a[18*A+6]=g.x,a[18*A+7]=g.y,a[18*A+8]=g.z,a[18*A+9]=m.x,a[18*A+10]=m.y,a[18*A+11]=m.z,a[18*A+12]=v.x,a[18*A+13]=v.y,a[18*A+14]=v.z,a[18*A+15]=b.x,a[18*A+16]=b.y,a[18*A+17]=b.z,s[12*A+0]=y.x,s[12*A+1]=y.y,s[12*A+2]=_.x,s[12*A+3]=_.y,s[12*A+4]=x.x,s[12*A+5]=x.y,s[12*A+6]=y.x,s[12*A+7]=y.y,s[12*A+8]=w.x,s[12*A+9]=w.y,s[12*A+10]=_.x,s[12*A+11]=_.y),A++},this.inBox=function(t,e,i,s){for(var a=0;a<this._arrBox.length;a++)if(t>=(n=this._arrBox[a]).x&&i<=n.x+n.width&&e>=n.y&&s<=n.y+n.height)return!0;return!1},this.fillPointOptimiz=function(t,e){for(var i=e,n=0,s=0,a=0,r=t+1;i<c.length&&!(0==Math.abs((c[i]-this._rect.y)/this._textureHeight%1)&&i>e);r++)(f[i][r]||r==u.length-1||0==Math.abs((u[r]-this._rect.x)/this._textureWidth%1))&&(-1!=(s=this.getBoolRectPow(t,e,r,++i))&&(d[p++]=[r,i],n<s&&(n=s,a=p-1)),r=t);this.fillPointFromBox(u[t],c[e],Math.abs(u[d[a][0]]-u[t]),Math.abs(c[d[a][1]]-c[e])),this.setBoolRect(t,e,d[a][0],d[a][1])},this.setBoolRect=function(t,e,i,n){for(var s=e;s<f.length&&s<n;s++)for(var a=t;a<f[s].length&&a<i;a++)f[s][a]=!0},this.getBoolRectPow=function(t,e,i,n){for(var s=0,a=e;a<f.length&&a<n;a++)for(var r=t;r<f[a].length&&r<i;r++){if(f[a][r])return-1;s++}return s};var T=0,P=0,E=0,S=0,C=0,j=0,D=0,k=0;this.fillPointSetka=function(){for(var t=0;t<o.length-1;t++)for(var e=0;e<r.length-1;e++)0,T=r[e],E=o[t],P=r[e+1],S=o[t+1],C=Math.abs((T-this._rect.x)/this._textureWidth%1)||0,D=Math.abs((E-this._rect.y)/this._textureHeight%1)||0,j=Math.abs((P-this._rect.x)/this._textureWidth%1)||1,k=Math.abs((S-this._rect.y)/this._textureHeight%1)||1,m.set(T,E,this._z),g.set(P,E,this._z),b.set(P,S,this._z),v.set(T,S,this._z),y.set(C,D),x.set(j,D),_.set(j,k),w.set(C,k),this.pluspoli(),this._depth&&(m.set(T,E,this._z+this._depth),g.set(P,E,this._z+this._depth),b.set(P,S,this._z+this._depth),v.set(T,S,this._z+this._depth),y.set(C,D),x.set(j,D),_.set(j,k),w.set(C,k),this.pluspoli(!0),this.fillPointEdge(t,e))},this._isLeft=!0,this._isRight=!0,this.fillPointEdge=function(t,e,i){T=r[e],E=o[t],P=r[e+1],S=o[t+1],C=Math.abs((T-this._rect.x)/this._textureWidth%1)||0,D=Math.abs((E-this._rect.y)/this._textureHeight%1)||0,j=Math.abs((P-this._rect.x)/this._textureWidth%1)||1,k=Math.abs((S-this._rect.y)/this._textureHeight%1)||1,0==t&&(m.set(T,E,this._z),g.set(P,E,this._z),b.set(P,E,this._z+this._depth),v.set(T,E,this._z+this._depth),y.set(C,0),x.set(j,0),_.set(j,1),w.set(C,1),this.pluspoli(!i)),t==o.length-2&&(m.set(T,S,this._z),g.set(P,S,this._z),b.set(P,S,this._z+this._depth),v.set(T,S,this._z+this._depth),y.set(C,0),x.set(j,0),_.set(j,1),w.set(C,1),this.pluspoli(i)),0==e&&(m.set(T,E,this._z),g.set(T,E,this._z+this._depth),b.set(T,S,this._z+this._depth),v.set(T,S,this._z),y.set(0,D),x.set(1,D),_.set(1,k),w.set(0,k),1==this._isLeft&&this.pluspoli(!i)),e==r.length-2&&(m.set(P,E,this._z),g.set(P,E,this._z+this._depth),b.set(P,S,this._z+this._depth),v.set(P,S,this._z),y.set(0,D),x.set(1,D),_.set(1,k),w.set(0,k),1==this._isRight&&this.pluspoli(i))},this.createBuffer=function(){(!i||i.length<3*a.length)&&(i=new Float32Array(3*a.length),this.addAttribute("position",new THREE.BufferAttribute(i,3)),e=new Float32Array(2*a.length),this.addAttribute("uv",new THREE.BufferAttribute(e,2)),t=new Float32Array(3*a.length),this.addAttribute("normal",new THREE.BufferAttribute(t,3)));for(var n=0;n<i.length;n++)i[n]=0;for(n=0;n<a.length;n++)this.attributes.position.array[n]=Math.round(100*a[n])/100;for(n=0;n<s.length;n++)e[n]=s[n];this.attributes.position.needsUpdate=!0,this.attributes.uv.needsUpdate=!0,this.computeVertexNormals(),this.attributes.normal.needsUpdate=!0,this.computeBoundingBox(),this.computeBoundingSphere()},this.update=function(){this.startArrRect(),this.createBuffer()},this.full=function(){this._textureHeight=this._rect.height,this._textureWidth=this._rect.width,this.update()},this.update(),Object.defineProperty(this,"isLeft",{set:function(t){this._isLeft!=t&&(this._isLeft=t,this.update())},get:function(){return this._isLeft}}),Object.defineProperty(this,"isRight",{set:function(t){this._isRight!=t&&(this._isRight=t,this.update())},get:function(){return this._isRight}}),Object.defineProperty(this,"textureWidth",{set:function(t){this._textureWidth!=t&&(this._textureWidth=t>0?t:1,this.update())},get:function(){return this._textureWidth}}),Object.defineProperty(this,"textureHeight",{set:function(t){this._textureHeight!=t&&(this._textureHeight=t>0?t:1,this.update())},get:function(){return this._textureHeight}}),Object.defineProperty(this,"rect",{set:function(t){this._rect=t,this.update()},get:function(){return this._rect}}),Object.defineProperty(this,"arrBox",{set:function(t){this._arrBox=t,this.update()},get:function(){return this._arrBox}}),Object.defineProperty(this,"depth",{set:function(t){this._depth!=t&&(this._depth=t,this.update())},get:function(){return this._depth}}),Object.defineProperty(this,"isInside",{set:function(t){this._isInside!=t&&(this._isInside=t,this.update())},get:function(){return this._isInside}}),Object.defineProperty(this,"okrog",{set:function(t){this._okrog!=t&&(this._okrog=t,this.update())},get:function(){return this._okrog}}),Object.defineProperty(this,"prossentWidth",{set:function(t){this._prossentWidth!=t&&(this._prossentWidth=t,this.update())},get:function(){return this._prossentWidth}}),Object.defineProperty(this,"prossentHeight",{set:function(t){this._prossentHeight!=t&&(this._prossentHeight=t,this.update())},get:function(){return this._prossentHeight}})}function qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $t(t,e,i){return e&&Jt(t.prototype,e),i&&Jt(t,i),t}Kt.prototype=Object.create(THREE.BufferGeometry.prototype),Kt.prototype.constructor=Kt;var te=function(){function t(e,i){qt(this,t);var n=this;this.type="MCVuev",this.par=e,this.fun=i,this.param=this.par.param,this.div=document.createElement("div"),this.div.style.position="fixed",this.div.style.top="0px",this.div.style.left="0px",this._color="null",this._d3Width=256,this._d3Height=256,this.pm=void 0,this._material=new THREE.MeshBasicMaterial({color:16777215}),this.visi3D,this.init=function(){JSON.parse('{"ambient":{"works":true,"active":true,"color":"#fdffff","intensity":0.71},"shadow":{"works":true,"active":true,"mapSize":4096,"color":"#8c8c8c","bias":-0.0014,"intensity":1.01,"radius":1.27,"bAlphaForCoating":false,"fixation":true,"rotationX":0.93,"rotationZ":0.73,"distance":500,"cubWidth":1000,"cubHeight":1000,"distanceUpdateShadow":65.41},"sky":{"works":true,"active":true,"color":"#ffffff","link":"resources/image/sky.jpg","rotZ":2.73,"radius":40000,"x":0,"y":0,"z":0},"mirror":{"works":true,"link":"null","exposure":1.44,"gamma":2.87,"xz":"reflect","link1":"null","exposure1":-1,"gamma1":-1},"visi3D":{"works":false,"alwaysRender":false,"fov":40,"far":77175,"minZum":0,"maxZum":30942,"zume":25000,"minRotationX":3.14,"maxRotationX":0,"rotationX":0.94,"rotationZ":0.17,"debug":false,"isDragPan":false,"alphaAd":false,"globZ":0,"powerZum":1},"fog":{"works":true,"active":false,"color":"#ffffff","near":0,"far":0},"effect":{"works":true,"active":false,"edgeStrength":3,"edgeGlow":0,"pulsePeriod":0,"linkTextur":"null","visibleEdgeColor":"#ffffff","hiddenEdgeColor":"#190a05"}}');mhbd.getKeyId("scenes3d",2,function(t){t.json.scene.ambient.intensity=1,n.init1(t.json.scene)})},this.init1=function(t){this.content3d=new THREE.Object3D;for(var e=0;e<this.param.scenes3d.length;e++)"sceneSB"==this.param.scenes3d[e].name&&(t=this.param.scenes3d[e].json.scene);t.visi3D.alphaAd=!0;var i=!1;t.visi3D.alphaAd&&1==t.visi3D.alphaAd&&(i=!0),this.visi3D=new st.a(this.div,null,!1,!0,!1,!0,i),this.visi3D.width=this.visi3D.height=200,this.visi3D.groupObject.add(this.content3d),this.sceneSB=new rt(this.visi3D);for(e=0;e<this.sceneSB.array.length;e++)void 0===t[this.sceneSB.array[e].name]&&(t[this.sceneSB.array[e].name]={}),this.sceneSB.array[e].setBasa(t[this.sceneSB.array[e].name]);this.pm=new Qt(this.visi3D,this.par.objectBase,this.param),this.fotoDrag=new ie(function(){}),this.sMaterial=new ee(this),this.visi3D.upDate(),null!=this.pmObjStr&&n.setObjMaterial(n.pmObjStr),n.visi3D.setObj(JSON.parse('{"xVerh":0,"yVerh":-100,"zVerh":-5,"rotationX":1.08,"rotationZ":0.41999999999999993,"zume":305.4964599609375}'))},this.pmObjStr,this.objMaterial,this.setObjMaterial=function(t){if(this.objMaterial=t,null!=this.pm){var e=this.pm.matDop.getIDObj(t.id);this.material=e,null!=this.colorTHREE&&(this.material.color=this.colorTHREE),this.visi3D.intRend=1}else this.pmObjStr=t};var s=0;this.update=function(){this.visi3D&&(this.visi3D.upDate(),++s>25&&(this.visi3D.intRend=1))},this.setIndex=function(t,e,i){"newGeom"===t&&(this.sMaterial.index=e,this.update(),this.visi3D.intRend=1),"newFoto"==t&&this.fotoScene()},this.fotoScene=function(t){},this.getFoto=function(t){var e=n.visi3D.utility.debug;n.visi3D.utility.debug=!1;n.visi3D.utility.sky.active;n.visi3D.utility.sky.active=!1,n.visi3D.render();var s=n.visi3D.renderer.domElement.toDataURL("image/png");n.visi3D.utility.debug=e,function(t,e,i,n,s,a){var r=new Image;r.onload=function(){var t=document.createElement("canvas");if(null==a){if(null!=i&&i>r.naturalWidth)return void e(null);t.width=null==i?r.naturalWidth:i,t.height=null==n?r.naturalHeight:n}else{var o=r.naturalWidth/a;o<r.naturalHeight/a&&(o=r.naturalHeight/a),t.width=Math.round(r.naturalWidth/o),t.height=Math.round(r.naturalHeight/o)}var h=t.getContext("2d");h.drawImage(r,0,0,t.width,t.height),h.canvas.toBlob(function(t){var i=new File([t],null==s?"icon.png":s);e(i)},"image/png")},r.src=t}(s,function(t){i("saveIcon",t)},200,200)},mhbd.getKeyList("scenes3d",function(t){mhbd.getKeyList("objects3d",function(t){mhbd.getKeyList("materials",function(t){mhbd.getKeyList("textures",function(t){n.init()})})})}),this.colorTHREE=void 0,this.dCont=new DCont,this.dCont.div.appendChild(this.div)}return $t(t,[{key:"material",set:function(t){this._material.uuid!=t.uuid&&(this._material=t,this.sMaterial.material=t)},get:function(){return this._material}},{key:"color",set:function(t){if(this._color=t,"null"==t)this.colorTHREE=void 0;else{var e=new THREE.Color(this._color);this.colorTHREE=e,this._material.color=e}},get:function(){return this._color}},{key:"d3Width",set:function(t){this._d3Width!=t&&(this._d3Width=t,this.sMaterial&&(this.sMaterial.d3Width=t))},get:function(){return this._d3Width}},{key:"d3Height",set:function(t){this._d3Height!=t&&(this._d3Height=t,this.sMaterial&&(this.sMaterial.d3Height=t))},get:function(){return this._d3Height}}]),t}(),ee=function(){function t(e){qt(this,t);this.par=e,this.type="SHelp",this._material=e._material,this._d3Height=e._d3Height,this._d3Width=e._d3Width,this.visi3D=this.par.visi3D,this.object=void 0,this._index=-1,this.array=[new THREE.BoxBufferGeometry(100,100,100,10,10,10),new THREE.BoxBufferGeometry(100,100,100,10,10,10),new THREE.BoxBufferGeometry(100,100,10,10,10,10),new THREE.SphereGeometry(50,32,32)],this.arrayCamPosition=['{"xVerh":0,"yVerh":0,"zVerh":0,"rotationX":1.58,"rotationZ":-2.7755575615628914e-17,"zume":160.4410124353063}','{"xVerh":-8.560203258641955,"yVerh":8.194841353140395,"zVerh":10.676623670953054,"rotationX":1.08,"rotationZ":-0.32,"zume":198.00113192657497}','{"xVerh":-8.778429900020296,"yVerh":-1.3287379643309913,"zVerh":1.067487023421211,"rotationX":1.14,"rotationZ":0.4800000000000001,"zume":147.3343034960613}','{"xVerh":0,"yVerh":0,"zVerh":0,"rotationX":1.58,"rotationZ":-2.7755575615628914e-17,"zume":160.4410124353063}'],this.meshs=[],this.content3d=new THREE.Object3D,this.par.content3d.add(this.content3d),this.meshs[0]=new THREE.Mesh(new THREE.SphereGeometry(100,32,32),this._material),this.meshs[0].position.z=-100,this.meshs[0].rotation.x=Math.PI/2,this.gg=new Kt,this.meshs[1]=new THREE.Mesh(this.gg,this._material),this.gg.textureWidth=this._d3Width,this.gg.textureHeight=this._d3Height,this.gg.rect.width=200,this.gg.rect.height=200,this.gg.depth=10,this.meshs[1].rotation.x=Math.PI/2,this.meshs[1].position.x=-100,this.meshs[1].position.z=-200;this.meshs[2]=new THREE.Mesh(new THREE.BoxBufferGeometry(140,140,140,10,10,10),this._material),this.meshs[2].position.z=-100,this.meshs[2].rotation.x=Math.PI/2;for(var i=0;i<this.meshs.length;i++)this.content3d.add(this.meshs[i]),this.meshs[i].castShadow=!0,this.meshs[i].receiveShadow=!0;this.openMat=function(t){for(var e=0;e<this.meshs.length;e++)this.meshs[e].material=t},this.index=1}return $t(t,[{key:"index",set:function(t){if(this._index!=t){this._index=t;for(var e=0;e<this.meshs.length;e++)e==this._index?this.meshs[e].visible=!0:this.meshs[e].visible=!1}},get:function(){return this._index}},{key:"material",set:function(t){this._material.uuid!=t.uuid&&(this._material=t,this.openMat(this._material))},get:function(){return this._material}},{key:"d3Width",set:function(t){this._d3Width!=t&&(this._d3Width=t,this.gg.textureWidth=this._d3Width)},get:function(){return this._d3Width}},{key:"d3Height",set:function(t){this._d3Height!=t&&(this._d3Height=t,this.gg.textureHeight=this._d3Height)},get:function(){return this._d3Height}}]),t}();function ie(t){var e=this;this.type="FotoDrag",this.fun=t,this.width=256,this.height=256;var i,n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image,r=new Image;a.onload=function(){n.width=a.width,n.height=a.height,s.clearRect(0,0,n.width,n.height),s.drawImage(a,0,0),s.filter=null;for(var t=s.getImageData(0,0,n.width,n.height),o=t.data,h=0;h<o.length;h+=4)o[h]=1,o[h+1]=1,o[h+2]=1;s.filter="blur(5px)",s.putImageData(t,0,0),i=!0,0==e.bool&&(i=!1),r.src=n.toDataURL("image/png")},r.onload=function(){if(1==i)return s.clearRect(0,0,r.width,r.height),s.filter="blur(5px)",s.drawImage(r,0,0,r.width,r.height),i=!1,void(r.src=n.toDataURL("image/png"))},this.bool=!1,this.setLink=function(t,i,n){this.bool=!1,i&&(this.bool=i),a.src=t,e.fun=n},this.na=function(t,i){return n.width=t,n.height=t,s.clearRect(0,0,t,t),e.bool&&s.drawImage(r,0,0,t,t),s.drawImage(a,0,0,t,t),n.toDataURL("image/png")}}function ne(t){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function se(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ae(t,e,i){return e&&se(t.prototype,e),i&&se(t,i),t}function re(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oe(t,e){return!e||"object"!==ne(e)&&"function"!=typeof e?ce(t):e}function he(t){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function le(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}function ue(t,e){return(ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var de=function(t){function e(t,i){var n;re(this,e),(n=oe(this,he(e).call(this,t,i))).type="MCOProduct",n.param=n.par.param;var s=ce(ce(n));return n.postInit=function(){null==this.panel&&(this.panel=new DPanel(this.dCont1,0,this.otstup),this.label=new DLabel(this.panel.content,this.otstup,this.otstup,"null"),this.label.bold=!0,this.label.fontSize=12,this.array[0]=this.hronCase1=new fe(this,function(t,e){}),this.array[1]=this.hronCase2=new me(this,function(t,e){}),this.array[2]=this.hronCase4=new ge(this,function(t,e){"sizeW"==t&&s.sizeW()}),this.array[3]=this.hronCase5=new be(this,function(t,e){"sizeW"==t&&s.sizeW()}),this.array[4]=this.hronCase6=new ve(this,function(t,e){}),this.sizeWindow(),this.update())},n.update=function(){1==s._active&&s.hronCase4.update(),requestAnimationFrame(s.update)},n.postSW=function(){for(var t=0,e=0;e<this.array.length;e++)t=this.array[e].width>t?this.array[e].width:t;for(e=0;e<this.array.length;e++)this.array[e].width=t},n}return le(e,V),e}(),pe=function(){function t(e,i){re(this,t);var n=this;this.type="HronCase",this.par=e,this.fun=i,this.param=this.par.param,this.otstup=this.param.otstup,this.otstupLabel=15,this.contentFontSize=10,this._active=!1,this.dCont=new DCont(e.dCont),this.dCont.visible=this._active,this._width=this.param.whCr+10,this._height=100,this.heightStart=0,this.numInput=5,this.okrugInput=10,this.label=new DLabel(this.dCont,this.otstup,this.otstup,"null"),this.label.bold=!0,this.label.fontSize=12,this.panel=new DPanel(this.dCont,this.otstup,this.otstup+this.label.fontSize+2),this.funPostSO,this.object,this.key,this.id,this.startObj=function(t,e){this.object=t,this.key=e,this.id=t.id,this.funPostSO&&this.funPostSO()},this.drag=function(){"DInput"!=this.type&&"DColor"!=this.type||mhbd.setParam(n.key,n.object.id,this.linkParam,this.value),"DButton"==this.type&&"icon"==this.linkParam&&n.saveFile(this.files[0],this),"DComboBox"==this.type&&mhbd.setParam(n.key,n.id,this.linkParam,this.userData[this.index].id)},this.sizeW=function(){this.label.width=this.width,this.panel.width=this.width,this.panel.height=this._height-(this.label.fontSize+this.otstup+2)},this.height=this.label.fontSize+this.otstup,this.heightStart=this.label.fontSize+this.otstup}return ae(t,[{key:"width",set:function(t){this._width!=t&&(this._width=t,this.sizeW())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.sizeW())},get:function(){return this._height}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active)},get:function(){return this._active}}]),t}(),fe=function(t){function e(t,i){var n;re(this,e);var s=ce(ce(n=oe(this,he(e).call(this,t,i))));n.type="HronCase1",n.par=t,n.label.text="Общая информация",n.saveFile=function(t,e){var i={type:"GET",url:this.param.server+this.key+"/"+this.object.id+"/",success:function(i){mhbd.setFile(t,s.object,s.key,"icon",function(t){e.link=t})},error:function(t){console.error("не верная загрузка textur")}};i.headers={Authorization:"Token "+mhbd.token},$.ajax(i)},n.drag=function(){mhbd.setParam(s.key,s.object.id,this.linkParam,this.value)};var a=n.otstup,r=n.otstup;return n.label1=new DLabel(n.panel.content,a,r,"icon"),n.label1.fontSize=n.contentFontSize,n.label1.bold=!0,n.button=new DButton(n.panel.content,a,r+n.otstupLabel,null,function(){s.saveFile(this.files[0],this)}),n.button.height=n.button.width=50,n.button.startFile(),n.labLink=new DLabel(n.panel.content,a+55,r+n.otstupLabel+38),n.labLink.width=355,n.labLink.fontSize=4,a+=n.button.width+n.otstup,n.label2=new DLabel(n.panel.content,a,r,"name"),n.label2.fontSize=n.contentFontSize,n.label2.bold=!0,n.input=new DInput(n.panel.content,a,r+n.otstupLabel,null,function(){s.object.name=this.value,mhbd.setParam(s.key,s.object.id,"name",this.value)}),n.input.width=4*n.param.wb,n.input.timeFun=1,n.input.okrug=n.okrugInput,a+=n.input.width+n.otstup,n.but=new DButton(n.panel.content,a,r+n.otstupLabel,null,function(){s.creatObj()}),n.but.width=85,r+=n.otstup+n.button.height+n.otstupLabel,n.height+=r,n.creatObj=function(t){var e={url:this.param.server+this.key+"/",type:"POST",data:{d3Depth:this.object.d3Depth,d3Height:this.object.d3Height,d3MatColor:this.object.d3MatColor,d3MatId:this.object.d3MatId,d3Width:this.object.d3Width,depth:this.object.depth,files:this.object.files,group:this.object.group,heat:this.object.heat,height:this.object.height,icon:"resources/image/notpic1.png",iconId:null,name:this.object.name,otstup:this.object.otstup,pack:this.object.pack,price:this.object.price,sortsObj:this.object.sortsObj,typePrice:this.object.typePrice,weight:this.object.weight,width:this.object.width,xPrice:this.object.xPrice},success:function(t){s.par.startObj(t,s.key)},error:function(t){console.error("не верная загрузка xУУУУУz")}};e.headers={Authorization:"Token "+mhbd.token},$.ajax(e)},n.funPostSO=function(){this.button.link="edrtgretert",this.button.link=this.object.icon,this.labLink.text=this.object.icon,this.input.value=this.object.name},n}return le(e,pe),e}(),me=function(t){function e(t,i){var n;re(this,e);var s=ce(ce(n=oe(this,he(e).call(this,t,i))));n.type="HronCase2",n.par=t,n.label.text="Стоимость",n.drag=function(){mhbd.setParam(s.key,s.object.id,this.linkParam,this.value)};var a=n.otstup,r=n.otstup;return n.label1=new DLabel(n.panel.content,a,r,"price"),n.label1.fontSize=n.contentFontSize,n.label1.bold=!0,n.input=new DInput(n.panel.content,a,r+n.otstupLabel,null,function(){1==isNaN(this.value)||this.value<0?this.value=s.object.price:(s.object.price=this.value,mhbd.setParam(s.key,s.object.id,"price",this.value))}),n.input.width=n.param.wb/2,n.input.timeFun=1,n.input.setNum(n.numInput),n.input.okrug=n.okrugInput,a+=n.input.width+n.otstup,n.label3=new DLabel(n.panel.content,a,r,"размер X"),n.label3.fontSize=n.contentFontSize,n.label3.bold=!0,n.input1=new DInput(n.panel.content,a,r+n.otstupLabel,null,function(){1==isNaN(this.value)||this.value<.001?this.value=s.object.width:(s.object.width=this.value,mhbd.setParam(s.key,s.object.id,"width",this.value),s.xzxz())}),n.input1.width=n.param.wb/2,n.input1.timeFun=1,n.input1.setNum(n.numInput),n.input1.okrug=n.okrugInput,a+=n.input1.width+n.otstup,n.label4=new DLabel(n.panel.content,a,r,"height"),n.label4.fontSize=n.contentFontSize,n.label4.bold=!0,n.input2=new DInput(n.panel.content,a,r+n.otstupLabel,null,function(){1==isNaN(this.value)||this.value<0?this.value=s.object.height:(s.object.height=this.value,mhbd.setParam(s.key,s.object.id,"height",this.value),s.xzxz())}),n.input2.width=n.param.wb/2,n.input2.timeFun=1,n.input2.setNum(n.numInput),n.input2.okrug=n.okrugInput,n.label12=new DLabel(n.panel.content,a-n.input2.width+6,r+n.otstupLabel+n.input2.height+5,"площ. (см²)"),n.label12.fontSize=n.contentFontSize,n.label12.bold=!0,n.input12=new DInput(n.panel.content,a-n.input2.width/2+30,r+n.otstupLabel+n.input2.height+5,null,function(){1==isNaN(this.value)||this.value<0?s.xzxz():s.xzxz(!0)}),n.input12.width=n.param.wb/2,n.input12.height=n.input2.height/2,n.input12.setNum(n.numInput),a+=n.input2.width+n.otstup,n.label5=new DLabel(n.panel.content,a,r,"depth"),n.label5.fontSize=n.contentFontSize,n.label5.bold=!0,n.input3=new DInput(n.panel.content,a,r+n.otstupLabel,null,function(){1==isNaN(this.value)||this.value<0?this.value=s.object.depth:(s.object.depth=this.value,mhbd.setParam(s.key,s.object.id,"depth",this.value))}),n.input3.width=n.param.wb/2,n.input3.timeFun=1,n.input3.setNum(n.numInput),n.input3.okrug=n.okrugInput,a+=n.input3.width+n.otstup,n.label6=new DLabel(n.panel.content,a,r,"weight"),n.label6.fontSize=n.contentFontSize,n.label6.bold=!0,n.input4=new DInput(n.panel.content,a,r+n.otstupLabel,null,function(){1==isNaN(this.value)||this.value<0?this.value=s.object.weight:(s.object.weight=this.value,mhbd.setParam(s.key,s.object.id,"weight",this.value))}),n.input4.width=n.param.wb/2,n.input4.timeFun=1,n.input4.setNum(n.numInput),n.input4.okrug=n.okrugInput,a+=n.input4.width+n.otstup,n.label7=new DLabel(n.panel.content,a,r,"heat"),n.label7.fontSize=n.contentFontSize,n.label7.bold=!0,n.input5=new DInput(n.panel.content,a,r+n.otstupLabel,null,function(){1==isNaN(this.value)||this.value<0?this.value=s.object.heat:(s.object.heat=this.value,mhbd.setParam(s.key,s.object.id,"heat",this.value))}),n.input5.width=n.param.wb/2,n.input5.timeFun=1,n.input5.setNum(n.numInput),n.input5.okrug=n.okrugInput,a+=n.input5.width+n.otstup,n.label8=new DLabel(n.panel.content,a,r,"pack"),n.label8.fontSize=n.contentFontSize,n.label8.bold=!0,n.input6=new DInput(n.panel.content,a,r+n.otstupLabel,null,function(){1==isNaN(this.value)||this.value<0?this.value=s.object.pack:(s.object.pack=this.value,mhbd.setParam(s.key,s.object.id,"pack",this.value))}),n.input6.width=n.param.wb/2,n.input6.timeFun=1,n.input6.setNum(n.numInput),n.input6.okrug=n.okrugInput,a+=n.input6.width+n.otstup,n.label11=new DLabel(n.panel.content,a,r,"sort Group 0"),n.label11.fontSize=n.contentFontSize,n.label11.bold=!0,n.comboBox11=new DComboBox(n.panel.content,a,r+n.otstupLabel,null,function(){s.object.group=this.userData[this.index].id,mhbd.setParam(s.key,s.id,"group",this.userData[this.index].id)}),n.comboBox11.width=n.param.wb+20+15,r+=n.otstup+n.input4.height+n.otstupLabel,n.height+=r,n.xzxz=function(t){if(1==t){if(1!=isNaN(s.input12.value)){s.input2.value,s.input1.value;var e=s.input1.value/(s.input1.value+s.input2.value),i=s.input2.value/(s.input1.value+s.input2.value);trace(e,i);var n=s.input12.value*e,a=s.input12.value*i;s.input1.value=Math.round(10*n)/10,s.input2.value=Math.round(10*a)/10}}else{var r=s.input2.value*s.input1.value,o=Math.round(10*r)/10;s.input12.value=o+""}},n.funPostSO=function(){if(this.input.value=this.object.price||0,this.input1.value=this.object.width||0,this.input2.value=this.object.height||0,this.input3.value=this.object.depth||0,this.input4.value=this.object.weight||0,this.input5.value=this.object.heat||0,this.input6.value=this.object.pack||0,this.xzxz(),null!=this.comboBox11.userData){for(var t=this.object.group||0,e=!1,i=0;i<this.comboBox11.userData.length;i++)this.comboBox11.userData[i].id==t&&(this.comboBox11.index=i,e=!0);0==e&&(this.comboBox11.index=-1)}},mhbd.getKeyList("group",function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].id+": "+t[i].name);s.comboBox11.array=e,s.comboBox11.userData=t}),n}return le(e,pe),e}(),ge=function(t){function e(t,i){var n;re(this,e);var s=ce(ce(n=oe(this,he(e).call(this,t,i))));n.type="HronCase4",n.par=t,n.label.text="3D Материал";var a=n.otstup,r=n.otstup;n._actMatId=-1,n._hh=42,n._hh1=500,n.checkBox=new DCheckBox(n.panel.content,a,r,"d3Material",function(){0==this.value?(s.actMatId=-1,mhbd.setParam(s.key,s.id,"d3MatId",s._actMatId),s.comboBox.index=0):(s.actMatId=s.gal.array[0].id,mhbd.setParam(s.key,s.id,"d3MatId",s._actMatId),s.funPostSO()),s.fun("sizeW")}),a+=205,n.comboBox=new DComboBox(n.panel.content,a,r,[],function(){this.index>-1?(s.gal.sahpos=0,s.gal.keshSort="sort",s.gal.keshParam=this.userData[this.index].id,s.gal.boolSort=!0,s.gal.sortList()):(s.gal.sahpos=0,s.gal.keshSort="null",s.gal.keshParam="null",s.gal.sortList())}),n.comboBox.width=220,a=n.otstup,r+=n.comboBox.height+n.otstup,n.hh=r,n.dContMat=new DCont(n.panel.content),n.dContMat.x=a,n.dContMat.y=r,n.checkBox.value=!1,n.dContMat.visible=!1,n.height+=n.hh;var o=n.otstup;a=0,n._index=-1,n.mcVuevPanel=new DPanel(n.dContMat,a,o),n.mcVuevPanel.width=200+2*n.otstup;var h=n.otstup;n.buttonFoto=new DButton(n.mcVuevPanel,h,n.otstup,"",function(){s.mcVuev&&s.mcVuev.getFoto(function(t){})}),n.buttonFoto.width=n.buttonFoto.height=n.param.whb,h+=n.buttonFoto.width+n.otstup,n.mcVuev=new te(ce(ce(n)),function(t,e,i){"saveIcon"==t&&mhbd.setFile(e,s.object,s.key,"icon",function(t){s.par.hronCase1.startObj(s.object,s.key)})}),n.mcVuevPanel.add(n.mcVuev.dCont),n.mcVuev.dCont.x=a+n.otstup,n.mcVuev.dCont.y=o,n.mcVuev.dCont.div.blaGrabla=1,a+=200+3*n.otstup,n.gal=new et(ce(ce(n)),n.dContMat,function(t,e,i){"retJson"===t&&(s.object.d3MatId=e,mhbd.setParam(s.key,s.id,"d3MatId",e)),s.mcVuev.setObjMaterial(i),s.mcVuev.color=s.object.d3MatColor},"materials"),n.gal.xzBool=!0,n.gal.active=!0,n.gal.dCont.x=a,n.gal.dCont.y=o,n.mcVuevPanel.height=n.gal.height-2*n.otstup,n.mcVuev.dCont.y=n.mcVuevPanel.height-(200+n.otstup);n.otstup;h=n.mcVuevPanel.width-(4*(9+n.otstup)+n.otstup);a=60;n.buttonVert=new DButton(n.mcVuevPanel,a,n.otstup,"",function(){1==this.alpha?(s.mcVuev.visi3D.utility.focus.targetObject=s.mcVuev.content3d,s.mcVuev.visi3D.utility.focus.active=!0,this.alpha=.5):(s.mcVuev.visi3D.utility.focus.active=!1,this.alpha=1)}),n.buttonVert.width=n.buttonVert.height=n.param.whb,n.buttonVert1=new DButton(n.mcVuevPanel,a+n.param.whb+n.otstup,n.otstup,"",function(){1==this.alpha?(s.mcVuev.visi3D.fov=5,this.alpha=.5):(s.mcVuev.visi3D.fov=45,this.alpha=1)}),n.buttonVert1.width=n.buttonVert1.height=n.param.whb,n.buttonVert2=new DButton(n.mcVuevPanel,a+2*(n.param.whb+n.otstup),n.otstup,"1",function(){s.mcVuev.visi3D.setObj(JSON.parse('{"xVerh":0,"yVerh":-100,"zVerh":-5,"rotationX":1.57,"rotationZ":0,"zume":250}'))}),n.buttonVert2.width=n.buttonVert2.height=n.param.whb/2,n.buttonVert2=new DButton(n.mcVuevPanel,a+2*(n.param.whb+n.otstup)+n.param.whb/2,n.otstup,"2",function(){s.mcVuev.visi3D.setObj(JSON.parse('{"xVerh":0,"yVerh":-100,"zVerh":-5,"rotationX":1.08,"rotationZ":0.41999999999999993,"zume":305.4964599609375}'))}),n.buttonVert2.width=n.buttonVert2.height=n.param.whb/2,n.ab=[];for(var l=0;l<3;l++)n.ab[l]=new DButton(n.mcVuevPanel,a+3*(n.param.whb+n.otstup)+n.param.whb/2,n.otstup+(n.otstup+n.param.whb/2)*l,"",function(){s.index=this.idArr}),n.ab[l].width=n.ab[l].height=n.param.whb/2,n.ab[l].idArr=l;return mhbd.getKeyId("group1",151,function(t){s.ab[2].link=t.icon}),mhbd.getKeyId("group1",152,function(t){s.ab[1].link=t.icon}),mhbd.getKeyId("group1",35,function(t){s.ab[0].link=t.icon}),mhbd.getKeyId("group1",34,function(t){s.buttonVert1.link=t.icon}),mhbd.getKeyId("group1",33,function(t){s.buttonVert.link=t.icon}),mhbd.getKeyId("group1",32,function(t){s.buttonFoto.link=t.icon}),n.sobDragMCVuev=function(){s.mcVuev&&this.idArr<4&&s.mcVuev.setIndex("newGeom",this.idArr)},o+=n.gal.height-n.otstup,a=n.otstup,n.width=n.gal.width+200+3*n.otstup+2*n.otstup+15,n.label1=new DLabel(n.dContMat,a,o,"d3Width"),n.label1.fontSize=n.contentFontSize,n.label1.bold=!0,n.input1=new DInput(n.dContMat,a,o+n.otstupLabel,null,function(t,e,i){s.object.d3Width=this.value,mhbd.setParam(s.key,s.id,"d3Width",this.value),s.mcVuev.d3Width=this.value}),n.input1.width=n.param.wb/2,n.input1.timeFun=1,n.input1.setNum(n.numInput),n.input1.okrug=n.okrugInput,a+=n.input1.width+n.otstup,n.label2=new DLabel(n.dContMat,a,o,"d3Height"),n.label2.fontSize=n.contentFontSize,n.label2.bold=!0,n.input2=new DInput(n.dContMat,a,o+n.otstupLabel,null,function(t,e,i){s.object.d3Height=this.value,mhbd.setParam(s.key,s.id,"d3Height",this.value),s.mcVuev.d3Height=this.value}),n.input2.width=n.param.wb/2,n.input2.timeFun=1,n.input2.setNum(n.numInput),n.input2.okrug=n.okrugInput,a+=n.input2.width+n.otstup,n.label3=new DLabel(n.dContMat,a,o,"d3Depth"),n.label3.fontSize=n.contentFontSize,n.label3.bold=!0,n.input3=new DInput(n.dContMat,a,o+n.otstupLabel,null,function(t,e,i){s.object.d3Depth=this.value,mhbd.setParam(s.key,s.id,"d3Depth",this.value)}),n.input3.width=n.param.wb/2,n.input3.timeFun=1,n.input3.setNum(n.numInput),n.input3.okrug=n.okrugInput,a+=n.input2.width+n.otstup,n.buttBal=new DButton(n.dContMat,a,o+n.otstupLabel,"",function(){mhbd.getKeyId("materials",s.object.d3MatId,function(t){var e=t.json.title.split("_");if(e[1]){var i=1*e[0]*s.object.width;s.object.d3Width=i,mhbd.setParam(s.key,s.id,"d3Width",i),s.input1.value=i,s.mcVuev.d3Width=i;var n=1*e[1]*s.object.height;s.object.d3Height=n,mhbd.setParam(s.key,s.id,"d3Height",n),s.input2.value=n,s.mcVuev.d3Height=n}})}),n.buttBal.width=n.buttBal.height,mhbd.getKeyId("group1",36,function(t){s.buttBal.link=t.icon}),a=n.otstup,o+=n.input1.height+n.otstupLabel+2*n.otstup,n.label4=new DLabel(n.dContMat,a,o,"d3MatColor"),n.label4.fontSize=n.contentFontSize,n.label4.bold=!0,n.color=new DColor(n.dContMat,a,o+n.otstupLabel,"#000000",function(t,e,i){s.object.d3MatColor=this.value,mhbd.setParam(s.key,s.id,"d3MatColor",this.value),s.mcVuev.color=this.value}),n.color.width=150,o+=n.color.height+n.otstupLabel+n.otstup,n.dContMat.height=o,n.hh1=r+n.dContMat.height+n.otstup,n.update=function(){1==this.checkBox.value&&this.mcVuev.update()},n.funPostSO=function(){this.input1.value=this.object.d3Width||100,this.input2.value=this.object.d3Height||100,this.input3.value=this.object.d3Depth||100,this.color.value=this.object.d3MatColor||null,s.mcVuev.color=this.object.d3MatColor,s.mcVuev.d3Height=this.object.d3Height,s.mcVuev.d3Width=this.object.d3Width,s.actMatId=this.object.d3MatId||1,s.gal.objID=this.object.d3MatId||1},mhbd.getKeyList("materials/sorts",function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].name);if(s.comboBox.array=e,s.comboBox.userData=t,null!=s.comboBox.userData){var n=s.object.d3MatId||1;mhbd.getKeyId("materials",n,function(t){for(var e=0;e<s.comboBox.userData.length;e++)s.comboBox.userData[e].id==t.sort&&(s.comboBox.index=e);s.comboBox.fun()})}s.funPostSO()}),n.index=0,n}return le(e,pe),ae(e,[{key:"index",set:function(t){if(this._index!=t){this._index=t,this.mcVuev.sMaterial&&(this.mcVuev.sMaterial.index=t);for(var e=0;e<this.ab.length;e++)this.ab[e].alpha=e==t?.5:1}},get:function(){return this._index}},{key:"hh",set:function(t){this._hh!=t&&(this._hh=t)},get:function(){return this._hh}},{key:"hh1",set:function(t){this._hh1!=t&&(this._hh1=t)},get:function(){return this._hh1}},{key:"actMatId",set:function(t){this._actMatId!=t&&(this._actMatId=t,-1==this._actMatId?(this.checkBox.value=!1,this.dContMat.visible=!1,this.height=this.heightStart+this.hh):(this.checkBox.value=!0,this.dContMat.visible=!0,this.height=this.heightStart+this.hh1))},get:function(){return this._actMatId}}]),e}(),be=function(t){function e(t,i){var n;re(this,e);var s=ce(ce(n=oe(this,he(e).call(this,t,i))));n.type="HronCase5",n.label.text="3D Объект";var a=n.otstup,r=n.otstup;n._actMatId=-1,n._hh=42,n._hh1=500,n.checkBox=new DCheckBox(n.panel.content,a,r,"d3Objects",function(){0==this.value?(s.actMatId=-1,s.object.obj3d=s._actMatId,mhbd.setParam(s.key,s.id,"obj3d",s._actMatId),s.comboBox.index=0):(s.actMatId=s.gal.array[0].id,s.object.obj3d=s._actMatId,mhbd.setParam(s.key,s.id,"obj3d",s._actMatId),s.funPostSO()),s.fun("sizeW")}),a+=205,n.comboBox=new DComboBox(n.panel.content,a,r,[],function(){this.index>0?(s.gal.sahpos=0,s.gal.keshSort="sort",s.gal.keshParam=this.userData[this.index].id,s.gal.boolSort=!0):(s.gal.sahpos=0,s.gal.keshSort="null",s.gal.keshParam="null")}),n.comboBox.width=220,a=n.otstup,r+=n.comboBox.height+n.otstup,n.hh=r,n.dContMat=new DCont(n.panel.content),n.dContMat.x=a,n.dContMat.y=r,n.checkBox.value=!1,n.dContMat.visible=!1,n.height+=n.hh;var o=n.otstup;return a=0,n.gal=new et(ce(ce(n)),n.dContMat,function(t,e,i){"retJson"===t&&mhbd.setParam(s.key,s.id,"obj3d",e)},"objects3d"),n.gal.active=!0,n.gal.dCont.x=a+215,n.gal.dCont.y=o,o+=n.gal.height-n.otstup,a=n.otstup,n.width=n.gal.width+3*n.otstup,n.dContMat.height=o,n.hh1=r+n.dContMat.height+n.otstup,n.funPostSO=function(){this.gal.objID=this.object.obj3d||1},mhbd.getKeyList("objects3d/sorts",function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].name);if(s.comboBox.array=e,s.comboBox.userData=t,null!=s.comboBox.userData){var n=s.object.obj3d||1;mhbd.getKeyId("objects3d",n,function(t){for(var e=0;e<s.comboBox.userData.length;e++)s.comboBox.userData[e].id==t.sort&&(s.comboBox.index=e);s.comboBox.fun()})}s.funPostSO()}),n}return le(e,pe),ae(e,[{key:"hh",set:function(t){this._hh!=t&&(this._hh=t)},get:function(){return this._hh}},{key:"hh1",set:function(t){this._hh1!=t&&(this._hh1=t)},get:function(){return this._hh1}},{key:"actMatId",set:function(t){this._actMatId!=t&&(this._actMatId=t,-1==this._actMatId?(this.checkBox.value=!1,this.dContMat.visible=!1,this.height=this.heightStart+this.hh):(this.checkBox.value=!0,this.dContMat.visible=!0,this.height=this.heightStart+this.hh1))},get:function(){return this._actMatId}}]),e}(),ve=function(t){function e(t,i){var n;re(this,e);var s=ce(ce(n=oe(this,he(e).call(this,t,i))));n.type="HronCase6",n.label.text="Help";var a=n.otstup,r=n.otstup;return n.checkBox=new DCheckBox(n.panel.content,a,r,"helpBool",function(){s.object.helpBool=this.value,mhbd.setParam(s.key,s.id,"helpBool",this.value)}),r+=n.checkBox.height+n.otstup,n.textAr=new DTextArea(n.panel.content,a,r,null,function(){s.object.helpText=this.value,mhbd.setParam(s.key,s.id,"helpText",this.value)}),n.textAr.height=200,n.textAr.width=n.width-n.otstup,r+=n.textAr.height+n.otstup,n.delBut=new DButton(n.panel.content,a,r,"delete",function(){mhbd.deleteId(s.key,s.id,i),s.par.backToList()}),n.delBut.width=n.width-n.otstup,r+=n.delBut.height+n.otstup,n.height=r+4*n.otstup,n.funPostSO=function(){this.checkBox.value=this.object.helpBool||!1,this.textAr.value=this.object.helpText||""},n}return le(e,pe),e}();function ye(t){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _e(t,e){return!e||"object"!==ye(e)&&"function"!=typeof e?Pe(t):e}function we(t){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ae(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Te(t,e)}function Te(t,e){return(Te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ee=function(t){function e(t,i){var n;xe(this,e),(n=_e(this,we(e).call(this,t,i))).type="MCOPlane",n.param=n.par.param;var s=Pe(Pe(n));return n.postInit=function(){null==this.panel&&(this.panel=new DPanel(this.dCont1,0,this.otstup),this.label=new DLabel(this.panel.content,this.otstup,this.otstup,"null"),this.label.bold=!0,this.label.fontSize=12,this.array[0]=this.hronCase1=new Se(this,function(t,e){"ReSize"==t&&s.sizeW()}),this.sizeWindow())},n}return Ae(e,V),e}(),Se=function(t){function e(t,i){var n;xe(this,e);var s=Pe(Pe(n=_e(this,we(e).call(this,t,i))));n.type="HronCase1",n.par=t,n.label.text="",n.arrHere={},n.arrHere.id=!0,n.saveFile=function(t,e){var i={type:"GET",url:this.param.server+this.key+"/"+this.object.id+"/",success:function(i){mhbd.setFile(t,s.object,s.key,"icon",function(t){e.link=t})},error:function(t){console.error("не верная загрузка textur")}};i.headers={Authorization:"Token "+mhbd.token},$.ajax(i)};var a=n.otstup,r=n.otstup;n.label1=new DLabel(n.panel.content,a,r,"name"),n.label1.fontSize=n.contentFontSize,n.label1.bold=!0,n.input=new DInput(n.panel.content,a+n.otstupLabelXX,r,null,function(){s.object.name=this.value,mhbd.setParam(s.key,s.object.id,"name",this.value)}),n.input.width=100,n.input.timeFun=1,n.input.okrug=n.okrugInput,n.arrHere.name=!0,r+=n.input.height+n.otstup,n.label33=new DLabel(n.panel.content,a,r,"sort"),n.label33.fontSize=n.contentFontSize,n.label33.bold=!0,n.comboBox11=new DComboBox(n.panel.content,a+n.otstupLabelXX,r,[],function(){null!=s.object&&(s.object.sort=this.userData[this.index].id,mhbd.setParam(s.key,s.object.id,"sort",s.object.sort))}),n.comboBox11.width=200,n.comboBox11.timeFun=1,n.comboBox11.okrug=n.okrugInput,mhbd.getKeyList("group2/sorts",function(t){trace(" data ",t);for(var e=[],i=0;i<t.length;i++)e.push(t[i].name);if(s.comboBox11.array=e,s.comboBox11.userData=t,null!=s.object){var n=0;for(i=0;i<s.comboBox11.userData.length;i++)if(s.comboBox11.userData[i].id==s.object.sort){n=i;break}s.comboBox11.index=n}}),r+=n.input.height+n.otstup,n.label2=new DLabel(n.panel.content,a,r,"up"),n.label2.fontSize=n.contentFontSize,n.label2.bold=!0,n.checkBox=new DCheckBox(n.panel.content,a+n.otstupLabelXX,r,"up",function(){s.object.up=this.value,mhbd.setParam(s.key,s.id,"up",this.value)}),n.arrHere.up=!0,r+=n.checkBox.height+n.otstup,n.label3=new DLabel(n.panel.content,a,r,"icon"),n.label3.fontSize=n.contentFontSize,n.label3.bold=!0,n.button=new DButton(n.panel.content,a+n.otstupLabelXX,r,null,function(){s.saveFile(this.files[0],this)}),n.button.height=n.button.width=80,n.button.startFile(),n.arrHere.icon=!0,r+=n.button.height+n.otstup,n.label3=new DLabel(n.panel.content,a,r,"texts"),n.label3.fontSize=n.contentFontSize,n.label3.bold=!0,n.leng=new v(n.panel.content,a+n.otstupLabelXX,r,null,function(t){"ReSize"==t&&s.fun("ReSize"),s.object&&mhbd.setParam(s.key,s.object.id,"texts",JSON.stringify(this.value))}),n.leng.width=n.width-(n.otstupLabelXX+2*n.otstup),n.panel.content.add(n.leng),n.arrHere.texts=!0,r+=n.leng.height+n.otstup,n.label4=new DLabel(n.panel.content,a,r,"json"),n.label4.fontSize=n.contentFontSize,n.label4.bold=!0,n.input4=new DTextArea(n.panel.content,a+n.otstupLabelXX,r,null,function(){s.object.json=JSON.stringify(this.value),mhbd.setParam(s.key,s.object.id,"json",JSON.stringify(this.value))}),n.input4.width=n.width-(n.otstupLabelXX+2*n.otstup),n.input4.timeFun=1,n.input4.okrug=n.okrugInput,n.input4.height=2+6*n.contentFontSize,n.arrHere.json=!0,r+=n.input4.height+2*n.otstup,n.sizeW1=function(){this.input.width=this.width-(this.otstupLabelXX+5*this.otstup),this.leng.width=this.width-(this.otstupLabelXX+5*this.otstup),this.input4.width=this.width-(this.otstupLabelXX+5*this.otstup)};var o=0;return n.arrElements={},n.hronElements=function(t,e){if(null==this.arrElements[t]){var i=new DLabel(this.panel.content,a,r+o,t+"="+e);this.arrElements[t]=i}this.arrElements[t].text=t+"="+e,o+=30,this.height<r+o&&(this.height=r+o+2*this.otstup)},n.height=r,n.funPostSO=function(){for(var t in trace("funPostSO==0===",this.object),o=0,this.object)null==this.arrHere[t]&&this.hronElements(t,this.object[t]);if(null!=s.comboBox11.userData){for(var e=0,i=0;i<s.comboBox11.userData.length;i++)if(s.comboBox11.userData[i].id==s.object.sort){e=i;break}s.comboBox11.index=e}this.input.value=this.object.name,this.checkBox.value=this.object.up,this.button.link=this.object.icon,this.leng.value=this.object.texts,this.leng.redxz(),this.input4.value=JSON.stringify(this.object.json)},n}return Ae(e,U),e}();function Ce(t){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function je(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){return!e||"object"!==Ce(e)&&"function"!=typeof e?Oe(t):e}function ke(t){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Le(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fe(t,e)}function Fe(t,e){return(Fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Oe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Me=function(t){function e(t,i){var n;je(this,e),(n=De(this,ke(e).call(this,t,i))).type="MCOG5",n.param=n.par.param;var s=Oe(Oe(n));return n.postInit=function(){null==this.panel&&(this.panel=new DPanel(this.dCont1,0,this.otstup),this.array[0]=this.hronCase1=new Be(this,function(t,e){"ReSize"==t&&s.sizeW()}),this.sizeWindow())},n}return Le(e,V),e}(),Be=function(t){function e(t,i){var n;je(this,e);var s=Oe(Oe(n=De(this,ke(e).call(this,t,i))));n.type="HronCase1",n.par=t,n.label.text="",n.saveFile=function(t,e){var i={type:"GET",url:this.param.server+this.key+"/"+this.object.id+"/",success:function(i){mhbd.setFile(t,s.object,s.key,"icon",function(t){e.link=t})},error:function(t){console.error("не верная загрузка textur")}};i.headers={Authorization:"Token "+mhbd.token},$.ajax(i)};var a=n.otstup,r=n.otstup;return n.label1=new DLabel(n.panel.content,a,r,"name"),n.label1.fontSize=n.contentFontSize,n.label1.bold=!0,n.input=new DInput(n.panel.content,a+n.otstupLabelXX,r,null,function(){s.object.name=this.value,mhbd.setParam(s.key,s.object.id,"name",this.value)}),n.input.width=n.width-(n.otstupLabelXX+2*n.otstup),n.input.timeFun=1,n.input.okrug=n.okrugInput,r+=n.input.height+n.otstup,n.label3=new DLabel(n.panel.content,a,r,"icon"),n.label3.fontSize=n.contentFontSize,n.label3.bold=!0,n.button=new DButton(n.panel.content,a+n.otstupLabelXX,r,null,function(){s.saveFile(this.files[0],this)}),n.button.height=n.button.width=80,n.button.startFile(),r+=n.button.height+5*n.otstup,n.height=r,n.funPostSO=function(){this.input.value=this.object.name,this.button.link=this.object.icon},n}return Le(e,U),e}();var Ie=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=this;this.type="MCOPMCsvKorekt",this.fun=e;var n,s,a;this.testStr=function(t){var e=null;null==n&&(n="й|ц|у|к|е|н|г|ш|щ|з|х|ъ|ф|ы|в|а|п|р|о|л|д|ж|э|я|ч|с|м|и|т|ь|б|ю|Й|Ц|У|К|Е|Н|Г|Ш|Щ|З|Х|Ъ|Ф|Ы|В|А|П|Р|О|Л|Д|Ж|Э|Я|Ч|С|М|И|Т|Ь|Б|Ю".split("|"),s="Ð¹|Ñ|Ñ|Ðº|Ðµ|Ð½|Ð³|Ñ|Ñ|Ð·|Ñ|Ñ|Ñ|Ñ|Ð²|Ð°|Ð¿|Ñ|Ð¾|Ð»|Ð´|Ð¶|Ñ|Ñ|Ñ|Ñ|Ð¼|Ð¸|Ñ|Ñ|Ð±|Ñ|Ð|Ð¦|Ð£|Ð|Ð|Ð|Ð|Ð¨|Ð©|Ð|Ð¥|Ðª|Ð¤|Ð«|Ð|Ð|Ð|Ð |Ð|Ð|Ð|Ð|Ð­|Ð¯|Ð§|Ð¡|Ð|Ð|Ð¢|Ð¬|Ð|Ð®".split("|"));for(var i=0;i<s.length;i++)if(-1!=t.indexOf(s[i])){e="";break}return null!=e&&(e=this.testStr2(t)),e},this.testStr2=function(t){for(var e=t,i=0;i<s.length;i++)if(-1!=e.indexOf(s[i])){a=e.split(s[i]),e="";for(var r=0;r<a.length;r++)e+=0==r?a[r]:n[i]+a[r]}return e};var r,o,h,l="юбьтимсчяэждлорпавыфъхзщшгнекуцйЮБЬТИМСЧЯЭЖДЛОРПАВЫФЪХЗЩШГНЕКУЦЙ",u="þáüòèìñ÷ÿýæäëîðïàâûôúõçùøãíåêóöéÞÁÜÒÈÌÑ×ßÝÆÄËÎÐÏÀÂÛÔÚÕÇÙØÃÍÅÊÓÖÉ";this.bigZamena=function(t){var e=function(t){for(var e,i="",n=0;n<t.length;n++){e=t[n];for(var s=0;s<u.length;s++)u[s]==e&&(e=l[s]);i+=e}return i}(t);o=e.split("\n"),r=[];for(var i=0;i<o.length;i++){var n=o[i].split("\r")[0].split(";");Number.isInteger(1*n[0])&&""!=n[0]&&r.push(n)}for(i=r.length-1;i>=0;i--)if(8==r[i].length);else{this.arrError2.push(r[i]);var s="xz";r[i][0]&&(s=":"+r[i][0]+":"+r[i].length),this.arrError.push(s),r.splice(i,1)}h=0,this.zxczxcxzc(),trace(r)},this.arr=["ru","en"],this.zxczxcxzc=function(){this.zxPreload(),null!=r[h]?(trace(h,r[h]),mhbd.getKeyId(r[h][1],1*r[h][0],function(t){var e=t.texts;null==t.texts&&(e={});for(var n=0;n<i.arr.length;n++)null==e[i.arr[n]]&&(e[i.arr[n]]={}),r[h][6+n]&&(e[i.arr[n]]=r[h][6+n]);mhbd.setParam(r[h][1],1*r[h][0],"texts",JSON.stringify(e),function(){h++,i.zxczxcxzc()})})):0!=this.arrError.length&&console.error("==this.arrError=",this.arrError,this.arrError2)},this.panelProg=void 0,this.zxPreload=function(){if(null==r[h]){if(null!=this.panelProg)return this.panelProg.visible=!1,void(this.labelProg.visible=!1)}else null!=this.panelProg&&(this.panelProg.visible=!0,this.labelProg.visible=!0);null==this.panelProg&&(this.panelProg=new DPanel(mhbd.par.dCont),this.panelProg.width=this.panelProg.height=2e3,this.panelProg.alpha=.7,this.labelProg=new DLabel(this.panelProg,600,250),this.labelProg.fontSize=30,this.labelProg.bold=!0,this.labelProg.textAlign="center");for(var t="",e=0;e<this.arrError.length;e++)t+=" ________error"+this.arrError[e]+" ";this.labelProg.text="Прогресс обновления:  "+h+"/"+r.length+t,trace("===",this.arrError)},this.arrError=[],this.arrError2=[],this.korektText=function(t){var e=this.testStr(t);this.bigZamena(e)},this.startCsv=function(t){this.arrError.length=0,this.arrError2.length=0;var e=t.split("base64,"),i=window.atob(e[1]);this.korektText(i)},this.getCsvTextToArr=function(t,e){var i="";trace(e,t);for(var n=0;n<t.length;n++){var s=t[n].id+";"+e+";;;конструтор;",a="xz";t[n].name&&(a=t[n].name);var r=a,o="xz";t[n].texts&&(t[n].texts.ru&&(r=t[n].texts.ru),t[n].texts.en&&(o=t[n].texts.en)),i+=s+=a+";"+r+";"+o+"\n"}return i}};function Re(t){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ze(t){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function He(t,e){return(He=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ne(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ue(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function We(t,e,i){return e&&Ue(t.prototype,e),i&&Ue(t,i),t}var Ge=function(){function t(e,i){Xe(this,t);this.type="MCOProgMet",this.par=e,this.fun=i,this.param=this.par.param,this._active=!1,this.key="null";var n=this;this.postSW=void 0,this.postStart=void 0,this.width=700,this._width=700,this._height=500,this.dragNotEvent=dcmParam.dragNotEvent,this.otstup=this.param.otstup,this._active=!1,this._boolWheel=!1,this.sahDelta=50,this.dCont1=new DCont(e.dCont),this.dCont1.visible=this._active,this.panel=void 0,this.dContXZ=new DCont(e.dCont),this.scrollBarV=void 0,this.dCont=new DCont(this.dContXZ),this.dCont.visible=this._active,this.array=[],this.init=function(){null==this.panel&&(this.panel=new DPanel(this.dCont1,0,this.otstup),this.active=!0,this.array[0]=this.hronCase1=new Ye(this,function(t,e){}),this.scrollBarV=new DScrollBarV(this.dCont1,this.width-2*this.otstup,this.otstup,function(){n.scrolPos(!1)}),this.scrollBarV.offsetHit=3,this.boolWheel=!0,this.sizeWindow())};var s,a,r,o,h;this.dragActiv=!1,this.mouseDown=function(t){n.dragActiv=!0,void 0,1==n.dragNotEvent&&(document.body.style.pointerEvents="none")},this.mouseup=function(t){n.dragActiv=!1,void 0,1==n.dragNotEvent&&(document.body.style.pointerEvents=null)},this.scrolPos=function(t){1==t?n.scrollBarV.value=this.dCont.y/(this._height-n.scrollBarV.heightContent)*100:n.dCont.y=n.scrollBarV.value/100*(this._height-n.scrollBarV.heightContent),n.skrollRect(n.panel)},this.recurs=function(t){return s=null,null!=t.offsetParent&&(s=t.offsetParent),null!=t.parentElement&&(s=t.parentElement),null!=s&&(!!s.blaGrabla||this.recurs(s))},this.mousewheel=function(t){var e=!1;if(t.target&&(t.target.offsetParent||t.target.parentElement)&&(e=n.recurs(t.target)),1!=e){a=n.scrollBarV.heightContent-n._height;var i=-1,s=t.delta;null==t.wheelDelta&&(s=t.wheelDelta),t.delta&&t.delta<0&&(i=1),t.deltaY&&t.deltaY<0&&(i=1),t.detail&&t.detail<0&&(i=1),null!=t.wheelDelta&&(i=t.wheelDelta>0?-1:1),s=i,n.scrollBarV.visible&&(s<0?n.dCont.y>=0?n.dCont.y=0:n.dCont.y+=n.sahDelta:n.dCont.y<=-(a+n.otstup)?n.dCont.y=-(a+n.otstup):n.dCont.y-=n.sahDelta),n.scrolPos(!0),n.skrollRect(n.panel)}},this.skrollRect=function(t){this.dContXZ.div.style.clip="rect("+Math.round(2*this.otstup)+"px "+Math.round(this.width)+"px "+Math.round(this._height)+"px "+Math.round(this.otstup)+"px)"},this.sizeWindow=function(t,e,i){t&&(r=t,o=e,h=i),0!=this._active&&(this.height=o/h-(3*this.param.wh+2*this.otstup),0==dcmParam.mobile?this.width=this.param.whCr+20:this.width=r/h-65,this.panel.height=this.height,this.panel.width=this.width,this.scrollBarV.height=this._height,this.sizeW())},this.sizeW=function(){for(var t=this.otstup,e=0;e<this.array.length;e++)this.array[e].dCont.y=t,t+=this.array[e].height+this.otstup;for(e=0;e<this.array.length;e++)this.array[e].width=this.width-10;this.scrollBarV.x=this.width+2*this.otstup,this.heightContent=t,this.scrollBarV.heightContent=t,this.scrollBarV.height=this.panel.height,this.scrollBarV.width=this.otstup/2;this.scrollBarV.scrolValue=0,this.scrollBarV.value=0,this.dCont.y=0,this.scrollBarV.heightContent>this.scrollBarV.height?this.boolWheel=!0:this.boolWheel=!1,this.skrollRect(this.panel)},this.start=function(t,e,i){this.init(),this.active=!0;for(var n=0;n<this.array.length;n++)this.array[n].startObj();this.sizeWindow()},this.startObj=function(t,e){this.sizeW()},this.clear=function(){this.active=!1}}return We(t,[{key:"boolWheel",set:function(t){this._boolWheel!=t&&(this._boolWheel=t,this.interactive=this._boolWheel,1==this._boolWheel?(this.dCont.div.addEventListener("mousewheel",this.mousewheel),this.dCont.div.addEventListener("DOMMouseScroll",this.mousewheel)):(this.dCont.div.removeEventListener("mousewheel",this.mousewheel),this.dCont.div.removeEventListener("DOMMouseScroll",this.mousewheel),this.dCont.y=0),this.scrollBarV.visible=this._boolWheel)},get:function(){return this._boolWheel}},{key:"height",set:function(t){this._height!=t&&(this._height=t)},get:function(){return this._height}},{key:"wigth",set:function(t){this._wigth!=t&&(this._wigth=t)},get:function(){return this._wigth}},{key:"active",set:function(t){if(this._active!=t){this._active=t,this.init(),this.dCont.visible=t,this.dCont1.visible=t;for(var e=0;e<this.array.length;e++)this.array[e].active=t}},get:function(){return this._active}}]),t}(),Ve=function(){function t(e,i){Xe(this,t);this.type="HronCase",this.par=e,this.fun=i,this.param=this.par.param,this.otstup=this.param.otstup,this.otstupLabel=15,this.otstupLabelXX=80,this.contentFontSize=16,this._active=!1,this.dCont=new DCont(e.dCont),this.dCont.visible=this._active,this._width=this.param.whCr+10,this._height=100,this.heightStart=0,this.numInput=5,this.okrugInput=10,this.label=new DLabel(this.dCont,this.otstup,this.otstup,"null"),this.label.bold=!0,this.label.fontSize=12,this.panel=new DPanel(this.dCont,this.otstup,this.otstup+this.label.fontSize+2),this.funPostSO,this.startObj=function(){this.funPostSO&&this.funPostSO(),this.active=!0},this.drag=function(){},this.sizeW1,this.sizeW=function(){this.label.width=this.width,this.panel.width=this.width,this.panel.height=this._height-(this.label.fontSize+this.otstup+2),this.sizeW1&&this.sizeW1()},this.height=this.label.fontSize+this.otstup,this.heightStart=this.label.fontSize+this.otstup}return We(t,[{key:"width",set:function(t){this._width!=t&&(this._width=t,this.sizeW())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.sizeW())},get:function(){return this._height}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active)},get:function(){return this._active}}]),t}(),Ye=function(t){function e(t,i){var n;Xe(this,e),n=function(t,e){return!e||"object"!==Re(e)&&"function"!=typeof e?Ne(t):e}(this,ze(e).call(this,t,i));var s=Ne(Ne(n));n.type="HronCase1",n.par=t,n.label.text="";var a=n.otstup,r=n.otstup;return n.csvKorekt=new Ie(function(){}),n.button=new DButton(n.panel.content,a,r,"Загрузить csv",function(t){s.csvKorekt.startCsv(t)}),n.button.width=120,n.button.startFile("csv"),n.label=new DLabel(n.panel.content,a+n.button.width+n.otstup,r,"Загрузка файла языков, формат текста utf-8, разделитель - ; !!!!!!! "),n.label.width=120,r+=n.button.height+n.otstup,n.button1=new DButton(n.panel.content,a,r,"seve csv",function(t){trace(s.input1.text,s.input1.value),mhbd.getKeyList(s.input1.text,function(t){var e=s.csvKorekt.getCsvTextToArr(t,s.input1.text);trace(e),function(t,e,i){var n=new Blob([t],{type:i});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,e);else{var s=document.createElement("a"),a=URL.createObjectURL(n);s.href=a,s.download=e,document.body.appendChild(s),s.click(),setTimeout(function(){document.body.removeChild(s),window.URL.revokeObjectURL(a)},0)}}(e,"save.csv","text/plain")})}),n.button1.width=120,n.input1=new DInput(n.panel.content,a+122,r,"group3",function(t){trace(s.text,s.input1.text)}),n.input1.timeFun=1,n.input1.width=120,n.label1=new DLabel(n.panel.content,a+n.button.width+n.otstup+122,r,"Сохронить Модель в csv для texts"),n.label1.width=420,r+=n.button1.height+n.otstup,n.height=r+4*n.otstup,n.funPostSO=function(){},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&He(t,e)}(e,Ve),e}();function Qe(t){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ke(t,e){return!e||"object"!==Qe(e)&&"function"!=typeof e?ti(t):e}function qe(t){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Je(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ti(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var ei=function(t){function e(t,i){var n;Ze(this,e);var s=ti(ti(n=Ke(this,qe(e).call(this,t,i))));return n.type="MCOUser",n.postInit=function(){null==this.panel&&(trace("###",mhbd.uzer),null!=mhbd.uzer&&(this.panel=new DPanel(this.dCont1,0,this.otstup),this.label=new DLabel(this.panel.content,this.otstup,this.otstup,"null"),this.label.bold=!0,this.label.fontSize=12,this.label11=new DLabel(this.panel.content,50*this.otstup,this.otstup,"null"),this.label11.bold=!0,this.label11.fontSize=12,this.array[0]=this.hronCase2=new ii(this,function(t,e){"reSize"==t&&s.sizeW()}),this.sizeWindow()))},n.start=function(){this.active=!0,this.startObj()},n.object,n.startObj=function(t,e){if(null!=mhbd.uzer){s.object=mhbd.uzer,s.active=!0,s.label.value=s.object.first_name,s.label11.value=s.object.id;for(var i=0;i<s.array.length;i++)s.array[i].startObj(s.object);s.sizeWindow()}},n}return Je(e,V),e}(),ii=function(t){function e(t,i){var n;Ze(this,e);var s=ti(ti(n=Ke(this,qe(e).call(this,t,i))));n.type="HronCase2",n.par=t,n.label.text="",n.key="auth/users/me",n.setParam=function(t,e,i,n,a){if(null!=s.object){var r={type:"PATCH"};r.url=s.param.server+"auth/users/me/",r.data={};var o=new FormData;o.append(i,n),r.data=o,r.processData=!1,r.contentType=!1,r.headers={Authorization:"Token "+mhbd.token},r.success=function(t){a&&a()},r.error=function(t){console.error("не верная загрузка xУУУУУz",t)},$.ajax(r)}};var a=n.otstup,r=n.otstup;n.button=new DButton(n.panel.content,a,r," ",function(t){s.setParam(s.key,s.id,"icon",this.files[0])}),n.button.startFile(),n.button.width=n.button.height=100,a+=n.button.width+2*n.otstup,n.labelN=new DLabel(n.panel.content,a,r,"Имя:");var o=a+n.labelN.value.length*n.labelN.fontSize;n.input=new DInput(n.panel.content,o,r,null,function(t){s.setParam(s.key,s.id,"first_name",this.value)}),n.input.width=200;var h=r+=n.input.height+n.otstup;return n.labelAbout=new DLabel(n.panel.content,a,h,"О себе:"),n.taAbout=new DTextArea(n.panel.content,o,h," ",function(t){s.setParam(s.key,s.id,"bio",this.value)}),n.taAbout.width=200,r+=n.button.height+n.otstup,n.height=r,n.panel.height=n.height,n.funPostSO=function(){this.button.link=this.object.icon,this.input.value=this.object.first_name,this.taAbout.value=this.object.bio},n}return Je(e,U),e}();function ni(t){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ai(t){return(ai=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ri(t,e){return(ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function oi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var hi=function(t){function e(t,i,n,s,a){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==ni(e)&&"function"!=typeof e?oi(t):e}(this,ai(e).call(this));var o=oi(oi(r));r.type="MDLeng",null==dcmParam&&(dcmParam=new DCM),r.x=i||0,r.y=n||0,r.fun=a,r.type="MTovarsUser",r._width=900,r._height=500,r._value=null,r._active=!0,r.otstup=5,r.dCont=void 0,r.init=function(){if(null==this.dCont){var e=[];e.push({key:"group",id:0,name:"Все"}),e.push({key:"group",id:1,name:"Стены"}),e.push({key:"group",id:2,name:"Крыши"}),e.push({key:"group",id:3,name:"xzxz"}),e.push({key:"group",id:4,name:"xzxz"}),this.dCont=new DCont(t),this.dCont.x=this.x,this.dCont.y=this.y,this.dContPan=new DCont(this.dCont),this.panel=new DPanel(this.dContPan),this.panel.width=this.width;var i=this.otstup,n=this.otstup;this.buttonTK=new DButton(this.panel,i,n,e[0].name,function(){o.sortGal(this.idArr)}),this.buttonTK.idArr=e[0].id,i+=this.buttonTK.width+this.otstup,this.buttonTK1=new DButton(this.panel,i,n,e[1].name,function(){o.sortGal(this.idArr)}),i+=this.buttonTK1.width+this.otstup,this.buttonTK1.idArr=e[1].id,this.buttonTK2=new DButton(this.panel,i,n,e[2].name,function(){o.sortGal(this.idArr)}),i+=this.buttonTK2.width+this.otstup,n+=this.buttonTK2.height+this.otstup,this.buttonTK2.idArr=e[2].id,this.panel.height=n,i=this.otstup,this.gallery=new li(this.dContPan,0,n,function(t,e,i){o.index=this.index;for(var n=!1,s=-1,a=0;a<o.obj.array.length;a++)o.data[o.index].id==o.obj.array[a].id&&(s=a,n=!0);0==n&&(s=o.obj.array.push(o.getNewObj())-1),"setTimeXZNum"==t&&(o.obj.array[s].num[i]=e),"setTimeXZ"==t&&(o.obj.array[s][i]=e),o.fun("saveTime")},this),this.gallery.width=this._width+2*this.otstup,this.gallery.height=this._height-2*this.otstup,this.gallery.kolII=1,this.gallery.widthPic=this.gallery.width-2*this.otstup,this.gallery.heightPic=55,this.height=this.panel.height+this.gallery.height+this.otstup,this.reSize()}};var h=[];return r.sortGal=function(t){if(h=[],0!=t){for(var e=0;e<o.dataGlav.length;e++)for(var i=o.dataGlav[e].tWork.obj.str[2].split(","),n=0;n<i.length;n++)1*i[n]==t&&h.push(o.dataGlav[e]);trace(">>>>>",h),this.gallery.start(h)}else this.gallery.start(o.dataGlav)},r.reSize=function(){o.fun("ReSize")},r.data,r.setGroup=function(t){this.panel.visible=!0;for(var e=[],i=[],n=0;n<t.length;n++)t[n].tWork&&t[n].tWork.obj&&6==t[n].tWork.obj.tId&&(e.push(t[n].id+":"+t[n].name),i.push(t[n]));this.dataGlav=i,this.data=i,this.dragBat()},r.dragBat=function(){this.claer(),console.warn(">>>>",this.data),this.gallery.start(this.data),this.reSize()},r.claer=function(){},r.getNewObj=function(){var t={};return this.data?t.id=this.data[this.index].id:t.id=1,t.tId=6,t.bool=[!1,!1,!1,!1],t.num=[0,0,0],t.str=["","",""],t},r.array=[],r.obj,r.setObj=function(t){this.init(),this.obj=t,null!=this.obj&&null!=this.obj||(this.obj={}),"string"==typeof this.obj&&(this.obj={}),null==this.obj.obj&&(this.obj.obj=this.getNewObj(),o.fun("saveTime")),this.claer(),null==this.obj.array&&(this.obj.array=[],o.fun("saveTime")),mhbd.getKeyList("group",function(t){trace(">>>",t),o.setGroup(t)},void 0,void 0,"group/"),this._value=this.obj,o._index=-1,o.index=0},r}var i,n,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ri(t,e)}(e,DCont),i=e,(n=[{key:"active",set:function(t){this._active=t,this.dCont.visible=t},get:function(){return this._active}},{key:"glavLabel",set:function(t){this._glavLabel=t},get:function(){return this._glavLabel}},{key:"value",set:function(t){this._value=t,this.setObj(t)},get:function(){return this._value}},{key:"index",set:function(t){this._index!=t&&(this._index=t,this.gallery.index=t)},get:function(){return this._index}},{key:"x",set:function(t){this._x=t,this.panel&&(this.panel.x=t)},get:function(){return this._x}},{key:"y",set:function(t){this._y=t,this.panel&&(this.panel.y=t)},get:function(){return this._y}},{key:"width",set:function(t){this._width!=t&&(this._width=t)},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t)},get:function(){return this._height}}])&&si(i.prototype,n),s&&si(i,s),e}();function li(t,e,i,n,s){DGallery.call(this,t,e,i,n);var a=this;this.type="Gall44",this.par=s,this.otstup=this.par.otstup,this.panel.visible=!1,this.createZamen=function(){return new ui(this.content,0,0,this.downBtn2XZ,this)},this.downBtn2XZ=function(t,e,i){a.index=this.idArr,a.obj=a.array[this.idArr].object,a.fun&&a.fun(t,e,i)}}function ui(t,e,i,n,s){DBox.call(this,t,e,i,n),this.type="BoxXZ44";var a,r=this;this.par=s,this.otstup=this.par.otstup,this.colLight=dcmParam.compToHexArray(dcmParam.hexDec("#ffffff"),-30),this.colGlav=this.label.color,this.checkXZ=new DCheckBox(this,0,0," ",function(){r.chekControl(this.value),r.fun("setTimeXZ",this.value,"b")}),1==mhbd.debug&&(this.buttonID=new DButton(this,230,this.otstup,"",function(){window.open("https://alphakp.ru/www/adminAll.html?key=group&type=creat&id="+r.object.id)}),this.buttonID.width=this.checkXZ.height-4,this.buttonID.color="#eeeeee",this.buttonID.colorText="#000000"),this.labelXZ=new DLabel(this,230,this.otstup/2,""),this.labelZamena=new DLabel(this,230,this.otstup/2,""),this.labelZamena.color=this.colLight,this.inputXZ=new DInput(this,230,0,"",function(){var t=1*this.value;r.object.num=t,r.labelZamena.value=t,r.fun("setTimeXZNum",t,"0")}),this.inputXZ.timeFun=1,this.labelXZ1=new DLabel(this,300,this.otstup/2,""),this.labelZamena1=new DLabel(this,230,this.otstup/2,""),this.labelZamena1.color=this.colLight,this.inputXZ1=new DInput(this,300,0,"",function(){var t=1*this.value;r.object.num1=t,r.labelZamena1.value=t,r.fun("setTimeXZNum",t,"1")}),this.inputXZ1.timeFun=1,this.chekControl=function(t){r.inputXZ.visible=1==this.object.tWork.obj.bool[0]&&t,r.inputXZ1.visible=1==this.object.tWork.obj.bool[1]&&t,r.labelZamena.visible=1==this.object.tWork.obj.bool[0]&&!t,r.labelZamena1.visible=1==this.object.tWork.obj.bool[1]&&!t,r.labelXZ.visible=this.object.tWork.obj.bool[0],r.labelXZ1.visible=this.object.tWork.obj.bool[1],r.labelXZ.color=t?this.colGlav:this.colLight,r.labelXZ1.color=t?this.colGlav:this.colLight},this.label.activMouse=!1,this.startLoad=function(t){this.object=t,this.userObj=void 0,this.panel.visible=!1,this.color=dcmParam.compToHexArray(dcmParam.hexDec("#ffffff"),-10);var e,i;if(this.par.par.value.array)for(var n=0;n<this.par.par.value.array.length;n++)this.par.par.value.array[n].id==this.object.id&&(this.userObj=this.par.par.value.array[n]);this.userObj&&null!=this.userObj.b&&(this.checkXZ.value=this.userObj.b,this.chekControl(this.userObj.b)),this.image.link=this.object.icon,this.image.visible=!0,1==mhbd.debug&&(this.buttonID.text=this.object.id),this.label.text=this.object.name,this.label.visible=!0,e=this.userObj?this.userObj.num[0]+"":100,i=this.userObj?this.userObj.num[1]+"":100,this.inputXZ.value=e,this.inputXZ1.value=i,this.labelZamena.value=e,this.labelZamena1.value=i,this.labelXZ.value=this.object.tWork.obj.str[0],this.labelXZ1.value=this.object.tWork.obj.str[1],r.funLoad()},this.draw=function(){this.image.visible=!1,this.label.x=350,this.label.y=10;this._height;a=this._height/this.image.picHeight,this.image.width=this.image.picWidth*a,this.image.height=this.image.picHeight*a,this.image.x=this.checkXZ.x+this.checkXZ.height+5,this.image.y=0,this.label.x=this.image.x+this.image.width+5,this.label.y=this._height-24,this.label.width=this.panel.width/2,this.inputXZ.x=this.panel.width-2*this.inputXZ.width-4*this.otstup,this.inputXZ1.x=this.panel.width-this.inputXZ.width-2*this.otstup;var t=(this.labelZamena.value+"").length*this.labelZamena.fontSize*.6,e=(this.labelZamena.value+"").length*this.labelZamena.fontSize*.6;this.labelZamena.x=this.inputXZ.x+(this.inputXZ1.width-t)/2,this.labelZamena1.x=this.inputXZ1.x+(this.inputXZ1.width-e)/2,this.labelXZ.x=this.inputXZ.x,this.labelXZ1.x=this.inputXZ1.x,this.labelXZ.fontSize=14,this.labelXZ1.fontSize=14,this.inputXZ.y=this._height-this.inputXZ.height-this.otstup,this.inputXZ1.y=this._height-this.inputXZ.height-this.otstup,this.labelZamena.y=this.inputXZ.y+this.labelZamena.fontSize/2,this.labelZamena1.y=this.inputXZ1.y+this.labelZamena1.fontSize/2,this.checkXZ.x=0,this.checkXZ.y=this._height-this.checkXZ.height-this.otstup,1==mhbd.debug&&(this.buttonID.x=this.checkXZ.x+2,this.buttonID.height=this.labelXZ.fontSize-2,this.buttonID.fontSize=.75*(this.labelXZ1.fontSize-2)),this.image.visible=!0,this.postDraw&&this.postDraw()}}function ci(t){return(ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function di(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fi(t,e){return!e||"object"!==ci(e)&&"function"!=typeof e?vi(t):e}function mi(t){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bi(t,e)}function bi(t,e){return(bi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}li.prototype=Object.create(DGallery.prototype),li.prototype.constructor=li,Object.defineProperties(li.prototype,{index:{set:function(t){null!=this.array[t]&&this.korektPoIndex(t),this._index=t;for(var e=0;e<this.array.length;e++)this._index==e?this.array[e].activ=!0:this.array[e].activ=!1},get:function(){return this._index}}}),ui.prototype=Object.create(DBox.prototype),ui.prototype.constructor=ui;var yi=function(t){function e(t,i){var n;pi(this,e);var s=vi(vi(n=fi(this,mi(e).call(this,t,i))));return n.type="MCOWork",n._width=920,n.width=920,n.postInit=function(){null==this.panel&&(trace("###",mhbd.uzer),null!=mhbd.uzer&&(this.panel=new DPanel(this.dCont1,0,this.otstup),this.array[0]=this.hronCase1=new xi(this,function(t,e){"reSize"==t&&s.sizeW()}),this.sizeWindow()))},n.start=function(){this.active=!0,this.startObj()},n.object,n.startObj=function(t,e){if(s.init(),null!=mhbd.uzer){s.object=mhbd.uzer,s.active=!0;for(var i=0;i<s.array.length;i++)s.array[i].startObj(s.object);s.sizeWindow()}},n.object,n.postSW=function(t,e){this.array[0].width=this.width},n}return gi(e,V),e}(),xi=function(t){function e(t,i){var n;pi(this,e);var s=vi(vi(n=fi(this,mi(e).call(this,t,i))));n.type="HronCase1",n.par=t,n.label.text="",n._boolTovActive=!0,n.setParam=function(t,e,i,n,a){if(null!=s.object){var r={type:"PATCH"};r.url=s.param.server+"auth/users/me/",r.data={};var o=new FormData;o.append(i,n),r.data=o,r.processData=!1,r.contentType=!1,r.headers={Authorization:"Token "+mhbd.token},r.success=function(t){a&&a()},r.error=function(t){console.error("не верная загрузка xУУУУУz",t)},$.ajax(r)}};var a,r=n.otstup,o=n.otstup;return n.checkSwitch=new DCheckBox(n.panel.content,n.otstup,n.otstup,"Работы",function(){s.boolTovActive=this.value}),o+=n.checkSwitch._height+n.otstup,n.heightMin=o,n.panel.height=o,n.height=o,n.dContTov=new DCont(n.panel.content),n.dContTov.x=r,n.dContTov.y=o,n.tovars=new hi(n.dContTov,0,0,null,function(t){if("ReSize"!=t){var e=0;if(s.object.tWork)for(var i=0;i<s.object.tWork.array.length;i++)1==s.object.tWork.array[i].b&&e++;s.checkSwitch.text="Работы "+e,s.setParam(s.key,s.id,"tWork",JSON.stringify(this.value))}else s.heightMax=s.heightMin+this.height+4*s.otstup}),n.tovars.glavLabel="tWork",o+=n.tovars.height,n.heightMax=o,n.panel.height=o,n.height=o,n.checkSwitch.value=!0,n.funPostSO=function(){if(1==this.boolTovActive){a=!1;for(var t=0;t<this.object.userSort.length;t++)2!=this.object.userSort[t]&&4!=this.object.userSort[t]||(this.tovars.value=this.object.tWork,a=!0);0==a&&(this.tovars.active=!1)}if(this.object.tWork&&this.object.tWork.array){var e=0;for(t=0;t<this.object.tWork.array.length;t++)1==this.object.tWork.array[t].b&&e++;this.checkSwitch.text="Работы "+e}},n}var i,n,s;return gi(e,U),i=e,(n=[{key:"boolTovActive",set:function(t){this._boolTovActive=t,this.dContTov.visible=t,1==t?(this.height=this.heightMax,this.panel.height=this.heightMax):(this.height=this.heightMin,this.panel.height=this.heightMin),this.fun("reSize"),this.funPostSO()},get:function(){return this._boolTovActive}}])&&di(i.prototype,n),s&&di(i,s),e}();function _i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var wi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MSupCreate";var i,n,s=this;this._active=!1,this.otstup=5,this.width=300,s.funYes,s.funNot,this.dCont=new DCont(e),this.dCont.visible=this._active,this.panel=new DPanel(this.dCont,0,0),this.panel.alpha=.5,0==dcmParam.mobile?this.panel.div.addEventListener("mousedown",function(){s.funNot&&s.funNot(),s.active=!1}):this.panel.div.addEventListener("touchstart",function(){s.funNot&&s.funNot(),s.active=!1}),this.win=new DWindow(this.dCont,0,0," ",function(){}),this.win.dragBool=!1,this.win.hasMinimizeButton=!1,this.description=new DLabel(this.win.content,this.otstup,this.otstup),this.name=new DLabel(this.win.content,this.otstup,0,"Name"),this.nameTake=new DInput(this.win.content,this.otstup,0," "),this.nameTake.timeFun=10,this.buttonOK=new DButton(this.win.content,this.otstup,0,"Создать",function(){s.funYes&&s.funYes(s.nameTake.value),s.active=!1}),this.buttonNot=new DButton(this.win.content,this.otstup,0,"Отменить",function(){s.funNot&&s.funNot(),s.active=!1}),this.setXZ=function(t,e,i,n){this.active=!0,this.nameTake.value="name",this.win.text=t,this.description.text=e,s.funYes=i,s.funNot=n,this.newSize()},this.newSize=function(){var t=this.name.getTextWidth(this.name.text,this.name.fontSize)+5*this.otstup+18,e=this.width;this.description.width=e-2*this.otstup;var i=this.description.getRect().height+this.otstup;this.name.y=i+this.name.fontSize/2,this.nameTake.x=t,this.nameTake.y=i,i+=this.nameTake.height+this.otstup,this.buttonOK.y=this.buttonNot.y=i,i+=this.buttonOK.height+this.otstup,this.win.height=i+32,this.win.width=e,this.nameTake.width=this.win.width-t-this.otstup,this.buttonOK.width=this.buttonNot.width=(this.win.width-3*this.otstup)/2,this.buttonNot.x=this.buttonOK.width+2*this.otstup,this.sizeWindow()},this.sizeWindow=function(t,e,s){t&&(i=t,n=e,s),this.panel.width=i,this.panel.height=n,this.win.x=(i-this.win.width)/2,this.win.y=(n-this.win.height)/2}}var e,i,n;return e=t,(i=[{key:"active",set:function(t){this._active!=t&&(this._active=t,console.warn(">>>>>>>##>>",this._active),this.dCont.visible=this._active)},get:function(){return this._active}}])&&_i(e.prototype,i),n&&_i(e,n),t}();function Ai(t){return(Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ti(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pi(t){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ei(t,e){return(Ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Si(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ci=function(t){function e(t,i,n,s,a){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==Ai(e)&&"function"!=typeof e?Si(t):e}(this,Pi(e).call(this));var o=Si(Si(r));r.type="MCOPSector",r.par=t,r.fun=a,r.param=t.param,r.otstup=r.param.otstup,r.dCont11=i,r.x=n,r.y=s,r.kolElements=4;var h=r.x,l=r.otstup;return r.xxx,r.yyy,r.init=function(){this.panel1=new DPanel(this.dCont11,h,l),this.butSector=new DButton(this.panel1.content,h,l,"Участок",function(){o.par.par.par.par.par.mSupCr.setXZ("Выбрать участок","Введите номер участка:",function(t){trace("creatObj",t),o.obj.id=t,trace(o.obj)},function(){trace("backToList")})}),this.butSector.width=150,l+=this.butSector.height+this.otstup,this.butPreview=new DButton(this.panel1.content,h,l,"icon",function(){}),this.butPreview.height=this.butPreview.width=this.butSector.width,h+=this.butPreview.width+this.otstup,l+=this.butPreview.height+this.otstup,this.panel1.width=h,this.panel1.height=l,this.xxx=this.panel1.width+this.otstup+50,this.yyy=this.otstup;var t=this.panel1.width+this.otstup+50,e=this.otstup;this.widthAll=270,this.butWidth=(this.widthAll-this.kolElements*this.otstup)/this.kolElements,this.arrBut=[];for(var i=1;i<=this.kolElements;i++)null==this.arrBut[i]&&(this.arrBut[i]=o.generatBut(i,function(){})),i==this.kolElements&&(e+=this.arrBut[i].height);t=this.panel1.width+this.otstup+50;this.panCont=new DPanel(this.dCont11,t,e),this.panCont.width=1+this.widthAll-this.otstup,this.panCont.height=172,t=this.otstup,e=this.otstup,this.butPreview1=new DButton(this.panCont.content,t,e,"icon",function(){}),this.butPreview1.width=this.butPreview1.height=70,t+=this.butPreview1.width+this.otstup,this.butAdd=new DButton(this.panCont.content,t,e,"icon",function(){}),this.butAdd.width=180,e+=this.butAdd.height+this.otstup,this.butApprove=new DButton(this.panCont.content,t,e,"icon",function(){}),this.butApprove.width=180,this.reSize()},r.generatBut=function(t,e){var i=new DButton(this.dCont11,this.xxx,this.yyy,t,e);return i.idArr=t,i.width=this.butWidth,i.height=20,this.xxx+=i.width+this.otstup,i},r.reSize=function(){o.fun("ReSize")},r.claer=function(){},r.getNewObj=function(){for(var t={id:0,obj:[]},e=0;e<this.kolElements;e++)t.obj.push({index:e,id:0,arr:{id:0,up:0,arrUp:[]}});return t},r.array=[],r.obj,r.setObj=function(t){this.obj=t,null!=this.obj&&null!=this.obj||(this.obj=this.getNewObj(),o.fun("saveTime")),this._value=this.obj,trace("this._value",this._value)},r.init(),r}var i,n,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ei(t,e)}(e,DCont),i=e,(n=[{key:"active",set:function(t){this._active=t,this.dCont.visible=t},get:function(){return this._active}},{key:"glavLabel",set:function(t){this._glavLabel=t},get:function(){return this._glavLabel}},{key:"value",set:function(t){this._value=t,this.setObj(t)},get:function(){return this._value}},{key:"index",set:function(t){this._index!=t&&(this._index=t,this.gallery.index=t)},get:function(){return this._index}},{key:"x",set:function(t){this._x=t,this.panel&&(this.panel.x=t)},get:function(){return this._x}},{key:"y",set:function(t){this._y=t,this.panel&&(this.panel.y=t)},get:function(){return this._y}},{key:"width",set:function(t){this._width!=t&&(this._width=t)},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t)},get:function(){return this._height}}])&&Ti(i.prototype,n),s&&Ti(i,s),e}();function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Di(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ki(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Li(t,e){return!e||"object"!==ji(e)&&"function"!=typeof e?Bi(t):e}function Fi(t){return(Fi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mi(t,e)}function Mi(t,e){return(Mi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ii=function(t){function e(t,i){var n;ki(this,e);var s=Bi(Bi(n=Li(this,Fi(e).call(this,t,i))));return n.type="MCOProject",n.par=t,n.postInit=function(){null==this.panel&&(this.panel=new DPanel(this.dCont1,0,this.otstup),this.array[0]=this.hronVorodis1=new zi(this,function(t,e){"ReSize"==t&&s.sizeWindow()}),this.array[1]=this.hronVorodis2=new Hi(this,function(t,e){"ReSize"==t&&s.sizeWindow()}),this.array[2]=this.hronVorodis2=new Ni(this,function(t,e){"ReSize"==t&&s.sizeWindow()}),this.sizeWindow())},n}return Oi(e,V),e}(),Ri=function(t){function e(t,i){var n;ki(this,e);var s=Bi(Bi(n=Li(this,Fi(e).call(this,t,i))));return n.type="HronVorodis1",n._sizeMinMax=void 0,n.label.text=" ",n._minHeight=0,n._maxHeight=0,n.checkBox=new DCheckBox(n.panel.content,n.otstup,n.otstup," ",function(){s.sizeMinMax=this.value}),n._minHeight=n.checkBox.height+2*n.otstup,n._maxHeight=50,n.dCont11=new DCont(n.panel.content),n.dCont11.y=n.minHeight,n.panel.height=n.minHeight,n.height=n.panel.height+n.heightStart+n.otstup,n.sizeMinMax=!1,n}var i,n,s;return Oi(e,U),i=e,(n=[{key:"sizeMinMax",set:function(t){this._sizeMinMax!=t&&(this._sizeMinMax=t,this.checkBox.value=t,this.panel.height=1==t?this.maxHeight:this.minHeight,this.height=this.panel.height+this.heightStart+this.otstup,this.dCont11.visible=t,this.fun("ReSize"))},get:function(){return this._sizeMinMax}},{key:"minHeight",set:function(t){this._minHeight!=t&&(this._minHeight=t,this.sizeW())},get:function(){return this._minHeight}},{key:"maxHeight",set:function(t){this._maxHeight!=t&&(this._maxHeight=t,this.sizeW())},get:function(){return this._maxHeight}}])&&Di(i.prototype,n),s&&Di(i,s),e}(),zi=function(t){function e(t,i){var n;ki(this,e);Bi(Bi(n=Li(this,Fi(e).call(this,t,i))));return n.type="HronVorodis1",n.par=t,n._sizeMinMax=!1,n.label.text="Участники",n.maxHeight=100,n}return Oi(e,Ri),e}(),Hi=function(t){function e(t,i){var n;ki(this,e);Bi(Bi(n=Li(this,Fi(e).call(this,t,i))));return n.type="HronVorodis2",n.par=t,n._sizeMinMax=!1,n.label.text="Xz",n.maxHeight=100,n}return Oi(e,Ri),e}(),Ni=function(t){function e(t,i){var n;ki(this,e);Bi(Bi(n=Li(this,Fi(e).call(this,t,i))));n.type="HronVorodis3",n.par=t,n._sizeMinMax=!1,n._sizeMinMax=!1,n.label.text="Ресурсы проекта";var s=n.otstup,a=n.otstup;return n.sector=new Ci(Bi(Bi(n)),n.dCont11,s,a,function(){}),n.maxHeight=n.dCont11.y+n.sector.height+2*n.otstup,n.sizeMinMax=!0,n.funPostSO=function(){trace(this.object),this.sector.value=this.object.json1},n}return Oi(e,Ri),e}();function Xi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ui(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Wi=function(){function t(e,i){Xi(this,t),this.type="MCObject",this.fun=i,this.par=e;var n,s,a;this.param=e.param,this._active=!1,this.ak=[],this.array=[],this.dCont=new DCont(e.dCont),this.array.push(new J(this)),this.array.push(new de(this)),this.array.push(new Ee(this)),this.array.push(new Me(this)),this.array.push(new Ge(this)),this.array.push(new ei(this)),this.array.push(new yi(this)),this.array.push(new Ii(this)),this.startKey=function(t,e,i){this.clear();for(var n=0;n<this.ak.length;n++)if(this.ak[n].name==t)for(var s=0;s<this.array.length;s++)this.array[s].type==this.ak[n].type&&this.array[s].start(e,this.ak[n].array,t)},this.setKey=function(t,e,i){this.ak.push(new Gi(this,t,i,e))},this.clear=function(t){this.active=!1;for(var e=0;e<this.array.length;e++)this.array[e].clear()},this.setParam=function(){this.x=this.otstup,this.dCont.x=this.param.otstup,this.dCont.y=this.param.otstup+this.param.wh,this.sizeWindow()},this.sizeWindow=function(t,e,i){t&&(n=t,s=e,a=i);for(var r=0;r<this.array.length;r++)this.array[r].sizeWindow(n,s,a)}}var e,i,n;return e=t,(i=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active)},get:function(){return this._active}}])&&Ui(e.prototype,i),n&&Ui(e,n),t}(),Gi=function t(e,i,n,s){Xi(this,t),this.par=e;this.type=n,this.name=i,this.array=s};function Vi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Yi=function t(e,i){Vi(this,t),this.type="MenuCent",this.fun=i,this.par=e;var n,s,a,r,o=this;this.param=e.param,this.dCont=new DCont(e.dCont),this.array=[],this.sob=function(t,e,i){},this.init=function(){this.panel=new DPanel(this.dCont,0,0),this.mcPanel=new E(this.dCont,function(t,e,i){if("sobCmena"==t&&e&&e.param&&("id"!=e.param&&"name"!=e.param&&"up"!=e.param||(o.mcGal._keshSort=e.param,o.mcGal._keshParam=i,o.mcGal._boolSort=!1,o.mcGal.sortList()),"DComboBox"==e.cmena)){var n=(e.value+"").split(",");n&&n[1]&&"getTypeSort"==n[0]&&(o.mcGal._keshSort=e.param,o.mcGal._keshParam=i,o.mcGal._boolSort=!0,o.mcGal.sortList())}}),this.mcPanel.activePanel=!0,this.mcGal=new B(this,function(t,e,i,n,s){if("komp"==t&&e.cmena&&"DButton"==e.cmena){if("openCreat"==e.param&&(trace("@@@@@@@@@@@@@@@@@@@@@@@@@",s+"Creat",n),o.setSob(s+"Creat",n)),"openVisi"==e.param){var a=o.param.serverNa+"admin.html?"+s+"="+n.id;window.open(a)}if("openVisiPlane"==e.param){a=o.param.serverNa+"?id="+n.id;window.open(a)}"openThree"==e.param&&o.fun("openThree",n.id,s),"dragObj"==e.param&&(n.timeKey=s,dragPic.start(32,n.icon,n))}trace(t),"setGalSortParam"==t&&o.setSortParam()}),this.mcLoad=new Zi(this,function(t,e,i){"List"==t&&(o.mcGal.setSob(t,e,i),o.getSortParam(t+i),o.galKeshList=t+i,trace("s,p,p1",t,e,i))}),this.mcObject=new Wi(this,function(t,e,i){}),this.mcLinki=new Qi(this,function(t,e,i){"openLeftField"===t&&o.fun("openLeftField",e)});var t={param:"icon",width:100,title:"icon",cmena:"DButton",value:"../../resources/image/notpic.png",bool:!0};(n=[{param:"name",width:100,cmena:"DInput",title:"name",value:null}]).push(t),(t={param:"delete",width:100}).title="delete",t.cmena="DButton",t.value="delete",n.push(t)},this.galKeshSort=void 0,this.galKeshParam=void 0,this.galKeshbool=void 0,this.galKeshSahpos=void 0,this.galKeshList=void 0,this.setSortParam=function(t){1==t?(this.galKeshSort="null",this.galKeshParam="null",this.galKeshbool=!1,this.galKeshSahpos=0):(this.galKeshSort="null"!=this.mcGal.keshSort?this.mcGal.keshSort:this.galKeshSort,this.galKeshParam="null"!=this.mcGal.keshParam?this.mcGal.keshParam:this.galKeshParam,this.galKeshbool=this.mcGal.boolSort,this.galKeshSahpos=0!=this.mcGal.sahpos?this.mcGal.sahpos:this.galKeshSahpos)},this.getSortParam=function(t){o.galKeshList==t?(o.mcGal._keshSort=o.galKeshSort,o.mcGal._keshParam=o.galKeshParam,o.mcGal._boolSort=o.galKeshbool,o.mcGal._sahpos=o.galKeshSahpos,o.mcGal.sortList()):o.setSortParam(!0),trace(this.galKeshSort,this.galKeshParam,this.galKeshbool,this.galKeshSahpos)},this.getObjKey=function(t,e){return[]},this.setParam=function(){1==this.param.mobile?this.dCont.x=this.param.wh+4*this.param.otstup:this.dCont.x=this.param.wb+4*this.param.otstup,this.dCont.y=this.param.wh2+4*this.param.otstup,this.mcGal.setParam(),this.mcObject.setParam(),this.mcPanel.wh=this.param.wh,this.mcPanel.otstup=this.param.otstup,this.mcPanel.widthSwap=2*this.param.wh,this.mcGal.widthSwap=2*this.param.wh,this.sizeWindow()},this.init(),this.titleSob="",this.setSob=function(t,e){for(var i=0,n=0;n<o.mcGal.ak.length;n++)if(i=n,o.mcGal.ak[i].name==t+"List")return void setTimeout(function(){o.fun("openLeftField",t+"List")},1);o.mcPanel.startKey(t),o.mcPanel.setObjParam(e),o.mcGal.startKey(t),this.mcLoad.setSob(t),this.mcObject.startKey(t,e),this.mcLinki.startKey(t,e),this.titleSob=t},this.openArr=function(t){for(var e=0;e<t.length;e++)this.oAObj(t[e]);this.mcLinki.openArr(t)},this.oAObj=function(t){var e=!0;if(t&&t.obj&&null!=t.obj.Obj&&(1==t.obj.Obj.active&&(o.mcPanel.setKey(t.name,t.obj.Obj.array),e=!1),1==t.obj.List.active&&(o.mcGal.setKey(t.name,t.obj.List.array),e=!1),1==t.obj.Creat.active&&(o.mcObject.setKey(t.name,t.obj.Creat.array,t.obj.Creat.type),e=!1)),e){if(-1!=t.name.indexOf("List")){var i=t.arrText[2].split(",");this.getObjKey(i),this.getObjKey([t.arrText[2].split(",")]);o.mcPanel.setKey(t.name,this.getObjKey(t.arrText[2].split(","),!0)),o.mcGal.setKey(t.name,this.getObjKey(t.arrText[3].split(","),!1))}-1!=t.name.indexOf("Creat")&&(this.mcObject.setKey(t.name,n,t.arrText[1]),this.mcPanel.setKey(t.name,{param:"up",width:500,title:"Редактирование обьекта"}))}if(t.array)for(var s=0;s<t.array.length;s++)this.oAObj(t.array[s])},this.sizeWindow=function(t,e,i){t&&(s=t,a=e,r=i),this.panel.width=s/r-(this.param.otstup+this.panel.x),this.panel.height=a/r-(this.param.otstup+this.panel.y),this.mcGal.sizeWindow(s-(this.param.otstup+this.dCont.x)-2,a,r),this.mcPanel.width=(s-(this.param.otstup+this.dCont.x))/r-4.5,this.mcPanel.height=this.param.wh,this.mcPanel.deligateResize(),this.mcObject.sizeWindow(s,a,r)}},Qi=function t(e,i){Vi(this,t),this.type="MCLoad",this.fun=i,this.par=e;var n=this;this.param=e.param,this.startKey=function(t,e){var i=s+"?";if(-1!=t.indexOf("List"))return i+="key="+t.split("List")[0]+"&type=list",void history.pushState(null,null,i);if(-1!=t.indexOf("Creat")&&e)return i+="key="+t.split("Creat")[0]+"&type=creat&id="+e.id,void history.pushState(null,null,i);return-1==t.indexOf("Creat")&&-1==t.indexOf("List")?(i+="key="+t,void history.pushState(null,null,i)):void 0};var s=window.document.URL.toString().split("?")[0];this.parseLink=function(){setTimeout(function(){var t=mhbd.getURLParameters("key"),e=mhbd.getURLParameters("type"),i=mhbd.getURLParameters("id");null!=t&&(e&&"creat"==e.toLowerCase()&&i&&mhbd.getKeyId(t,i,function(e,i){n.fun("openLeftField",t+"List"),n.par.setSob(t+"Creat",e)}),e&&"list"==e.toLowerCase()&&(n.fun("openLeftField",t+"List"),i&&n.par.mcGal.setSob("serchId",Number(i))),null==e&&n.fun("openLeftField",t))},1)},this.openArr=function(t){this.parseLink()}},Zi=function t(e,i){Vi(this,t),this.type="MCLoad",this.fun=i,this.par=e;var n=this;this.param=e.param,this.name="",this.dCont=new DCont(e.dCont),this.setSob=function(t){if(-1!=t.indexOf("List")){var e=t.split("List");this.name=e[0],this.openList(this.name)}},this.openList=function(t){mhbd.getKeyList(this.name,function(t){n.fun("List",t,n.name)},!0)}};var Ki=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=this;this.par=e,this.param=e.param,this.debug=!1,this.token=this.param.token,this.idUzer=10,this.uzer=null,this.plusLinkKey="";var n,s,a=r("typeUzer");function r(t,e){var i=window.document.URL.toString();null!=e&&(i=e);i.split("/");if(i.indexOf("?")>0){var n=i.split("?")[1].split("&"),s=new Array(n.length),a=new Array(n.length);n=i.split("?")[1].split("&"),s=new Array(n.length),a=new Array(n.length);var r=0;for(r=0;r<n.length;r++){var o=n[r].split("=");s[r]=o[0],""!=o[1]?a[r]=unescape(o[1]):a[r]=null}for(r=0;r<n.length;r++)if(s[r]==t)return a[r];return null}}a&&(this.param.typeUzer=a),this.setFile=function(t,e,n,s,a){if(null!=e[s+"Id"]&&e[s+"Id"]>=1){var r=e[s+"Id"];(o={type:"DELETE"}).url=this.param.server+n+"/files/"+r+"/",o.success=function(t){trace("ура Убили==",r)},i.token&&(o.headers={Authorization:"Token "+i.token}),$.ajax(o)}e&&e[s];var o,h=new FormData;h.append("src",t),h.append("rel_obj",e.id),(o={type:"POST"}).url=this.param.server+n+"/files/",o.data=h,o.processData=!1,o.contentType=!1,i.token&&(o.headers={Authorization:"Token "+i.token}),o.success=function(t){e[s]=t.src,mhbd.setParam(n,e.id,s,t.src),null!=e[s+"Id"]&&(e[s+"Id"]=t.id,mhbd.setParam(n,e.id,s+"Id",t.id));var i=t.src;a(i)},o.error=function(t){console.error("не верная загрузка xУУУУУz")},$.ajax(o)},this.getKeyList=function(t,e,s,a,r){if(null==s&&null!=this.param[t])return e&&e(this.param[t]),this.param[t];n="/",null!=a&&(n=a);var o={};return t.indexOf("/"),o.url=this.param.server+t+this.plusLinkKey+n,null!=r&&(o.url=this.param.server+r),o.type="GET",o.success=function(n){i.param[t]=n.results,e&&e(n.results)},i.token&&(o.headers={Authorization:"Token "+i.token}),trace(o.url),$.ajax(o),null},this.objId={},this.getKeyId=function(t,e,n,s){if(null==s){if(this.par.param[t])for(var a=0;a<this.par.param[t].length;a++)if(this.par.param[t][a].id==e)return n&&n(this.par.param[t][a]),this.par.param[t][a];if(null!=i.objId[t]&&null!=i.objId[t][e])return n&&n(i.objId[t][e]),i.objId[t][e]}return $.ajax({type:"GET",url:this.par.param.server+t+"/"+e+"/",success:function(s){null==i.objId[t]&&(i.objId[t]={}),i.objId[t][e]=s,n&&n(s)}}),null},this.deleteId=function(t,e,i){$.ajax({type:"DELETE",url:this.par.param.server+t+"/"+e+"/",success:function(t){i&&i()}})},this.setParam=function(t,e,n,s,a){var r={type:"PATCH"};r.url=i.param.server+t+"/"+e+"/",r.data={},r.data[n]=s,i.token&&(r.headers={Authorization:"Token "+i.token}),r.success=function(t){a&&a()},r.error=function(t){console.error("не верная загрузка xУУУУУz")},trace(r),$.ajax(r)},this.getArKey=function(t,e){for(var i=0;i<this.param[t].length;i++)if(this.param[t][i].id==e)return this.param[t][i];return null},this.getURLParameters=function(t,e){return r(t,e)},this.creatParamKategor=function(){this.creatParamKategor1()},this.creatParamKategor1=function(){for(var t=0;t<this.param.group.length;t++)if((s=this.param.group[t]).products){s.productsObj=[];for(var e=0;e<s.products.length;e++){var i=this.getArKey("group3",s.products[e]);s.productsObj[e]=i}}}};function qi(t,e,i,n){DGallery.call(this,t,e,i,n);this.type="GalleryXZ",this.param,this.createZamen=function(){return new Ji(this.content,0,0,this.downBtn,this)},this.dragColorGal=function(){for(var t=0;t<this.array.length;t++)this.array[t].dragColorGal()}}function Ji(t,e,i,n,s){DBox.call(this,t,e,i,n),this.type="BoxXZ";var a,r=this;this.par=s,this.dragColorGal=function(){null!=this.object.c?this._color1!=this.object.c&&(this._color1=this.object.c,this.panel.color1=this._color1,this.draw()):this._color1!=this.par._color1&&(this._color1=this.par._color1,this.panel.color1=this._color1,this.draw())},this.startLoad=function(t){this.object=t;t.icon&&t.icon,$.ajax({type:"GET",url:this.par.param.server+t.key+"/"+t.id+"/",success:function(t){r.image.link=t.icon,r.funLoad&&r.funLoad()}}),this.dragColorGal(),null!=t.id&&(this.label.visible=!0,this.label.text=t.id,this.label.div.style.pointerEvents="none",this.label.fontSize=10),this.image.visible=!0,this.draw()},this.draw=function(){(a=(this._width-2*this._otstup)/this.image.picWidth)>(this._height-2*this._otstup)/this.image.picHeight&&(a=(this._height-2*this._otstup)/this.image.picHeight),this.image.x=0,this.image.width=this.image.picWidth*a,this.image.height=this.image.picHeight*a,this.image.x=(this._width-this.image.picWidth*a)/2,this.image.y=(this._height-this.image.picHeight*a)/2,this.label.x=2,this.label.y=this._height-11,this.postDraw&&this.postDraw()}}function $i(t,e){var i=this;this.type="MThree",this.par=t,this.fun=e,this.otstup=2,this.wh=32,this.whv=20,this.widthBig=250-2*this.otstup,this.objectBase=200,this.dCont=new DCont(this.par.window),this._width=100,this._height=200,this._active=!1,this._index=-1,this._iOld=-1,this._arrayOld=[],this._iArr=this.objectBase.three,this.rect={x:0,y:0,w:100,h:100,visible:this._active,fun:function(t,e){}},this.initBool=!1,this.w=new DWindow(this.dCont,this.otstup,200," "),this.w.width=this.widthBig,this.w.height=this._height,this.rect.height=this._height,this.w.dragBool=!1,this.w.hasMinimizeButton=!1,this.gallery=new qi(this.w.content,this.otstup,this.otstup,function(){i.index=this.index,i.openUUID(this.array[this.index].object.uuid)}),this.gallery.width=this.widthBig-2*this.otstup,this.gallery.kolII=5,this.gallery.widthPic=46,this.gallery.heightPic=46,this.gallery.height=this._height-32-2*this.otstup,this.oldRandom=-1,this.gallery.param=t.param,dragPic.addDCont(this.w,function(t,e){i.setObj(t)}),this.generateRendom=function(t){null==t&&(t=2);for(var e,i="",n="",s=0;s<t;s++){if((n=(255&(e=4294967295*Math.random()|0)).toString(16)+(e>>8&255).toString(16)+(e>>16&255).toString(16)+(e>>24&255).toString(16)).length<8)for(var a=0;a<8-n.length+1;a++)n+="Z";i+=n,s!=t-1&&(i+="-")}return i},this.setObj=function(t){if(0!=this._active){var e={id:t.id,key:t.timeKey,uuid:this.generateRendom(2),array:[]};this._iArr.unshift(e),this.gallery.start(this._iArr),this.openUUID(e.uuid),this.fun("saveTime")}},this.nazad=function(){};var n={ii:0,par:null};this.openUUID=function(t,e){i.getParWW(i.objXZ,t),null==n.par&&(n.par=i.objXZ,n.ii=0),this.gallery.start(n.par.array),this.gallery.index=-1,n.par.array[n.ii]&&(this.gallery.index=n.ii,this.fun("open",this.gallery.array[this.gallery.index].object),i._iArr=n.par.array,i._index=n.ii)},this.getParWW=function(t,e){if(t.array){if(e==t.uuid)return!0;for(var i=t,s=0;s<t.array.length;s++){1==this.getParWW(t.array[s],e)&&(n.ii=s,n.par=i)}}return!1},this.getNazad=function(t,e,i){var n=t[e[i]].array;return i++,e.length!=i&&(n=this.getNazad(n,e,i)),n},this.objXZ=void 0,this.startObj=function(t){this.objXZ=t,null==this.objXZ.uuid&&(this.objXZ.uuid="xzxzxz3"),null==this.objXZ.array&&(this.objXZ.array=[],this.fun("saveTime")),i._iArr=this.objXZ.array,this.active=!0,this.objIn=this.objXZ,this._iArr&&this._iArr[0]&&this.fun("open",this._iArr[0])};var s;this.down=function(){if(0==this.idArr&&(i._iArr=i.gallery.array[i.gallery.index].object.array,i.gallery.start(i._iArr),i._iArr[0]&&i.openUUID(i._iArr[0].uuid)),1==this.idArr){!function(){var t=i.index;i._index=-1;i._iArr.splice(t,1);i.gallery.start(i._iArr),t>i.gallery.array.length-1&&(t=i.gallery.array.length-1),i.index=t,i.fun("saveTime")}()}var t;if(2==this.idArr&&(t=i.index)>0){var e=i._iArr.splice(t,1);i._iArr.splice(t-1,0,e[0]),i.gallery.start(i._iArr),i.fun("saveTime"),i.index=t-1,i.gallery.index=i.index}if(3==this.idArr&&((t=i.index)<i._iArr.length-1&&-1!=t)){e=i._iArr.splice(t,1);i._iArr.splice(t+1,0,e[0]),i.fun("saveTime"),i.gallery.start(i._iArr),i.index=t+1,i.gallery.index=i.index}};this.ab=[];for(var a=0;a<4;a++)(s=new DButton(this.w,(this.otstup+28)*a+this.otstup,this.otstup," ",this.down)).idArr=a,s.width=28,s.height=28,0==a&&(s.text="<<",s.color="#ff0000",s.alpha=.5),1==a&&(s.text="-"),2==a&&(s.text="<"),3==a&&(s.text=">"),this.ab.push(s);this.sizeWindow=function(t,e){this._width=t,this._height=e},this.objIn,Object.defineProperty(this,"active",{set:function(t){this._active!=t&&(this._active=t,this.rect.visible=t,1==t?(this.dCont.add(this.w),0==this.initBool&&(this.initBool,this.gallery.start(this._iArr))):this.dCont.remove(this.w))},get:function(){return this._active}}),Object.defineProperty(this,"index",{set:function(t){this._index=t},get:function(){return this._index}})}function tn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}qi.prototype=Object.create(DGallery.prototype),qi.prototype.constructor=qi,Object.defineProperties(qi.prototype,{index:{set:function(t){null!=this.array[t]&&this.korektPoIndex(t),this._index=t;for(var e=0;e<this.array.length;e++)this._index==e?this.array[e].activ=!0:this.array[e].activ=!1},get:function(){return this._index}}}),Ji.prototype=Object.create(DBox.prototype),Ji.prototype.constructor=Ji;var en=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MCCxzxz",this.fun=n,this.par=e,this.param=e.param;var s=this;this._active=!1,this.dCont=new DCont(i),this.dCont.visible=this._active,this.array=[],this.init=function(){if(void 0===this.w){this.w=new DPanel(this.dCont,0,0),this.w.width=250,this.w.height=350,this.w.dragBool=!1,this.w.hasMinimizeButton=!1,this.gallery=new nn(this.w.content,0,0,function(t){s.index=this.index,s.fun("retJson",this.array[this.index].object.id,"group1")}),this.gallery.width=this.w.width,this.gallery.height=this.w.height,this.gallery.kolII=4,this.gallery.widthPic=(this.w.width-10)/this.gallery.kolII,this.gallery.heightPic=this.gallery.widthPic;var t={};t.url=this.param.server+"group1/",t.type="GET",t.success=function(t){for(var e=[],i=0;i<t.length;i++)e.unshift(t[i]);s.gallery.start(e)},$.ajax(t)}},this.init()}var e,i,n;return e=t,(i=[{key:"objID",set:function(t){if(this._objID!=t){this._objID=t;for(var e=0;e<this.gallery.array.length;e++)this.gallery.array[e].object.id==t&&(this.gallery.index=e)}},get:function(){return this._objID}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active,this.init())},get:function(){return this._active}}])&&tn(e.prototype,i),n&&tn(e,n),t}();function nn(t,e,i,n){DGallery.call(this,t,e,i,n);this.type="Gall33",this.createZamen=function(){return new sn(this.content,0,0,this.downBtn,this)}}function sn(t,e,i,n,s){DBox.call(this,t,e,i,n),this.type="BoxXZ";var a=this;this.par=s,this.label.fontSize=12,this.label.activMouse=!1,this.startLoad=function(t){this.object=t,this.label.text=t.param,this.label.visible=!0,a.funLoad();var e="resources/image/notpic.png";t.icon&&(e=t.icon),null!=t.icon?(this.image.visible=!0,this.image.link==e?a.funLoad&&a.funLoad():(this.image.width=100,this.image.height=100,this.image.link=e)):this.image.visible=!1}}nn.prototype=Object.create(DGallery.prototype),nn.prototype.constructor=nn,Object.defineProperties(nn.prototype,{index:{set:function(t){null!=this.array[t]&&this.korektPoIndex(t),this._index=t;for(var e=0;e<this.array.length;e++)this._index==e?this.array[e].activ=!0:this.array[e].activ=!1},get:function(){return this._index}}}),sn.prototype=Object.create(DBox.prototype),sn.prototype.constructor=sn;var an=function t(e,i,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MCMK1",this.fun=i,this.par=e;var a=this;this.param=e.param,this.x=n,this.y=s,this.dCont=new DCont(this.par.window.content),this.dCont.x=this.x,this.dCont.y=this.y,this.window=new DWindow(this.dCont,0,0,"Параметры поля"),this.window.hasMinimizeButton=!1,this.window.dragBool=!1,this.window.width=this.par.window.width,this.window.height=200,this.fontSize=16,this.wh=2*this.fontSize,this.height=void 0,this.drag=function(){for(var t=0;t<this.arrComp.length;t++)this.arrComp[t].linkParam&&-1===this.arrComp[t].linkParam.indexOf("invisible")&&("param"==this.arrComp[t].linkParam&&a.objBase[this.arrComp[t].linkParam]!=this.arrComp[t].value&&a.fun("dragParam",this.arrComp[t].value),a.objBase[this.arrComp[t].linkParam]=this.arrComp[t].value);a.fun("saveTime")};var r=this.window.width-100-4,o=this.param.otstup;this.arrComp=[],this.ObjComp={},this.addComponent=function(t,e,i,n,s,r,h,l,u,c,d,p,f){var m=null;!0===e&&(new DLabel(s,h,u+this.fontSize,n).width=a.window.width-r);"DComboBox"==t&&(m=new DComboBox(s,l,u,c,d,p)),"DButton"==t&&(m=new DButton(s,l,u,c,d,p)),"DCheckBox"==t&&(m=new DCheckBox(s,l,u,c,d,p,f)),"DImage"==t&&(m=new DImage(s,l,u,p,d)),"DLabel"==t&&(m=new DLabel(s,l,u,c)),"DSliderBig"!=t&&"DSlider"!=t||((m=new DSliderBig(s,l,u,d,c,p,f)).mobile=!0),"DInput"==t&&((m=new DInput(s,l,u,c,d)).timeFun=1),"DTextArea"==t&&(m=new DTextArea(s,l,u,c,d)),m.width=r,m.height=this.wh,i&&(m.linkParam=i),!0===e&&(o+=this.wh+this.param.otstup),this.arrComp.push(m),this.ObjComp[i]=m},this.addComponent("DInput",!0,"param","param",this.window.content,r,this.param.otstup,100,o,"param",function(){a.drag()}),this.addComponent("DInput",!0,"title","title",this.window.content,r,this.param.otstup,100,o,"title",function(){a.drag()}),this.addComponent("DSlider",!0,"width","width",this.window.content,r,this.param.otstup,100,o," ",function(){this.value=Math.round(this.value),a.drag()},-1,300),this.addComponent("DInput",!0,"value","comp.value",this.window.content,r,this.param.otstup,100,o," ",function(){a.drag()}),this.arrComp[this.arrComp.length-1].width=this.window.width-100-4-(this.wh+this.param.otstup),this.addComponent("DCheckBox",!1,"invisible_Value",null,this.window.content,r,this.param.otstup,this.window.width-(this.wh+this.param.otstup),o-(this.wh+this.param.otstup)," ",function(){a.cxzxz.active=this.value,a.drag()}),this.arrComp[this.arrComp.length-1].value=!1,this.addComponent("DComboBox",!0,"cmena","comp.name",this.window.content,r,this.param.otstup,100,o,["null","DComboBox","DButton","DImage","DInput","DCheckBox","MDLeng","MTovars"],function(){a.drag()}),this.addComponent("DSlider",!0,"priority","priority",this.window.content,r,this.param.otstup,100,o," ",function(){this.value=Math.round(this.value),a.drag()},0,100);var h=new DPanel(this.window.content,this.param.otstup,o);h.width=this.window.width-2*this.param.otstup,o+=this.param.otstup,this.addComponent("DCheckBox",!0,"bool","bool",this.window.content,r-2*this.param.otstup,2*this.param.otstup,100,o," ",function(){a.drag()}),this.addComponent("DInput",!0,"str","str",this.window.content,r-2*this.param.otstup,2*this.param.otstup,100,o,"str",function(){a.drag()}),this.addComponent("DSliderBig",!0,"num","num",this.window.content,r-2*this.param.otstup,2*this.param.otstup,100,o," ",function(){this.value=Math.round(this.value),a.drag()},0,300),h.height=3*(this.wh+this.param.otstup),o+=this.wh+this.param.otstup,this.cxzxz=new en(this,this.window.content,function(t,e,i){a.ObjComp.value.value="iconId,"+i+","+e,a.drag()}),this.cxzxz.dCont.x=this.window.width+this.param.otstup,this.cxzxz.active=!1,this.height=this.window.height=o,this.objBase=void 0,this.setObj=function(t){if(this.objBase=t,null!=this.objBase){this.window.visible=!0;for(var e=0;e<this.arrComp.length;e++)this.arrComp[e].linkParam&&(this.arrComp[e].value=this.objBase[this.arrComp[e].linkParam],"iconId"==this.objBase.value.split(",")[0]?(this.ObjComp.invisible_Value.value=!0,this.cxzxz.active=this.ObjComp.invisible_Value.value,this.cxzxz.objID=this.objBase.value.split(",")[2]):(this.ObjComp.invisible_Value.value=!1,this.cxzxz.active=this.ObjComp.invisible_Value.value))}else this.window.visible=!1}};function rn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var on=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MenuConfigList",this.fun=i,this.par=e;var n=this;this._active=!1,this.param=e.param,this.dCont=new DCont(e.dCont),this.dCont.visible=this._active,this.down=function(){if(0==this.idArr&&(n.objObj.array.push(n.getBaseObjObj()),n.gallery.start(n.objObj.array),n.index1=n.objObj.array.length-1,n.fun("saveTime")),1==this.idArr){var t=n.index1;n.objObj.array.splice(n.index1,1),t>n.objObj.array.length-1&&(t=n.objObj.array.length-1),n.gallery.start(n.objObj.array),n.index1=t,0==n.objObj.array.length&&(n.cxzxz.active=!1),n.fun("saveTime")}if(2==this.idArr){var e=n.index1;if(e>0){var i=n.objObj.array.splice(n.index1,1);n.objObj.array.splice(e-1,0,i[0]),n.gallery.start(n.objObj.array),n.index1=e-1,n.fun("saveTime")}}if(3==this.idArr){var s=n.index1;if(s<n.objObj.array.length-1&&-1!=s){var a=n.objObj.array.splice(s,1);n.objObj.array.splice(s+1,0,a[0]),n.gallery.start(n.objObj.array),n.index1=s+1,n.fun("saveTime")}}},this.init=function(){this.window=new DWindow(this.dCont,0,0," "),this.window.hasMinimizeButton=!1,this.window.width=400,this.window.height=500,this.window.dragBool=!1;this.closeWin=new DButton(this.window,this.window.width-28-2,2,"X",function(){n.fun("closeWin")}),this.closeWin.width=this.closeWin.height=28,this.listJson=new DButton(this.window,this.window.width-62-2,2,"L",function(){n.fun("listJson",JSON.stringify({Obj:{active:!0,type:"null",array:[{param:"id",width:0,title:"id",value:" ",cmena:"DInput",bool:!1,num:0,str:" ",priority:0},{param:"icon",width:0,title:"icon",value:"null",cmena:"null",bool:!1,num:0,str:"null",priority:0},{param:"name",width:-1,title:"name",value:" ",cmena:"DInput",bool:!1,num:0,str:"null",priority:0},{param:"param",width:50,title:"null",value:"null",cmena:"null",priority:50,bool:!1,num:0,str:"null"}]},List:{active:!0,type:"null",array:[{param:"id",width:0,title:"id",value:" ",cmena:"null",bool:!1,num:0,str:"null",priority:0},{param:"icon",width:0,title:"null",value:"",cmena:"DImage",bool:!1,num:0,str:"null",priority:0},{param:"name",width:-1,title:"name",value:" ",cmena:"null",bool:!1,num:0,str:"null",priority:0},{param:"openCreat",width:50,title:"null",value:"iconId,group1,12",cmena:"DButton",bool:!1,num:0,str:"null"},{param:"openVisi",width:50,title:"null",value:"iconId,group1,11",cmena:"DButton",bool:!1,num:0,str:"null"},{param:"openThree",width:50,title:"null",value:"iconId,group1,13",cmena:"DButton",bool:!1,num:0,str:"null"},{param:"dragObj",width:50,title:"null",value:"iconId,group1,14",cmena:"DButton",bool:!1,num:0,str:"null"}]},Creat:{active:!1,type:"null",array:[]}}))}),this.listJson.width=this.listJson.height=28,this.creatJson=new DButton(this.window,this.window.width-93-2,2,"C",function(){n.fun("creatJson",JSON.stringify({Obj:{active:!0,type:"null",array:[{param:"param",width:200,title:"Товары продовца",value:"null",cmena:"null",bool:!1,num:0,str:"null"}]},List:{active:!1,type:"null",array:[]},Creat:{active:!0,type:"MCOBase",array:[{param:"name",width:100,title:"name",value:"null",cmena:"DInput",bool:!1,num:0,str:"null"},{param:"icon",width:100,title:"icon",value:"null",cmena:"DButton",bool:!0,num:0,str:"null"}]}}))}),this.creatJson.width=this.creatJson.height=28;var t,e=36+2*this.param.otstup;this.ch=new DCheckBox(this.window.content,this.param.otstup,e,"active",function(){n.objObj.active=this.value,n.fun("saveTime")}),this.ch.visible=!1,e+=36+this.param.otstup,this.comboBox=new DComboBox(this.window.content,this.param.otstup,e,["null","MCOBase","MCOProduct","MCOPlane","MCOG5","MCOProgMet","MCOUser","MCOWork","MCOProject"],function(){n.objObj.type=this.array[this.index],n.fun("saveTime")}),this.comboBox.width=this.window.width-4,e+=+this.param.otstup+36,this.w=new DWindow(this.window.content,0,e," "),this.w.width=this.window.width,this.w.dragBool=!1,this.w.hasMinimizeButton=!1;for(var i=0;i<4;i++)(t=new DButton(this.w,(this.param.otstup+28)*i+this.param.otstup,2," ",this.down)).idArr=i,0==i&&(t.text="+"),1==i&&(t.text="-"),2==i&&(t.text="<"),3==i&&(t.text=">"),t.width=28,t.height=28;this.gallery=new hn(this.w,this.param.otstup,36+this.param.otstup,function(t){n.index1=this.index}),this.gallery.width=this.w.width-2*this.param.otstup,this.gallery.height=52,this.gallery.kolII=5,this.gallery.widthPic=this.gallery.width/this.gallery.kolII,this.gallery.heightPic=24,this.mk1=new an(this,function(t,e,i){"dragParam"===t&&(n.gallery.array[n.index1].label.value=e),"saveTime"===t&&n.fun(t,e)},0,e+this.w.height),this.window.height=e+this.gallery.height};this.arrBut=[],this.objBase=void 0,this.setObj=function(t,e){e=["Obj","List","Creat"],this.objBase=t;for(var i=!1,s=0;s<e.length;s++)null==this.objBase[e[s]]&&(this.objBase[e[s]]=this.getBaseObj(),i=!0);1==i&&n.fun("saveTime");for(s=0;s<this.arrBut.length;s++)this.arrBut[s].visible=!1;for(s=0;s<e.length;s++)null==this.arrBut[s]&&(this.arrBut[s]=new DButton(this.window.content,this.param.otstup+s*(50+this.param.otstup),this.param.otstup,"",function(){n.index=this.idArr}),this.arrBut[s].idArr=s,this.arrBut[s].width=50),this.arrBut[s].visible=!0,this.arrBut[s].text=e[s],this.arrBut[s].obj=this.objBase[e[s]];n.index=0},this.objObj=void 0,this.setObjObj=function(t){this.objObj=t,this.ch.visible=!0,this.ch.value=this.objObj.active;for(var e=0;e<this.comboBox.array.length;e++)if(this.comboBox.array[e]==this.objObj.type){this.comboBox.index=e;break}n.gallery.start(n.objObj.array),n.index1=0},this.getBaseObj=function(){var t={active:!1,type:"null",array:[]};return t},this.getBaseObjObj=function(){var t={param:"param",width:50,title:"null",value:"null",cmena:"null",priority:50,bool:!1,num:0,str:"null"};return t},this.setParam=function(){this.window.x=this.param.otstup,this.window.y=4*this.param.otstup+this.param.wh,this.sizeWindow()},this.init(),this.sizeWindow=function(t,e,i){t&&(t,e,i)}}var e,i,n;return e=t,(i=[{key:"index",set:function(t){this._index=t;for(var e=0;e<this.arrBut.length;e++)this.arrBut[e].alpha=1,e==this._index&&(this.arrBut[e].alpha=.5,this.setObjObj(this.arrBut[e].obj))},get:function(){return this._index}},{key:"index1",set:function(t){this._index1=t,this.gallery.index=-1,this.gallery.array[this._index1]?(this.gallery.index=this._index1,this.mk1.setObj(this.gallery.array[this._index1].object)):this.mk1.setObj(void 0)},get:function(){return this._index1}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active)},get:function(){return this._active}}])&&rn(e.prototype,i),n&&rn(e,n),t}();function hn(t,e,i,n){DGallery.call(this,t,e,i,n);this.type="Gall33",this.createZamen=function(){return new ln(this.content,0,0,this.downBtn,this)}}function ln(t,e,i,n,s){DBox.call(this,t,e,i,n),this.type="BoxXZ";var a=this;this.par=s,this.label.fontSize=12,this.label.activMouse=!1,this.startLoad=function(t){this.object=t,this.label.text=t.param,this.label.visible=!0,a.funLoad(),null!=t.icon?(this.image.visible=!0,this.image.link==t.icon?a.funLoad&&a.funLoad():(this.image.width=100,this.image.height=100,this.image.link=t.icon)):this.image.visible=!1}}function un(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cn(t){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dn(t,e){return(dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fn(t){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}hn.prototype=Object.create(DGallery.prototype),hn.prototype.constructor=hn,Object.defineProperties(hn.prototype,{}),ln.prototype=Object.create(DBox.prototype),ln.prototype.constructor=ln;var gn=function t(e,i){mn(this,t),this.type="DTParam",this.fun=i,this.par=e;var n=this;this.param=e.param,this.dCont=new DCont,this.par.window.content.add(this.dCont),this.panel=new DPanel(this.dCont,2,2),this.panel.width=this.par.window.width-4,this.drag=function(){n.object.name=s[0].value,n.object.title=s[1].value,n.object.strB=s[2].value,n.object.color=r.value,o.color=r.value,n.object.key=s[7].value,n.object.id=1*s[8].value;for(var t=0;t<h.length;t++)n.object.arrText[t]=h[t].value;var e=JSON.parse(s[5].value);e&&"object"==fn(e)&&(n.object.obj=e),n.fun("saveTime")};var s=[],a=2;new DLabel(this.panel,2,a,"uuid"),s[3]=new DLabel(this.panel,72,a,"uuid",this.drag),s[3].width=this.panel.width,a+=18,new DLabel(this.panel,2,a,"key"),s[4]=new DLabel(this.panel,72,a,"key",this.drag),s[4].width=this.panel.width,s[7]=new DInput(this.panel,72,a,"key",this.drag),s[7].param="key",s[7].width=80,s[7].timeFun=0,s[8]=new DInput(this.panel,154,a,"id",this.drag),s[8].param="id",s[8].width=50,s[8].timeFun=0,1==this.param.debug?(s[7].visible=!0,s[8].visible=!0,s[4].visible=!1):(s[7].visible=!1,s[8].visible=!1,s[4].visible=!0);var r=new DColor(this.panel,this.panel.width+4,a-2,"",this.drag);r.visible=!1;var o=new DButton(this.panel,this.panel.width-r.height-this.param.otstup,a,"",function(){r.visible=!r.visible});o.width=o.height=r.height,a+=r.height+this.param.otstup,new DLabel(this.panel,2,a+14,"name"),s[0]=new DInput(this.panel,72,a,"name",this.drag),s[0].param="name",s[0].width=this.panel.width-70-8,a+=34,new DLabel(this.panel,2,a+14,"title"),s[1]=new DInput(this.panel,72,a,"title",this.drag),s[1].param="str",s[1].width=this.panel.width-70-8,a+=34,new DLabel(this.panel,2,a+6,"strB"),s[2]=new bn(this.panel,72,a,"0101010",this.drag),s[2].param="strB",s[2].height=24,a+=34,new DLabel(this.panel,2,a+14,"arrText");for(var h=[],l=(this.panel.width-76)/4,u=0;u<4;u++)h[u]=new DInput(this.panel,72+u*l,a,"",this.drag),h[u].width=l-2;a+=34,new DLabel(this.panel,2,a+10,"obj"),s[5]=new DTextArea(this.panel,72,a,"{}",function(){n.drag(),n.menuConf.setObj(n.object.obj)}),s[5].param="obj",s[5].width=this.panel.width-70-6,s[5].height=58,s[5].fontSize=10,this.menuConf=new on(this,function(t,e){"saveTime"==t&&(n.object.obj=this.objBase,s[5].value=JSON.stringify(n.object.obj),n.drag()),"closeWin"==t&&(s[6].value=!1,this.active=!1),"creatJson"==t&&(s[5].value=e,n.drag(),n.menuConf.setObj(n.object.obj)),"listJson"==t&&(s[5].value=e,n.drag(),n.menuConf.setObj(n.object.obj))}),this.menuConf.dCont.x=this.panel.width+this.param.otstup,this.menuConf.dCont.y=0,this.menuConf.active=!1,s[6]=new DCheckBox(this.panel,2,a+32," ",function(t,e){n.menuConf.active=this.value,1==this.value&&(s[5].value=JSON.stringify(n.object.obj)),1==this.value&&n.menuConf.setObj(n.object.obj)}),a+=60,this.panel.height=a,this.object,this.setObj=function(t){var e=!1;this.object=t,null==this.object.name&&(this.object.name="name"+Math.round(100*Math.random()),e=!0),null==this.object.title&&(this.object.title="title"+Math.round(100*Math.random()),e=!0),null==this.object.arrText&&(this.object.arrText=[],this.object.arrText[0]="MCOBase",this.object.arrText[1]="Редактирование текстур",this.object.arrText[2]="id,icon,name,up,button1",this.object.arrText[3]="id,icon,name,up,button1,button2",e=!0),null==this.object.strB&&(this.object.strB="0101010",e=!0),null==this.object.uuid&&(this.object.uuid=this.generateRendom(2),e=!0),null==this.object.obj&&(this.object.obj={},e=!0),1==e&&n.fun("saveTime"),s[0].value=this.object.name,s[1].value=this.object.title,s[2].value=this.object.strB,s[3].value=this.object.uuid,s[4].value=this.object.key+" / "+this.object.id,s[7].value=this.object.key,s[8].value=this.object.id,trace("this.object",this.object),o.color=r.value=this.object.color||dcmParam.color,r.value!=dcmParam.color&&null!=r.value?r.visible=!0:r.visible=!1;for(var i=0;i<h.length;i++)h[i].value=this.object.arrText[i];s[5].value=JSON.stringify(this.object.obj),1==s[6].value&&this.menuConf.setObj(this.object.obj)},this.generateRendom=function(t){null==t&&(t=2);for(var e,i="",n="",s=0;s<t;s++){if((n=(255&(e=4294967295*Math.random()|0)).toString(16)+(e>>8&255).toString(16)+(e>>16&255).toString(16)+(e>>24&255).toString(16)).length<8)for(var a=0;a<8-n.length+1;a++)n+="Z";i+=n,s!=t-1&&(i+="-")}return i}},bn=function(t){function e(t,i,n,s,a){var r;mn(this,e),(r=function(t,e){return!e||"object"!==fn(e)&&"function"!=typeof e?pn(t):e}(this,cn(e).call(this))).type="DStrBool",r.dcmParam=dcmParam,r.fun=a;var o=pn(pn(r));return r.x=i||0,r.y=n||0,null!=t&&null!=t.add&&t.add(pn(pn(r))),r._width=0,r._height=32,r.array=[],r.sob=function(){for(var t="",e=0;e<o.array.length&&0!=o.array[e].visible;e++)o.array[e].value?t+="1":t+="0";o._value=t,o.fun&&o.fun()},r.drag=function(){for(var t=0;t<this.array.length;t++)this.array[t].visible=!1;for(t=0;t<this._value.length;t++)null==this.array[t]&&(this.array[t]=new DCheckBox(this,0,0,"",this.sob),this.array[t].label.visible=!1),this.array[t].visible=!0,0==this._value[t]?this.array[t].value=!1:this.array[t].value=!0;this.drag1()},r.drag1=function(){for(var t=0,e=this._height+1,i=0;i<this.array.length&&0!=this.array[i].visible;i++)this.array[i].width=this._height,this.array[i].height=this._height,this.array[i].x=t,t+=this._height+1,e+=this._height+1;this._width=e},r.value=s,r}var i,n,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dn(t,e)}(e,DCont),i=e,(n=[{key:"x",set:function(t){this.position.x=t},get:function(){return this.position.x}},{key:"y",set:function(t){this.position.y=t},get:function(){return this.position.y}},{key:"value",set:function(t){this._value!=t&&(this._value=t+"",this.drag())},get:function(){return this._value}},{key:"width",set:function(t){this._width!=t&&(this._width=t)},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.drag1())},get:function(){return this._height}}])&&un(i.prototype,n),s&&un(i,s),e}();function vn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var xn=function(){function t(e,i){vn(this,t),this.type="MenuThree",this.fun=i,this.par=e;var n=this;this.param=e.param,this.dCont=new DCont(e.dCont),this._active=!1,this.dCont.visible=this._active;this.init=function(){this.window=new DWindow(this.dCont,0,0," "),this.window.hasMinimizeButton=!1,this.window.width=250,this.window.height=650,this.dtParam=new gn(this,function(t,e,i){"saveTime"==t&&n.saveTime()}),this.mThree=new $i(this,function(t,e,i){"saveTime"==t&&n.saveTime(),"open"==t&&(n.dtParam.setObj(e),n.poisk(e))}),this.mThree.height=200,this.mThree.w.y=this.dtParam.panel.height+4+32,this.three=new DThree(this.window.content,2,this.mThree.height+this.mThree.w.y-30-2,function(t){n.mThree.openUUID(t.obj.uuid,!0)}),this.three.width=this.window.width-4,this.three.height=this.window.height-4-this.three.y-28,1==this.param.debug&&(new DButton(this.window,-150,0,"неТрогать!!!!",function(){this.visible=!1,new _n(n)}).width=150)},this.poisk=function(t){},this.poisk=function(t){},this.poiskTT=function(){},this.id=void 0,this.key=void 0,this.object=void 0,this.set=function(t,e){this.id=t,this.key=e,this.window.title=this.key+"::"+this.id,$.ajax({type:"GET",url:this.param.server+this.key+"/"+this.id+"/",success:function(t){if("string"==typeof t.json){var e=JSON.parse(t.json);n.object=e}else n.object=t.json;null==n.object&&(n.object={}),null==n.object.three&&(n.object.three={}),n.active=!0,n.start()}})},this.save=function(){var t={type:"PUT",url:this.param.server+this.key+"/"+this.id+"/",data:{json:JSON.stringify(this.object)},success:function(t){},error:function(t){console.error("не верная загрузка xz")}};t.headers={Authorization:"Token "+mhbd.token},$.ajax(t),this.three.setObj(this.object.three,"array","name")},this.sah=0,this.saveTime=function(){this.sah++;var t=this.sah;setTimeout(function(){n.sah==t&&n.save()},500)},this.start=function(){this.mThree.startObj(n.object.three),this.three.setObj(this.object.three,"array","name")},this.setParam=function(){this.window.x=this.param.otstup,this.window.y=4*this.param.otstup+this.param.wh,this.window.y=350,this.sizeWindow()},this.init(),this.sizeWindow=function(t,e,i){t&&(t,e,i)}}var e,i,n;return e=t,(i=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=this._active)},get:function(){return this._active}}])&&yn(e.prototype,i),n&&yn(e,n),t}(),_n=function t(e){vn(this,t);var i=this;this.data,this.object,this.init=function(){for(var t=0;t<this.data.length;t++)this.data[t].children="",this.data[t].parent=-1;this.setOOO(this.object.three.array[0],-2);for(t=0;t<this.data.length;t++)mhbd.setParam("group",this.data[t].id,"parent",this.data[t].parent),mhbd.setParam("group",this.data[t].id,"children",this.data[t].children)},this.setOOO=function(t,e){var i=this.getIdGroup(t.id);i.parent=e;for(var n="",s=0;s<t.array.length;s++)this.setOOO(t.array[s],i.id),n+=0==s?""+t.array[s].id:","+t.array[s].id;i.children=n},this.getIdGroup=function(t){for(var e=0;e<this.data.length;e++)if(this.data[e].id==t)return this.data[e];return null},mhbd.getKeyList("group",function(t){i.data=t,i.object=e.object,i.init()})};function wn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var An=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="accountManager",this.fun=i,this.par=e;var n,s,a,r,o,h,l=this;this.param=e.param,this.otstup=this.param.otstup,this.dCont=new DCont(e.dCont),this._width=300,this._height=400,this.heightButton=40,this.arr=void 0,this.arrButton=void 0,this.arrButton2=void 0,this.panel=void 0,this.linkKaleido="https://kaleidoplan.ru/",this.color="#ffffff",this.fontSize=14,this.arrXZ=[],this.arrXZ.push({key:"help",id:0,name:"Помощь"}),this.arrXZ.push({key:"partners",id:1,name:"Партнерам"}),this.init=function(){if(null==this.panel){this.panelGlow=new DGlow(this.dCont),this.panelGlow.width=this._width,this.panelGlow.height=this._height,this.panelGlow.glowSah=5,this.panelGlow.alpha=.25,this.panelGlow.reDrag(),this.panelGlow.borderRadius=3,this.panel=new DPanel(this.dCont),this.panel.width=this._width,this.panel.height=this._height,this.panel.borderRadius=3,this.panel.boolLine=!1,n=this.otstup,s=2*this.otstup,this.label=new DLabel(this.panel.content,n,s,"Учетная запись"),this.label.width=this.width-2*this.otstup,this.label.textAlign="center",this.label.color="#000000",this.label.fontSize=this.fontSize,s+=this.label.fontSize+2*this.otstup,s+=this.otstup,this.panelDividing=this.generatePanelDivi(),s+=this.panelDividing.height+2*this.otstup,this.arrButton=[];for(var t=0;t<this.arr.length;t++)this.arrButton.push(l.generateButA(l.arr[t].title,l.arr[t],function(){l.fun("openLeftField",this.objXZ.name)})),s+=this.heightButton;s+=2*this.otstup,this.panelDividing1=this.generatePanelDivi(),s+=this.panelDividing1.height+2*this.otstup,this.arrButton1=[];for(t=0;t<this.arrXZ.length;t++)this.arrButton1.push(l.generateButA(l.arrXZ[t].name,l.arrXZ[t],function(){window.open(l.linkKaleido+this.objXZ.key)})),s+=this.heightButton;s+=2*this.otstup,this.panelDividing2=this.generatePanelDivi(),s+=this.panelDividing2.height+2*this.otstup,this.exitButton=l.generateButA("Выйти",void 0,function(){l.fun("exitProfile")}),s+=this.exitButton.height+2*this.otstup,this.panel.height=s,this.panelGlow.height=s,this.sizeWindow()}},this.mouseDown=function(t){var e=l.panel.div.getBoundingClientRect();(t.clientX<=e.x||t.clientX>=e.x+l.panel.width+2||t.clientY<=e.y||t.clientY>=e.y+l.panel.height+2)&&(l.active=!1)},this.generateButA=function(t,e,i){return(a=new DButton(this.panel.content,n,s,t,i)).objXZ=e,a.height=this.heightButton,a.width=this.width-2*this.otstup,a.textAlign="left",a.colorText=this.label.color,a.color=this.color,a.glowColor=this.color,a.borderRadius=3,a.fontSize=this.fontSize,a.boolLine=!1,a},this.generatePanelDivi=function(){return(r=new DPanel(this.panel.content,n,s)).width=this.width-2*this.otstup,r.height=.1,r.glowSah=.25,r.alpha=.13,r.color="#091e42",r.booline=!1,r.borderRadius=3,r},this.start=function(){this.init()},this.openArr=function(t){this.arr=t},this.sizeWindow=function(t,e,i){t&&(o=t,e,h=i),null!=this.panel&&(this.panel.x=o/h-this.width-this.otstup,this.panel.y=this.param.wh2+2*this.param.otstup+2*this.otstup,this.panelGlow.x=this.panel.x,this.panelGlow.y=this.panel.y+8)}}var e,i,n;return e=t,(i=[{key:"width",set:function(t){this._width!=t&&(this._width=t)},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t)},get:function(){return this._height}},{key:"active",set:function(t){this._active!=t&&(this._active=t,console.warn(">>>>>>>##>>",this._active),this.dCont.visible=this._active,1==t?document.addEventListener("mousedown",this.mouseDown):document.removeEventListener("mousedown",this.mouseDown))},get:function(){return this._active}}])&&wn(e.prototype,i),n&&wn(e,n),t}();function Tn(t,e){this.fun=t;var i,n=this;this.object,this.key=e||"shirt",this.object,this.initLoad=function(){i=!0,this.object=window.localStorage[this.key],"undefined"==this.object&&(i=!1),null==this.object&&(i=!1),this.object=0==i?this.getStartObj():jQuery.parseJSON(this.object),this.fun&&n.fun()},this.getStartObj=function(){return{activ:!1,dubag:!1,menu:{},xz:{}}},this.save=function(){window.localStorage[this.key]=JSON.stringify(n.object)},this.clear=function(){window.localStorage[this.key]=void 0},n.initLoad()}var Pn=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="ViewServer";var i=this;function n(t,e){var i=window.document.URL.toString();e&&(i=e);var n=i.split("/");if(console.warn(t,">>>>>>>",n),i.indexOf("?")>0){var s=(n=i.split("?"))[1].split("&"),a=new Array(s.length),r=new Array(s.length);s=(n=i.split("?"))[1].split("&"),a=new Array(s.length),r=new Array(s.length);var o=0;for(o=0;o<s.length;o++){var h=s[o].split("=");a[o]=h[0],""!=h[1]?r[o]=unescape(h[1]):r[o]=null}for(o=0;o<s.length;o++)if(a[o]==t)return r[o];return null}return null}this.fun=e,this.param=mhbd.param,this.id=void 0,this.openId=function(t){this.id=t,console.warn("this.openId  ",this.id),mhbd.getKeyId("group2",this.id,function(e){mhbd.param.parentId=t,null!=e.json?i.fun("setObj",e.json):i.fun("setObj",null);var n=e.popularity+1;mhbd.setParam("group2",e.id,"popularity",n)})},this.saveGetObjId=function(t){if(null!=this.id){var e={url:"https://alphakp.ru/catalog/plan/"+this.id+"/edit_scheme/set_scheme",type:"POST",data:{json:JSON.stringify(t)},cache:!1,async:!1,success:function(t){i.fun("message","Проект сохронен","Проект сохронен на сервере.",500)},error:function(t){i.fun("message","Error","Чо то не грузит линк")}};$.ajax(e)}else i.fun("message","Error Проект не имеет ИД","Этот проект не открыт, в плане не имеет связи с сервером")},this.openURL=function(t){var e=n("id",t),s=n("veiwType",t),a=n("token",t);if(null!=s&&i.fun("veiwType",1*s),null!=a){i.fun("token",a);var r={url:"https://alphakp.ru/api/v1/auth/users/me/",success:function(t){i.fun("uzer",t)},headers:{Authorization:"Token "+a}};$.ajax(r)}null!=e?this.openId(e):i.fun("openStart")}};function En(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Cn=function(){function t(e){En(this,t),this.type="Languages";this._key=e[0].key,this.array=[],this.arrayC=[],this.setCompObj=function(t,e,i){this.array.push(new jn(t,e,i)),this.dragDB(this.array[this.array.length-1])},this.dragDB=function(t){t.setKey(this._key)},this.setClass=function(t){this.arrayC.push(t),t.languages=this._key}}var e,i,n;return e=t,(i=[{key:"key",set:function(t){if(this._key!=t){this._key=t;for(var e=0;e<this.array.length;e++)this.dragDB(this.array[e]);for(e=0;e<this.arrayC.length;e++)this.array[e].languages=this._key}},get:function(){return this._key}}])&&Sn(e.prototype,i),n&&Sn(e,n),t}(),jn=function t(e,i,n){En(this,t),this.type="DBLeng";this.comp=e,this.obj=i,this.type=n||"value";var s="";this.setKey=function(t){s="null",i&&i.texts&&i.texts[t]&&(s=i.texts[t]),e[n]=s}};i.d(e,"a",function(){return Dn});var Dn=function t(e,i,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Main",this.fun=a,this.token=i;var r=this;window.dcmParam=new DCM,this._bool=!0,this._bool1=!1,this._bool2=!1,this.param={},this.param.wh=32,this.param.wh2=48,this.param.otstup=5,this.param.wb=150,this.param.mobile=!1,this.param.whb=32,this.param.whCr=840,this.param.otMy=26,this.param.sizeBase=180,this.param.color="#c60f30",this.param.colorFont="#ffffff",this.param.color1="#999999",this.param.sizeBase2=250,this.param.bRadius=24,this.param.maxW=350,this.param.maxH=350,this.param.debug=!1,this.param.logo="null",this.param.link="null",this.param.server="https://alphakp.ru/api/v1/",this.param.serverNa="https://alphakp.ru/www/",this.param.typeUzer="threeAdminDev",this.param.vers="1.001",this.param.debug=!0,this.param.vers="p20All:1.06",this.param.langs=["ru","en"],window.languages=new Cn(this.param.langs);var o=i.split(" ");i=o[o.length-1];var h=[];this.korectColor=void 0,this.dCont=new DCont(e),this.dContVerh=new DCont,this.init=function(){this.param.mobile=dcmParam.mobile,dcmParam.fontFamily="Montserrat";(this.localStorage=new Tn(null,"localStorage"),null==r.localStorage.object.debug&&(r.localStorage.object.debug=!1),this.param.debug=r.localStorage.object.debug,window.mhbd=new Ki(this),mhbd.debug=this.param.debug,window.dragPic=new kn(this.dContVerh),h[h.length]=this.menuVerh=new n(this,function(t,e){"openAccM"==t&&(r.accManager.start(),r.accManager.active=!r.accManager.active)}),h[h.length]=this.menuLeft=new s(this,function(t,e,i){"sobThree"==t&&r.menuCent.setSob(e),"openArr"==t&&(r.menuCent.openArr(e),r.accManager.openArr(e)),trace("MenuLeft",t,e,i)}),h[h.length]=this.menuCent=new Yi(this,function(t,e,i){"openThree"==t&&r.menuThree.set(e,i),"openLeftField"==t&&r.menuLeft.openField(e),trace("MenuCent",t,e,i)}),h[h.length]=this.menuThree=new xn(this,function(t,e){}),h[h.length]=this.mSupCr=new wi(this.dCont),h[h.length]=this.sVerhu=new xn(this,function(t,e){}),h[h.length]=this.accManager=new An(this,function(t,e){"openLeftField"==t&&r.menuLeft.openField(e),"exitProfile"==t&&(localStorage.removeItem("credentials"),document.location.href="/login/")}),this.viewServer=new Pn(function(t,e){if("token"==t&&(mhbd.token=e),"uzer"==t){mhbd.uzer=e;var i=!0;trace(mhbd.uzer,"2222222");for(var n=0;n<mhbd.uzer.userSort.length;n++)4==mhbd.uzer.userSort[n]&&(i=!1);1==i&&(mhbd.plusLinkKey="/me"),trace(i,mhbd.plusLinkKey,mhbd.uzer.userSort,"2222222"),r.menuVerh.init(),r.init2()}}),1==this.param.debug)&&(new DCheckBox(this.dCont,333,20,"vers="+this.param.vers,function(){r.localStorage.object.debug=this.value,r.localStorage.save(),location.href=location.href}).value=this.param.debug);var t="http://localhost:8080/adminAll.html?token="+i;this.viewServer.openURL(t)},this.as3d,this.init2=function(){var t={};t.url=this.param.server+"scenes3d/",t.type="GET",t.success=function(t){trace("data",t),r.as3d=t.results,r.init3()},$.ajax(t)},this.init3=function(){trace(this.as3d,mhbd.uzer);for(var t=0;t<this.as3d.length;t++)if(this.as3d[t].name==r.param.typeUzer)return void r.startObj(this.as3d[t].json)},this.boolCTRL=!1,this.keydown=function(t){17==event.keyCode&&(r.boolCTRL=!0),81==event.keyCode&&r.boolCTRL&&(r.localStorage.object.debug=!r.debug,r.localStorage.save(),location.href=location.href)},this.keyup=function(t){17==event.keyCode&&(r.boolCTRL=!1)},window.addEventListener("keydown",r.keydown),window.addEventListener("keyup",r.keyup),this.startObj=function(t){this.menuLeft.startObj(t),this.dCont.add(this.dContVerh),this.setParam()},this.setParam=function(){for(var t=0;t<h.length;t++)h[t].setParam&&h[t].setParam();this.sizeWindow()},this.tick=function(){TWEEN.update(),requestAnimationFrame(r.tick)},this.tick();var l=1,u=this.maxW,c=this.maxH;this.sizeWindow=function(t,e){t&&(u=t,c=e),(l=u/100)>c/100&&(l=c/100),l>1&&(l=1),this.dCont.scale=l;for(var i=0;i<h.length;i++)h[i].sizeWindow&&h[i].sizeWindow(u,c,l);this.mSupCr.sizeWindow(u,c,l)},this.init()};function kn(t){var e=this;this.type="DragPic",this.fun=void 0,this.dC=t,this._width=100,this._height=100,this._active=!1,this.otstup=2,this.otstup2=10,this.dCont=new DCont,this.fUp=void 0,this.object=void 0,this._x=0,this._y=0,this.image=new DImage(this.dCont,0,0),this.image.div.style.pointerEvents="none",this.dCont.div.style.pointerEvents="none",this.array=[],this.tween=new TWEEN.Tween(this.dCont);var i=void 0;this.scal=1,this.scale=1,this.whBase=null,this.isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return e.isMobile.Android()||e.isMobile.BlackBerry()||e.isMobile.iOS()||e.isMobile.Opera()||e.isMobile.Windows()}},this.devas=this.isMobile.any(),null==this.devas?this.devas=!1:this.devas=!0,this.start=function(t,e,n,s,a){null!=this.whBase&&(t=this.whBase),this.image.link=e+"?"+Math.random(),this.image.width=t,this.image.height=t,this.image.x=-t/2,this.image.y=-t/2,this.fUp=s,i=void 0,1==a?this.scal=1:(this.dCont.alpha=0,this.tween.to({alpha:1},500).start()),this.object=n,this.link=e,this.active=!0;for(var r=0;r<this.array.length;r++)this.array[r].start()},this.stop=function(){if(e.active=!1,null!=i)for(var t=0;t<e.array.length;t++)e.array[t].testRect(e._x,e._y);i=void 0},this.arrFunUp=[],this.addFunAp=function(t){this.arrFunUp.push(t)},this.mouseup=function(t){e.stop(),e.fUp&&e.fUp();for(var i=0;i<e.arrFunUp.length;i++)e.arrFunUp[i]()},this.mousemove=function(t){(1==e.active2&&e.mousemove1(t),0!=e._active)&&(null==i&&(i=0==e.devas?{x:t.clientX/e.scale,y:t.clientY/e.scale}:{x:t.touches[0].clientX/e.scale,y:t.touches[0].clientY/e.scale}),0==e.devas?(e._x=t.clientX/e.scale,e._y=t.clientY/e.scale):(e._x=t.touches[0].clientX/e.scale,e._y=t.touches[0].clientY/e.scale),e.dCont.x=e._x,e.dCont.y=e._y)},this.addDCont=function(t,e){this.array.push(new Ln(this,t,e,this.array.length))},this.mouseup1=function(t){e.mouseStop(),null!=e.fClik&&e.fClik()},this.mousemove1=function(t){var n,s;null==i&&(i=0==e.devas?{x:t.clientX,y:t.clientY}:{x:t.touches[0].clientX,y:t.touches[0].clientY}),0==e.devas?(n=t.clientX-i.x,s=t.clientY-i.y):(n=t.touches[0].clientX-i.x,s=t.touches[0].clientY-i.y),(Math.abs(n>e.dist)||Math.abs(s>e.dist))&&(e.mouseStop(),null!=e.fDrag&&e.fDrag())},this.mouseStop=function(){i=void 0,e.active2=!1,0==e.devas?document.removeEventListener("mouseup",e.mouseup1):document.removeEventListener("touchend",e.mouseup1)},this.active2=!1,this.dist=0,this.fClik=0,this.fDrag=0,this.testDrag=function(t,n,s){i=void 0,this.dist=t,this.fClik=n,this.fDrag=s,this.active2=!0,0==this.devas?document.addEventListener("mouseup",e.mouseup1):document.addEventListener("touchend",e.mouseup1)},0==this.devas?window.addEventListener("mousemove",this.mousemove):window.addEventListener("touchmove",this.mousemove),Object.defineProperty(this,"active",{set:function(t){this._active!=t&&(this._active=t,1==t?(this.dCont.scale=this.scal,this.dCont.alpha=this.scal,this.dC.add(this.dCont),0==this.devas?document.addEventListener("mouseup",this.mouseup):document.addEventListener("touchend",this.mouseup)):(this.dC.remove(this.dCont),0==this.devas?document.removeEventListener("mouseup",this.mouseup):document.removeEventListener("touchend",this.mouseup)))},get:function(){return this._active}})}function Ln(t,e,i,n){var s=this;this.type="BoxDragPic",this.fun=void 0,this.dCont=e,this.fun=i,this.idArr=n,this.panel=new DPanel(null,0,0),this.tween=new TWEEN.Tween(this.panel),this.tween.onComplete(function(){s.dCont.remove(s.panel)}),this.start=function(){0!=this.visibleTest(this.dCont)&&(this.dCont.add(this.panel),this.panel.width=this.dCont.width,this.panel.height=this.dCont.height,this.panel.alpha=.5,this.tween.stop(),this.tween.to({alpha:0},500).start())};var a={x:0,y:0};this.testRect=function(e,i){0!=this.visibleTest(this.dCont)&&(a.x=0,a.y=0,this.getXY(this.dCont,a),e>a.x&&e<a.x+this.dCont.width&&i>a.y&&i<a.y+this.dCont.height&&s.fun(t.object,t.link))},this.getXY=function(t,e){if(a.x+=t.x,a.y+=t.y,null!=t.parent)return this.getXY(t.parent,a)},this.visibleTest=function(t){return 0!=t.visible&&(null!=t.parent?this.visibleTest(t.parent):null!=t.htmlBody)}}},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(0);function s(){var t,e=this;this.type="CubeMap",this.LINK="null",this.EXPOSURE=-1,this.GAMMA=-1,this._link="nullXZ",this._exposure=this.EXPOSURE,this._gamma=this.GAMMA,this.exposureStart=-1,this.gammaStart=-1,this._activDiz=!1,this._layer=1,this.otherLayer=31,this.renderer=void 0,this.scene=void 0,this.cubeCamera=new THREE.CubeCamera(1,1e4,512),this.geometry=new THREE.SphereBufferGeometry(1500,32,32),this.mesh=new THREE.Mesh(this.geometry),this.loader=void 0,this.loader=new n.a,this.init=function(t,e){void 0!==t&&void 0!==e&&(this.renderer=t,this.scene=e,this.scene.add(this.cubeCamera),this.scene.add(this.mesh),this.link="null")},this.setLayers=function(t){e.mesh.layers.set(t),e.cubeCamera.layers.set(t),e.cubeCamera.traverse(function(e){e.layers.set(t)})},this.upDate=function(t){this.setLayers(this.otherLayer),this.cubeCamera.update(t||this.renderer,this.scene),this.setLayers(this._layer)},this.material=void 0,this.dragMaterial=function(t){this.material=t,i==t.sahMin&&(this.mesh.material=t,this.upDate())},this.arrMat=[],this.testBD=function(t){for(var e=0;e<this.arrMat.length;e++)if(this.arrMat[e].linkMy==t)return this.arrMat[e];return null};var i=0;this.loadFun=function(){var n=++i,a=this._link+"";null!=(t=this.testBD(this._link))&&(t.sahMin=i,this.dragMaterial(t)),"null"!=this._link&&null!=this._link&&(-1==this._link.indexOf(".png")&&-1==this._link.indexOf(".jpg")&&-1==this._link.indexOf(".jpeg")?null!=this.loader?this.loader.load(this._link,function(t,i){var r=new THREE.ShaderMaterial({uniforms:{tDiffuse:{type:"t",value:t},exposure:{type:"f",value:i.exposure},gamma:{type:"f",value:i.gamma},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)}},vertexShader:s.vertex,fragmentShader:s.fragment});t.minFilter=THREE.LinearFilter,t.magFilter=THREE.NearestFilter,t.flipY=!0,t.wrapS=t.wrapT=THREE.RepeatWrapping,t.anisotropy=e.renderer.capabilities.getMaxAnisotropy(),r.side=THREE.BackSide,r.linkMy=a,r.sahMin=n,e.arrMat.push(r),e.dragMaterial(r),e.exposureStart=i.exposure,e.gammaStart=i.gamma,1==e._activDiz&&(e._exposure=i.exposure,e._gamma=i.gamma)}):console.log("Подключи в загрущик RGBELoader токо если надо hdr загрузить!!!"):(new THREE.TextureLoader).load(this._link,function(t){t.minFilter=THREE.LinearFilter,t.magFilter=THREE.NearestFilter,t.flipY=!0,t.wrapS=t.wrapT=THREE.RepeatWrapping,t.anisotropy=e.renderer.capabilities.getMaxAnisotropy();var i=new THREE.MeshBasicMaterial({map:t,side:THREE.BackSide});i.linkMy=a,i.sahMin=n,e.arrMat.push(i),e.dragMaterial(i)}))},this.getTexture=function(){return this.cubeCamera.renderTarget.texture};var s={vertex:["uniform vec4 offsetRepeat;","varying vec2 vUv;","void main() {","    // vUv  = uv;","    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 3);","}"].join("\n"),fragment:["uniform sampler2D   tDiffuse;","uniform float       exposure;","uniform float       gamma;","varying vec2  vUv;","vec3 decode_pnghdr( const in vec4 color ) {","    vec4 rgbcolor = vec4( 0.0, 0.0, 0.0, 0.0 );","    if ( color.w > 0.0 ) {","        float f = pow(2.0, 127.0*(color.w-0.5));","        rgbcolor.xyz = color.xyz * f;","    }","    return rgbcolor.xyz;","    /*","    // remove gamma correction","    vec4 res = color * color;","    // decoded RI","    float ri = pow( 2.0, res.w * 32.0 - 16.0 );","    // decoded HDR pixel","    res.xyz = res.xyz * ri;","    return res.xyz;","    */","}","void main() {","    vec4 color = texture2D( tDiffuse, vUv );","    color.xyz  = decode_pnghdr( color );","    // apply gamma correction and exposure","    //gl_FragColor = vec4( pow( exposure * color.xyz, vec3( 0.474 ) ), 1.0 );","    // Perform tone-mapping","    float Y = dot(vec4(0.30, 0.59, 0.11, 0.0), color);","    float YD = exposure * (exposure/gamma + 1.0) / (exposure + 1.0);","    color *= YD;","    gl_FragColor = vec4( color.xyz, 1.0 );","}"].join("\n")};this.debug=!1}Object.defineProperties(s.prototype,{link:{set:function(t){this._link!=t&&(this._link=t,this.loadFun())},get:function(){return this._link}},activDiz:{set:function(t){this._activDiz!=t&&(this._activDiz=t)},get:function(){return this._activDiz}},exposure:{set:function(t){this._exposure!=t&&(this._exposure=t,this.material&&null!=this.material.uniforms&&(this.material.uniforms.exposure.value=t,this.upDate()))},get:function(){return this._exposure}},gamma:{set:function(t){this._gamma!=t&&(this._gamma=t,this.material&&null!=this.material.uniforms&&(this.material.uniforms.gamma.value=t,this.upDate()))},get:function(){return this._gamma}},debug:{set:function(t){this._debug!=t&&(this._debug=t,this._layer=t?0:31,this.setLayers(this._layer))},get:function(){return this._debug}}})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return MVisi3D});var _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4),_MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8),_MUtility_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7),_CubeMap_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2);function MVisi3D(_contentHTML,_content2d,_devas,_directional,_efect,_event3DArr,_alpha){var self=this;this.contentHTML=_contentHTML,_devas=void 0!==_devas&&_devas,_directional=void 0===_directional||_directional,_efect=void 0===_efect||_efect,_event3DArr=void 0===_event3DArr||_event3DArr,_alpha=void 0!==_alpha&&_alpha,this.intRend=0,this.devas=_devas,this.alpha=_alpha,this.arrSetiScene=[],this._xVerh=0,this._yVerh=0,this._zVerh=0,this._rotationX=0,this._rotationZ=0,this._zume=1e3,this._arrOut=[],this._x=0,this._y=0,this._height=100,this._width=100,this.yes3d=!0,this.intRendOk=1,this._visible=!0,this._isDragPan=!1,this._activMouse=!0,this._staticShadow=!1,this._fov=45,this.alwaysRender=!1,this.AMBIEN_COLOR="#ffffff",this.AMBIEN_INTENSITY=.79,this.LIGHT_COLOR="#ffffff",this.LIGHT_BIAS=.001,this.SHADOW_INTENSITY=.22,this.SHADOW_RADIUS=1,this.SHADOW_WH=4096,this.DISTANCE=0,this.CUB_HEIGHT=500,this.CUB_WIDTH=500,this.FOV=45,this.FAR=45e3,this._fov=this.FOV,this.content=void 0,this.graphics=void 0,this.fun_sob=void 0,null!=_content2d&&(this.content=eval("new PIXI.Container()"),this.graphics=eval("new PIXI.Graphics()"),_content2d.addChild(this.content),this.content.addChild(this.graphics),this.graphics.interactive=!0),this.camera,this.scene=new THREE.Scene;var color=16777215;this.color=color,this.camera=new THREE.PerspectiveCamera(this.FOV,this._width/this._height,1,this.FAR),trace("%%%%%_alpha==",_alpha),this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:_alpha}),this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this._width,this._height),1==_alpha?this.renderer.setClearColor(color,0):this.renderer.setClearColor(color,1),this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.efect,this.efect=new _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__.a(this),_contentHTML.appendChild(this.renderer.domElement),this.renderer.domElement.style.zIndex=-10,this.event3DArr,1==_event3DArr&&(this.event3DArr=new _MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__.a(this,this.camera,_contentHTML),this.scene.event3DArr=this.event3DArr,this.event3DArr.addDragEvent(this.graphics,_contentHTML),this.event3DArr.activ=this._activMouse),this.camera.position.set(0,0,-60),this.camera.rotation.set(Math.PI,0,0),this.renderer.domElement.style.position="fixed",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.group=new THREE.Object3D,this.group.rotation.x=Math.PI/2,this.scene.add(this.group),this.group1=new THREE.Object3D,this.group.add(this.group1),this.group2=new THREE.Object3D,this.group1.add(this.group2),this.groupObject=new THREE.Object3D,this.group2.add(this.groupObject),this.group3d=new THREE.Object3D,this.groupObject.add(this.group3d),this.gp=new THREE.Object3D,this.gp.rotation.x=Math.PI/2,this.scene.add(this.gp),this.gp1=new THREE.Object3D,this.gp.add(this.gp1),this.gp2=new THREE.Object3D,this.gp1.add(this.gp2),this.gpObject=new THREE.Object3D,this.gp2.add(this.gpObject),this.gpObject2=new THREE.Object3D,this.gp2.add(this.gpObject2),this.gpObject.position.z=1,this.gpObject.scale.set(.001,.001,.001),this.gpObject2.position.z=1,this.gpObject2.scale.set(.001,.001,.001),this.gCGG=new THREE.Object3D,this.group.add(this.gCGG),this.gCAngel=new THREE.Object3D,this.gCGG.add(this.gCAngel),this.gCam1=new THREE.Object3D,this.gCAngel.add(this.gCam1),this.gCam2=new THREE.Object3D,this.gCam1.add(this.gCam2),this.ggCam=new THREE.Object3D,this.gCam2.add(this.ggCam),this.ggCam.add(this.camera),this.ggCam.position.z=-this._zume,this.camera.position.z=0,this.axesHelper=new THREE.AxesHelper(100),this.scene.add(this.axesHelper),this.axesHelper.visible=!1,this.arrPoint=[];var disLig=4e3,powerLig=.4,dis=1e4,bbbbbb;if(this.sunLight,this.ambientLight=new THREE.AmbientLight(this.AMBIEN_COLOR,this.AMBIEN_INTENSITY),this.scene.add(this.ambientLight),this.ambientLight.castShadow=!1,1==_directional){var sunIntensity=this.SHADOW_INTENSITY;this.sunLight=new THREE.DirectionalLight(this.LIGHT_COLOR,sunIntensity,0,0,.2),this.sunLight.position.set(0,this.DISTANCE+2*this.CUB_HEIGHT,0),this.sunLight.castShadow=!0,this.sunLight.shadow.camera.near=this.CUB_HEIGHT,this.sunLight.shadow.camera.far=this.CUB_HEIGHT+2*this.CUB_HEIGHT,this.sunLight.shadow.camera.right=this.CUB_WIDTH,this.sunLight.shadow.camera.left=-this.CUB_WIDTH,this.sunLight.shadow.camera.top=this.CUB_WIDTH,this.sunLight.shadow.camera.bottom=-this.CUB_WIDTH,this.sunLight.shadow.mapSize.width=this.SHADOW_WH,this.sunLight.shadow.mapSize.height=this.SHADOW_WH,this.sunLight.shadow.bias=this.LIGHT_BIAS,this.sunLight.shadow.radius=this.SHADOW_RADIUS}this.initOut=function(){},this.position3d=new _MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__.a(self,this.graphics,this.renderer.domElement),this.utility=new _MUtility_js__WEBPACK_IMPORTED_MODULE_3__.a(self),this.arrayDoRender=[],this.arrayDoRender2=[],this.shadowNeedsUpdate=!1,this.render=function(){if(0!=this.yes3d){if(0!=this.arrayDoRender2.length)for(var t=0;t<this.arrayDoRender2.length;t++)this.arrayDoRender2[t]();if(this.utility.render(),this.intRend=10,this.shadowNeedsUpdate&&(this.shadowNeedsUpdate=!1,this.renderer.shadowMap.needsUpdate=!0),this.efect?0==this.efect.render()&&this.renderer.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera),0!=this.arrayDoRender.length)for(t=0;t<this.arrayDoRender.length;t++)this.arrayDoRender[t]()}},this.upDate=function(){(this.alwaysRender||this.intRend==this.intRendOk)&&this.render(),this.intRend<10&&this.intRend++},this.renderer.render(this.scene,this.camera),this.sizeWindow=function(t,e,i,n){null!=t&&(this._x=t),null!=e&&(this._y=e),null!=n&&(this._height=n),null!=i&&(this._width=i),null!=this.content&&(this.content.x=this._x,this.content.y=this._y,this.graphics.clear(),this.graphics.beginFill(16711680,0),this.graphics.drawRect(0,0,this._width,this._height),this.graphics.endFill()),this.renderer.domElement.style.left=this._x+"px",this.renderer.domElement.style.top=this._y+"px",this.camera.aspect=this._width/this._height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this._width,this._height),this.intRend=1;var s=87e-5*this.camera.aspect;this.gpObject2.scale.set(s,87e-5,1),this.gpObject.scale.set(s/(this._width/1e3),87e-5/(this._height/1e3),1),this.event3DArr&&(this.event3DArr.sizeWindow(this._width,this._height),this.event3DArr.setRect(this._x,this._y,this._width,this._height)),this.efect&&this.efect.sizeWindow(this._width,this._height)},this.render(),this.sizeWindow(),this.objShadow=function(t,e){if(null==e&&(e=!0),bbbbbb=!0,t.material&&1==t.material.transparent&&t.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(t.castShadow=e,t.receiveShadow=e),null!=t.children)for(var i=0;i<t.children.length;i++)null!=t.children?this.objShadow(t.children[i],e):(bbbbbb=!0,t.children[i].material&&1==t.material.transparent&&t.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(t.children[i].castShadow=e,t.children[i].receiveShadow=e))},this.cubeMap=new _CubeMap_js__WEBPACK_IMPORTED_MODULE_4__.a,this.cubeMap.init(this.renderer,this.scene),this.getEnvMap=function(){return self.cubeMap.getTexture()},this.cubeMap1=new _CubeMap_js__WEBPACK_IMPORTED_MODULE_4__.a,this.cubeMap1.init(this.renderer,this.scene);var t=this.cubeMap1.getTexture();t.mapping=THREE.CubeRefractionMapping,this.cubeMap1.upDate(),this.getEnvMap1=function(){return self.cubeMap1.getTexture()},this.getObj=function(){var t={};return t.xVerh=this._xVerh,t.yVerh=this._yVerh,t.zVerh=this._zVerh,t.rotationX=this._rotationX,t.rotationZ=this._rotationZ,t.zume=this._zume,t},this.setObj=function(t){null!=t&&(this.xVerh=t.xVerh,this.yVerh=t.yVerh,this.zVerh=t.zVerh,this.rotationX=t.rotationX,this.rotationZ=t.rotationZ,this.zume=t.zume)},this.mousemove=function(t){self.position3d.stageMoveNew(t),self.event3DArr.mousemove(t)},this.getFunMouseMove=function(){return 0==self.devas?self.position3d.div.removeEventListener("mousemove",self.mousemove):self.position3d.div.removeEventListener("touchmove",self.mousemove),self.mousemove},null==_content2d?0==self.devas?self.position3d.div.addEventListener("mousemove",self.mousemove):self.position3d.div.addEventListener("touchmove",self.mousemove):(self.stageM2=function(t){self.position3d.stageMoveNew(t.data.originalEvent),self.event3DArr.mousemove(t.data.originalEvent)},0==self.devas?this.graphics.on("mousemove",self.stageM2):this.graphics.on("touchmove",self.stageM2)),document.oncontextmenu=function(t){return!1},this.addEvent=function(t,e){this.event3DArr&&this.event3DArr.eventSob.addEvent(t,e)},this.removeEvent=function(t,e){this.event3DArr&&this.event3DArr.eventSob.removeEvent(t,e)},this.addChildMouse=function(t){this.event3DArr&&this.event3DArr.addChild(t)},this.removeChildMouse=function(t){this.event3DArr&&this.event3DArr.removeChild(t)},this.fun_rotationX,this.fun_rotationZ}MVisi3D.prototype={set staticShadow(t){this.renderer.shadowMap.autoUpdate=!t,this._staticShadow=t},get staticShadow(){return this._staticShadow},set rotationX(t){this._rotationX!==t&&(this._rotationX=t,this.intRend=1,this.gCam2.rotation.x=t,this.gp2.rotation.x=t,this.fun_rotationX&&this.fun_rotationX())},get rotationX(){return this._rotationX},set rotationZ(t){this._rotationZ!==t&&(this._rotationZ=t,this.gCam1.rotation.z=t,this.gp1.rotation.z=t,this.intRend=1,this.fun_rotationZ&&this.fun_rotationZ())},get rotationZ(){return this._rotationZ},set zume(t){this._zume!==t&&(this.gpObject.position.z=1-t,this.gpObject2.position.z=1-t,this._zume=t,this.ggCam.position.z=-t,this.camera.position.z=0,this.intRend=1)},get zume(){return this._zume},set fov(t){this._fov=t,this.camera.fov=t,this.camera.updateProjectionMatrix()},get fov(){return this._fov},set yVerh(t){this._yVerh=t,this.gCGG.position.z=t,this.intRend=1},get yVerh(){return this.gCGG.position.z},set xVerh(t){this._xVerh=t,this.gCGG.position.x=t,this.intRend=1},get xVerh(){return this.gCGG.position.x},set zVerh(t){this._zVerh=t,this.gCGG.position.y=t,this.intRend=1},get zVerh(){return this.gCGG.position.y},set arrOut(t){this._arrOut=t,1!=this.alpha&&(this.efect&&this.efect.setValue(this._arrOut),this.intRend=1)},get arrOut(){return this._arrOut},set x(t){this._x=t,this.sizeWindow()},get x(){return this._x},set y(t){this._y=t,this.sizeWindow()},get y(){return this._y},set height(t){this._height=t,this.sizeWindow()},get height(){return this._height},set width(t){this._width=t,this.sizeWindow()},get width(){return this._width},set visible(t){this._visible=t,this.content.visible=t,this.renderer.domElement.style.visibility=t?"visible":"hidden"},get visible(){return this._visible},set isDragPan(t){this._isDragPan=t,this.position3d.isDragPan=t},get isDragPan(){return this._isDragPan},set activMouse(t){this._activMouse=t,this.event3DArr&&(this.event3DArr.activ=this._activMouse)},get activMouse(){return this._activMouse},set minZum(t){this.position3d.minZum=t},get minZum(){return this.position3d.minZum},set maxZum(t){this.position3d.maxZum=t},get maxZum(){return this.position3d.maxZum},set maxRotationX(t){this.position3d.minMaxX.x=t},get maxRotationX(){return this.position3d.minMaxX.x},set minRotationX(t){t<this.rotationX&&(this.rotationX=t),this.position3d.minMaxX.y=t},get minRotationX(){return this.position3d.minMaxX.y}}},function(t,e,i){"use strict";function n(t,e,i){var n=this;this.parent=t,this.content2d=e,this.drag=!0,this.zdvigX=0,this.sPixi=void 0,this.div=i,this.devas=t.devas,this.pause=!1,this.minMaxX=new THREE.Vector2(0,2.5),this.zume=new THREE.Vector3(1,30,10),this.point=new THREE.Vector2(0,0),this.point1=new THREE.Vector2(0,0),this.b=0,this.minZum=0,this.maxZum=5e3,this.powerZum=50,this.distMinMaxBox=1e4,this.boolDrahXZ=!0,this.isDragPan=t._isDragPan,this.isRotateScene=!1;var s=0;this.isIE=!1,(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(this.isIE=!0),this.getStage=function(t){return null==t.parent?t:this.getStage(t.parent)},this.stageMoveNew=function(t){0!=n.boolDrag&&1!=n.pause&&0!=n.drag&&(t&&n.isDragPan&&h?p(t):(null==t.touches?n.isRotateScene&&t.data.originalEvent.shiftKey?(n.parent.scene.rotation.y=s+.01*(t.clientX-n.point1.x),n.parent.intRend=1):n.boolDrahXZ&&(n.parent.rotationX=n.point.y-.01*(t.clientY-n.point1.y),n.minMaxX.x>n.parent.rotationX&&(n.parent.rotationX=n.minMaxX.x),n.minMaxX.y<n.parent.rotationX&&(n.parent.rotationX=n.minMaxX.y),n.parent.rotationZ=n.point.x+.01*(t.clientX-n.point1.x)):1==t.touches.length?n.boolDrahXZ&&(n.parent.rotationX=n.point.y-.01*(t.touches[0].clientY-n.point1.y),n.minMaxX.x>n.parent.rotationX&&(n.parent.rotationX=n.minMaxX.x),n.minMaxX.y<n.parent.rotationX&&(n.parent.rotationX=n.minMaxX.y),n.parent.rotationZ=n.point.x+.01*(t.touches[0].clientX-n.point1.x)):t.touches.length>=2&&(n.pT.x=t.touches[0].clientX,n.pT.y=t.touches[0].clientY,n.pT1.x=t.touches[1].clientX,n.pT1.y=t.touches[1].clientY,0==n.distTach?(n.distTach=calc.getDistance(n.pT,n.pT1),a=0,u.set(Math.round(1*n.pT.x),Math.round(1*n.pT.y))):(r=calc.getDistance(n.pT,n.pT1),a=r-n.distTach,n.distTach=r),o=n.parent._zume-a*(n.parent._zume/100),n.zumNEW(o),p(null,Math.round(1*n.pT.x),Math.round(1*n.pT.y))),n.parent.fun_sob&&n.parent.fun_sob("mouseMove")))},this.pT=new THREE.Vector2(0,0),this.pT1=new THREE.Vector2(0,0);var a=0,r=0;this.boolDrag=!1,this.stageUpNew=function(t){n.boolDrag=!1,0==n.devas?window.removeEventListener("mouseup",n.stageUpNew):(n.distTach=0,window.removeEventListener("touchend",n.stageUpNew)),n.parent.fun_sob&&n.parent.fun_sob("mouseUp")},this.mouseUpp=function(t){n.parent.intRend=1};var o,h=!1;if(this.distTach=0,this.mouseDown=function(t){var e;1!=n.pause&&(0!=n.drag&&(h=!1,n.boolDrag=!0,n.parent.fun_sob&&n.parent.fun_sob("mouseDown"),n.distTach=0,n.point.y=n.parent.rotationX,n.point.x=n.parent.rotationZ,n.isRotateScene&&(s=n.parent.scene.rotation.y),n.isDragPan&&t&&1===t.button&&(h=!0,e=t,u.set(e.clientX,e.clientY)),0==n.devas?(n.point1.x=t.clientX,n.point1.y=t.clientY,window.addEventListener("mouseup",n.stageUpNew)):(n.point1.x=t.touches[0].clientX,n.point1.y=t.touches[0].clientY,window.addEventListener("touchend",n.stageUpNew))))},this.dragscrol=void 0,this.mousewheel=function(t){if(0!=n.drag){var e=-1;t.delta;null==t.wheelDelta&&t.wheelDelta,t.delta&&t.delta<0&&(e=1),t.deltaY&&t.deltaY<0&&(e=1),t.detail&&t.detail<0&&(e=1),null!=t.wheelDelta&&(e=t.wheelDelta>0?-1:1),o=n.parent._zume+e*(n.powerZum/100)*n.parent._zume,n.zumNEW(o),n.dragscrol&&n.dragscrol(t)}},this.zumNEW=function(t){t<n.minZum&&(t=n.minZum),t>n.maxZum&&(t=n.maxZum),n.parent.zume=t,n.parent.intRend=1},this.mouseDown2=function(t){n.mouseDown(t.data.originalEvent)},null!=this.content2d)if(this.sPixi=this.content2d,this.sPixi.interactive=!0,0==n.devas){this.content2d.on("mousedown",this.mouseDown2);document.addEventListener("mousewheel",this.mousewheel),document.addEventListener("DOMMouseScroll",this.mousewheel)}else this.content2d.on("touchstart",this.mouseDown2);else if(0==n.devas){i.addEventListener("mousedown",this.mouseDown);i.addEventListener("mousewheel",this.mousewheel),i.addEventListener("DOMMouseScroll",this.mousewheel)}else i.addEventListener("touchstart",this.mouseDown,{passive:!1,capture:!0});var l=new THREE.Vector3,u=new THREE.Vector2,c=new THREE.Vector2,d=new THREE.Vector2;function p(t,e,i){null!=t?c.set(t.clientX,t.clientY):c.set(e,i),d.subVectors(c,u),n.moveCamXY(d),u.copy(c)}var f=function(){var t=new THREE.Vector3;return function(e,i){t.setFromMatrixColumn(i,0),t.multiplyScalar(-e),l.add(t)}}(),m=function(){var t=new THREE.Vector3;return function(e,i){t.setFromMatrixColumn(i,1),t.multiplyScalar(e),l.add(t)}}(),g=function(t,e){var i=n.parent.renderer.domElement;if(n.parent.camera.isPerspectiveCamera){var s=Math.max(n.parent.zume,10);s*=Math.tan(n.parent.camera.fov/2*Math.PI/180),f(2*t*s/i.clientHeight,n.parent.camera.matrixWorld),m(2*e*s/i.clientHeight,n.parent.camera.matrixWorld)}else console.warn("WARNING: camera neither perspective.")};this.moveCamXY=function(t){l.set(0,0,0),n.parent.camera.updateMatrixWorld(),n.parent.scene.updateMatrixWorld(),arguments.length>1&&(t={x:arguments[0],y:arguments[1]}),g(t.x||0,t.y||0),n.parent.xVerh+=l.x,n.parent.yVerh+=-l.y,n.parent.zVerh+=l.z,n.parent.xVerh=Math.max(Math.min(n.parent.xVerh,n.distMinMaxBox),-n.distMinMaxBox),n.parent.zVerh=Math.max(Math.min(n.parent.zVerh,n.distMinMaxBox),-n.distMinMaxBox),n.parent.yVerh=Math.max(Math.min(n.parent.yVerh,n.distMinMaxBox),-n.distMinMaxBox),l.set(0,0,0)}}i.d(e,"a",function(){return n})},function(module,__webpack_exports__,__webpack_require__){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function PMMat(par,visi3D,objbase){this.type="PMMat";var self=this;this.par=par,this.visi3D=visi3D,this.objbase=objbase,this.pmTexture=this.par.tex,this.ser=window.location.href;var arrParams=window.location.href.split("?"),arrParams2=arrParams[0].split("/");this.param=this.par.param,this.nameType="materials",this.matError=new THREE.MeshBasicMaterial({color:16711680}),this.server="";for(var i=0;i<arrParams2.length-1;i++)this.server+=arrParams2[i]+"/";this.setObjS=function(t,e,i){this.getTestTitleObj(t),i()},this.testObjMatLoad=function(t){if(t.children)for(var e=0;e<t.children.length;e++)if(0==this.testObjMatLoad(t.children[e]))return!1;return!t.material||null==t.material.bLoad||0!=t.material.bLoad},this.matarialArray=this.param[this.nameType];var matarialArray=this.matarialArray;this.idColor=null;var loader=new THREE.TextureLoader,rt,textur;this.obj={},this.getTestTitle=function(t){var e=null;if(null!=t){trace(">>>",t,matarialArray);for(var i=0;i<matarialArray.length;i++)if(matarialArray[i].title){if(-1!=t.indexOf(matarialArray[i].title))return e=this.getIDReturn(matarialArray[i].id)}else if(matarialArray[i].json&&matarialArray[i].json.title&&-1!=t.indexOf(matarialArray[i].json.title))return trace(">>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@>"),e=this.getIDReturn(matarialArray[i].id)}return e},this.getTestTitleObj=function(t){t.material&&null!=(rt=this.getTestTitle(t.material.name))&&(t.material=rt);for(var e=0;e<t.children.length;e++)this.getTestTitleObj(t.children[e])},this.getIDReturn=function(id,isBD){for(var r=null,p=-1,i=0;i<this.param.materials.length;i++)this.param.materials[i].id==id&&(p=i);if(-1==p)return this.matError;var ooo=this.param.materials[p].json;if(null==isBD&&null!=this.obj[id])return this.obj[id];var comand="new THREE."+ooo.obj.type+"()",m=eval(comand);return m.idObj=matarialArray[p],this.startMat(m,id),this.obj[id]=m,m.idUz=id,m},this.get=function(t,e,i){var n,s,a=-1;if(null!=i){n=t+"",t="2456567567867896789";for(var r=0;r<this.matarialArray.length;r++)if(s=this.matarialArray[r].title+"",-1!=n.indexOf(s)){t=this.matarialArray[r].title;break}}for(r=0;r<this.matarialArray.length;r++)this.matarialArray[r].title==t&&(a=r);-1!=a?this.getId(this.matarialArray[a].id,e):e(null)},this.getId=function(id,_fun){for(var p=-1,i=0;i<this.matarialArray.length;i++)if(this.matarialArray[i].id==id){p=i;break}if(-1!=p){if(null!=this.obj[id])return 1==this.obj[id].bLoad?_fun(this.obj[id]):this.obj[id].arrFun.push(_fun),this.obj[id];var comand="new THREE."+this.matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],m.bLoad=!1,m.loadTexure=999,m.arrFun=[_fun],this.startMat(m,id),this.obj[id]=m,m}_fun(null)},this.objToMater=function(t,e){var i=this;for(var n in t)null!=e[n]&&(e[n]instanceof THREE.Color?e[n]=new THREE.Color(t[n]):e[n]=t[n]);if(e.loadTexure=0,t.textur&&"object"===_typeof(t.textur)){e.loadTexure=t.textur.length;for(var s=0;s<t.textur.length;s++)if(t.textur[s].id)!function(){var n=s;textur=i.pmTexture.getById(t.textur[s].id,function(i){e[t.textur[n].name]=i,--e.loadTexure}),e[t.textur[s].name]=textur}();else{var a=t.textur[s].res.src.replace("http://","https://");(textur=loader.load(a,function(t){self.visi3D&&(self.visi3D.intRend=1),e.loadTexure--})).wrapS=textur.wrapT=THREE.RepeatWrapping,textur.repeat.x=t.textur[s].rx,textur.repeat.y=t.textur[s].ry,e[t.textur[s].name]=textur}}if(e.needsUpdate=!0,e.bLoad=!0,e.arrFun)for(s=0;s<e.arrFun.length;s++)e.arrFun[s](e)},this.startMat=function(t,e){for(var i=null,n=0;n<this.matarialArray.length;n++)if(this.matarialArray[n].id==e){this.matarialArray[n].json&&(i="string"==typeof this.matarialArray[n].json?JSON.parse(this.matarialArray[n].json):this.matarialArray[n].json);break}if(null==i){this.server,self.par.plus;var s,a={type:"GET"};a.url=this.param.server+this.nameType+"/"+e+"/",a.success=function(e){s="string"==typeof e.json?JSON.parse(e.json):e.json,self.startMat2(s,t)},$.ajax(a)}else self.startMat2(i,t)},this.startMat2=function(t,e){t||((t={}).mirro=0,t.obj={}),!0===t.mirro?self.visi3D&&(e.envMap=self.visi3D.getEnvMap()):(t.mirro,1==t.mirro&&self.visi3D&&(e.envMap=self.visi3D.getEnvMap()),2==t.mirro&&self.visi3D&&(e.envMap=self.visi3D.getEnvMap1())),self.objToMater(t.obj,e)}}__webpack_require__.d(__webpack_exports__,"a",function(){return PMMat})},function(t,e,i){"use strict";function n(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}var s,a,r;Object.assign(n.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),n.FullScreenQuad=(s=new THREE.OrthographicCamera(-1,1,1,-1,0,1),a=new THREE.PlaneBufferGeometry(2,2),r=function(t){this._mesh=new THREE.Mesh(a,t)},Object.defineProperty(r.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Object.assign(r.prototype,{render:function(t){t.render(this._mesh,s)}}),r);var o=function(t,e){n.call(this),this.textureID=void 0!==e?e:"tDiffuse",t instanceof THREE.ShaderMaterial?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new n.FullScreenQuad(this.material)};o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,render:function(t,e,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}});var h=function(t,e){if(this.renderer=t,void 0===e){var i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},n=t.getSize(new THREE.Vector2);this._pixelRatio=t.getPixelRatio(),this._width=n.width,this._height=n.height,(e=new THREE.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=e.width,this._height=e.height;this.renderTarget1=e,this.renderTarget2=e.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new o(THREE.CopyShader),this.clock=new THREE.Clock};Object.assign(h.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,e){this.passes.splice(e,0,t)},isLastEnabledPass:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0},render:function(t){void 0===t&&(t=this.clock.getDelta());var e,i,n=this.renderer.getRenderTarget(),s=!1,a=this.passes.length;for(i=0;i<a;i++)if(!1!==(e=this.passes[i]).enabled){if(e.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),e.render(this.renderer,this.writeBuffer,this.readBuffer,t,s),e.needsSwap){if(s){var r=this.renderer.getContext(),o=this.renderer.state.buffers.stencil;o.setFunc(r.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),o.setFunc(r.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(e instanceof THREE.MaskPass?s=!0:e instanceof THREE.ClearMaskPass&&(s=!1))}this.renderer.setRenderTarget(n)},reset:function(t){if(void 0===t){var e=this.renderer.getSize(new THREE.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=e.width,this._height=e.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this._width=t,this._height=e;var i=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(i,n),this.renderTarget2.setSize(i,n);for(var s=0;s<this.passes.length;s++)this.passes[s].setSize(i,n)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}});var l=function(t,e,i,s,a){n.call(this),this.scene=t,this.camera=e,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=void 0!==a?a:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,render:function(t,e,i){var n,s,a=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(n=t.getClearColor().getHex(),s=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(n,s),this.scene.overrideMaterial=null,t.autoClear=a}});var u={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")},c=function(t,e,i,s){this.renderScene=e,this.renderCamera=i,this.selectedObjects=void 0!==s?s:[],this.visibleEdgeColor=new THREE.Color(1,1,1),this.hiddenEdgeColor=new THREE.Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,n.call(this),this.resolution=void 0!==t?new THREE.Vector2(t.x,t.y):new THREE.Vector2(256,256);var a={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat},r=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new THREE.MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=THREE.DoubleSide,this.renderTargetMaskBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,a),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new THREE.MeshDepthMaterial,this.depthMaterial.side=THREE.DoubleSide,this.depthMaterial.depthPacking=THREE.RGBADepthPacking,this.depthMaterial.blending=THREE.NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=THREE.DoubleSide,this.prepareMaskMaterial.fragmentShader=function(t,e){var i=e.isPerspectiveCamera?"perspective":"orthographic";return t.replace(/DEPTH_TO_VIEW_Z/g,i+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,a),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new THREE.WebGLRenderTarget(r,o,a),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new THREE.WebGLRenderTarget(r,o,a),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new THREE.WebGLRenderTarget(Math.round(r/2),Math.round(o/2),a),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new THREE.WebGLRenderTarget(r,o,a),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new THREE.WebGLRenderTarget(Math.round(r/2),Math.round(o/2),a),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(r,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(Math.round(r/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===u&&console.error("OutlinePass relies on CopyShader");var h=u;this.copyUniforms=THREE.UniformsUtils.clone(h.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:THREE.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.fsQuad=new n.FullScreenQuad(null),this.tempPulseColor1=new THREE.Color,this.tempPulseColor2=new THREE.Color,this.textureMatrix=new THREE.Matrix4};c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(t,e){this.renderTargetMaskBuffer.setSize(t,e);var i=Math.round(t/this.downSampleRatio),n=Math.round(e/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,n),this.renderTargetBlurBuffer1.setSize(i,n),this.renderTargetEdgeBuffer1.setSize(i,n),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(i,n),i=Math.round(i/2),n=Math.round(n/2),this.renderTargetBlurBuffer2.setSize(i,n),this.renderTargetEdgeBuffer2.setSize(i,n),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(i,n)},changeVisibilityOfSelectedObjects:function(t){function e(e){e.isMesh&&(t?(e.visible=e.userData.oldVisible,delete e.userData.oldVisible):(e.userData.oldVisible=e.visible,e.visible=t))}for(var i=0;i<this.selectedObjects.length;i++){this.selectedObjects[i].traverse(e)}},changeVisibilityOfNonSelectedObjects:function(t){var e=[];function i(t){t.isMesh&&e.push(t)}for(var n=0;n<this.selectedObjects.length;n++){this.selectedObjects[n].traverse(i)}this.renderScene.traverse(function(i){if(i.isMesh||i.isLine||i.isSprite){for(var n=!1,s=0;s<e.length;s++)if(e[s].id===i.id){n=!0;break}if(!n){var a=i.visible;t&&!i.bVisible||(i.visible=t),i.bVisible=a}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(t,e,i,n,s){if(this.selectedObjects.length>0){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var a=t.autoClear;t.autoClear=!1,s&&t.state.buffers.stencil.setTest(!1),t.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var r=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,t.setRenderTarget(this.renderTargetDepthBuffer),t.clear(),t.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new THREE.Vector2(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,t.setRenderTarget(this.renderTargetMaskBuffer),t.clear(),t.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=r,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,t.setRenderTarget(this.renderTargetMaskDownSampleBuffer),t.clear(),this.fsQuad.render(t),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var o=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(o),this.tempPulseColor2.multiplyScalar(o)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new THREE.Vector2(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,t.setRenderTarget(this.renderTargetEdgeBuffer1),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=c.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,t.setRenderTarget(this.renderTargetBlurBuffer1),t.clear(),this.fsQuad.render(t),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=c.BlurDirectionY,t.setRenderTarget(this.renderTargetEdgeBuffer1),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=c.BlurDirectionX,t.setRenderTarget(this.renderTargetBlurBuffer2),t.clear(),this.fsQuad.render(t),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=c.BlurDirectionY,t.setRenderTarget(this.renderTargetEdgeBuffer2),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&t.state.buffers.stencil.setTest(!0),t.setRenderTarget(i),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=a}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,t.setRenderTarget(null),this.fsQuad.render(t))},getPrepareMaskMaterial:function(){return new THREE.ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new THREE.Vector2(.5,.5)},textureMatrix:{value:new THREE.Matrix4}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},visibleEdgeColor:{value:new THREE.Vector3(1,1,1)},hiddenEdgeColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(t){return new THREE.ShaderMaterial({defines:{MAX_RADIUS:t},uniforms:{colorTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},direction:{value:new THREE.Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\t\t\t\t}"})},getOverlayMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),c.BlurDirectionX=new THREE.Vector2(1,0),c.BlurDirectionY=new THREE.Vector2(0,1);var d={uniforms:{tDiffuse:{value:null},resolution:{value:new THREE.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};function p(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"a",function(){return f});var f=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._width=100,this._height=100,this.visi3D=e,this._active=!1,this._edgeStrength=3,this._edgeGlow=0,this._edgeThickness=1,this._pulsePeriod=0,this._visibleEdgeColor="#ffffff",this._hiddenEdgeColor="#190a05",this._boolTextur=!1,this._linkTextur="null";var n=new h(e.renderer),s=new l(e.scene,e.camera);n.addPass(s);var a=new c(new THREE.Vector2(window.innerWidth,window.innerHeight),e.scene,e.camera);n.addPass(a),this.outlinePass=a;var r=new o(d);r.uniforms.resolution.value.set(1/window.innerWidth,1/window.innerHeight),n.addPass(r),this.outlinePass.edgeStrength=this._edgeStrength,this.outlinePass.edgeGlow=this._edgeGlow,this.outlinePass.edgeThickness=this._edgeThickness,this.outlinePass.pulsePeriod=this._pulsePeriod,this.outlinePass.visibleEdgeColor.set(this._visibleEdgeColor),this.outlinePass.hiddenEdgeColor.set(this._hiddenEdgeColor),this._visibleEdgeColor="#ffffff",this._hiddenEdgeColor="#190a05",this.dragLink=function(){(new THREE.TextureLoader).load(this._linkTextur,function(t){a.patternTexture=t,t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,e.intRend=1})},this.sizeWindow=function(t,e){this._width=t,this._height=e,r.uniforms.resolution.value.set(1/t,1/e),n.setSize(t,e)},this.render=function(){return 0==this._active?this._active:(n.render(),!0)},this.setValue=function(t){1!=Array.isArray(t)?a.selectedObjects=null!=t||null!=t?[t]:[]:a.selectedObjects=t}}var e,i,n;return e=t,(i=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.visi3D.intRend=1)},get:function(){return this._active}},{key:"edgeStrength",set:function(t){this._edgeStrength!=t&&(this._edgeStrength=t,this.outlinePass.edgeStrength=this._edgeStrength)},get:function(){return this._edgeStrength}},{key:"edgeGlow",set:function(t){this._edgeGlow!=t&&(this._edgeGlow=t,this.outlinePass.edgeGlow=this._edgeGlow)},get:function(){return this._edgeGlow}},{key:"pulsePeriod",set:function(t){this._pulsePeriod!=t&&(this._pulsePeriod=t,this.outlinePass.pulsePeriod=this._pulsePeriod)},get:function(){return this._pulsePeriod}},{key:"linkTextur",set:function(t){this._linkTextur!=t&&(this._linkTextur=t,"null"==this._linkTextur?this.outlinePass.usePatternTexture=!1:(this.outlinePass.usePatternTexture=!0,this.dragLink()))},get:function(){return this._linkTextur}},{key:"visibleEdgeColor",set:function(t){this._visibleEdgeColor!=t&&(this._visibleEdgeColor=t,this.outlinePass.visibleEdgeColor.set(this._visibleEdgeColor))},get:function(){return this._visibleEdgeColor}},{key:"hiddenEdgeColor",set:function(t){this._hiddenEdgeColor!=t&&(this._hiddenEdgeColor=t,this.outlinePass.hiddenEdgeColor.set(this._hiddenEdgeColor))},get:function(){return this._hiddenEdgeColor}}])&&p(e.prototype,i),n&&p(e,n),t}()},function(t,e,i){"use strict";var n=i(0);function s(t){this.parent=t;var e,i=this;this._active=!1,this.RADIUS=1e3,this.POS_X=0,this.POS_Y=0,this.POS_Z=0,this.LINK="nullMy",this.COLOR="0xffffff",this._radius=this.RADIUS,this._link=this.LINK,this._color=this.COLOR,this._shadRotZ=this.parent.ROTATION_Z,this._rotZ=0,this._x=this.POS_X,this._y=this.POS_Y,this._z=this.POS_Z,this.mesh=void 0,this.cont3d=void 0,this.cont3d1=void 0,this.textur=void 0,this.loaderHDR=void 0,this.onLoad=void 0,this.onComplete=void 0,this.init=function(){null==this.mesh&&(this.geometry=new THREE.SphereGeometry(1,32,32),this.loader=new THREE.TextureLoader,this.loaderHDR=new n.a,this.material=new THREE.MeshBasicMaterial({side:THREE.BackSide,color:16777215}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.scale.set(this._radius,this._radius,this._radius),this.cont3d=new THREE.Object3D,this.cont3d1=new THREE.Object3D,this.cont3d.add(this.cont3d1),this.cont3d1.add(this.mesh),this.cont3d1.rotation.y=0,this.mesh.rotation.y=this._rotZ,this.cont3d.rotation.x=-Math.PI/2)},this.dergActiv=function(){1==this._active?null==this.cont3d.parent&&this.parent.parent.groupObject.add(this.cont3d):null!=this.cont3d.parent&&this.parent.parent.groupObject.remove(this.cont3d)},this.canvasTexture,this.linkNull=null,this.creatLink=function(){if(null!=this.linkNull)return this.linkNull;var t=document.createElement("canvas"),e=t.getContext("2d");t.height=t.width=2048;var i=t.height/26;e.fillStyle="rgba(100, 100, 100, 0.5)";for(var n=!0,s=!0,a=0;a<26;a++){s=n;for(var r=0;r<26;r++)s&&e.fillRect(a*i,r*i,i,i),s=!s;n=!n}this.linkNull=t.toDataURL("image/png"),this.canvasTexture=new THREE.CanvasTexture(t)},this.dergLink=function(){if("null"==this._link||null==this._link){null!=this.material.map&&(this.material.map=null,this.material.needsUpdate=!0);var t=this._link+"";this.creatLink(),i.textur=this.canvasTexture,i.textur.linkMy=t,i.material.map=i.textur,i.material.needsUpdate=!0,i.parent.parent.intRend=1,i.onComplete&&i.onComplete()}else{if(this.onLoad&&this.onLoad(),0==(e=this.checkFormat(this._link))){var n=this._link+"";if(i.textur&&i.textur.linkMy&&i.textur.linkMy==n)return void(i.onComplete&&i.onComplete());this.loader.load(this._link,function(t){i.textur=t,i.textur.linkMy=n,i.material.map=t,i.material.needsUpdate=!0,i.parent.parent.intRend=1,i.onComplete&&i.onComplete()},function(t){},function(t){})}if(1==e)return}},this.checkFormat=function(t){return-1!==t.indexOf(".png")?0:-1!==t.indexOf(".jpeg")?0:-1!==t.indexOf(".jpg")?0:t.length>150?-1!==t.indexOf("png")?0:-1!==t.indexOf("jpeg")?0:-1!==t.indexOf("jpg")?0:1:1},this.render=function(){}}function a(){var t=this,e=256,i=256,n=new THREE.Scene,s=new THREE.OrthographicCamera(e/-2,e/2,i/2,i/-2,.001,1e4),a=(new THREE.Clock,new THREE.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}));s.position.set(200,200,200),n.add(s),this.camera=s,this.fotoContainer=new THREE.Object3D,n.add(this.fotoContainer),n.background=new THREE.Color(38655),a.setPixelRatio(window.devicePixelRatio),a.setSize(e,i),a.localClippingEnabled=!0;var r=document.createElement("div");r.style.position="absolute",r.style.bottom="0px",r.style.left="0px",r.appendChild(a.domElement),this.contentHTML=r,this.canvas=a.domElement,this.contentHTML=r;var o=new THREE.AmbientLight("#ffffff",1);n.add(o);var h=new THREE.GridHelper(1e3,10),l=new THREE.AxesHelper(100),u=new THREE.BoxHelper(this.fotoContainer,16776960);n.add(h),n.add(l),n.add(u);var c=[l,h,u];function d(){a.render(n,s)}this.render=d,d(),u.setFromObject(t.fotoContainer);var p=new THREE.Box3,f=new THREE.Vector3;this.box=p,this.center=f,this.setSize=function(t,n){e=t,i=n,a.setSize(e,i),s.aspect=e/i,s.updateProjectionMatrix()},this.addObjFoto=function(t){this.fotoContainer.add(t),u.setFromObject(this.fotoContainer)},this.removeObjFoto=function(t){this.fotoContainer.remove(t)},this.moveToObj=function(e){p.setFromObject(e||t.fotoContainer);var i=p.max.x-p.min.x,n=p.max.z-p.min.z;t.moveToRect(p.min.x,p.min.z,i,n)},this.moveToRect=function(t,e,i,n){if(t+=i/2,e+=n/2,f.set(t,0,e),s.position.set(f.x,9e3,f.z),s.lookAt(f),"OrthographicCamera"===s.type){var a=Math.max(n,i);s.zoom=1,s.left=a/-2,s.right=a/2,s.top=a/2,s.bottom=a/-2,s.aspect=a/a}s.updateProjectionMatrix()},this.getFoto=function(t){t=t||1024;for(var s=0;s<c.length;s++)c[s].visible=!1;var r=n.background;n.background=null,a.setSize(t,t),d();var o=a.domElement.toDataURL("image/png");a.setSize(e,i),n.background=r;for(var h=0;h<c.length;h++)c[h].visible=!0;return d(),o},this.getCanvas=function(t){t=t||1024;for(var e=0;e<c.length;e++)c[e].visible=!1;n.background;n.background=null;var i=a.getSize();return i.width==t&&i.height==t||a.setSize(t,t),d(),a.domElement}}function r(t){var e=this,i=THREE.Math.generateUUID(),n=new THREE.Vector3(0,1,0),s=(new THREE.Plane(n,.01),new THREE.Vector4(0,999,0,.001)),r=new THREE.Box3,u=t||new a;this.foto3D=u;var c=new THREE.Vector2(0,0),d=100,p=new h;this.canvas=p.canvas,this.isTime=!1;var f=new THREE.Texture(p.canvas);this.texturePlan=f,this.matPlan=new THREE.MeshPhongMaterial({transparent:!0,side:THREE.DoubleSide,map:f});var m=new l;this.canvasGG=m,m.arrColorStopTranspanent[0]=.15,m.arrProcent[0]=.82,m.arrColorStopTranspanent[1]=1,m.arrProcent[1]=1,m.update();var g=new THREE.Texture(m.canvas);g.needsUpdate=!0,this.textureShadow=g,this.content3d=new THREE.Object3D,this.shadowContent3d=new THREE.Object3D,this.meshPlan=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),this.matPlan),this.meshPlan.rotation.x=-Math.PI/2,this.content3d.add(this.meshPlan);var b=new THREE.Mesh(new THREE.SphereBufferGeometry(10,16,16));b.position.set(s.x,s.y,s.z),this.arrShadowMesh=[],this.arrObj=[],this._dunamic=!0,this.dirty=!0,this._lightPosition4D=s,this._fotoPosition=new THREE.Vector2(0,0),this._fotoWH=150,this._imgWH=512,this._imgBlur=1,this._imgAlpha=1,this._offsetY=0,this._scaleShadow=1,this._isDinamFotoRect=!1,this._opacityMat=1;var v=[new THREE.Plane(new THREE.Vector3(0,-1,0),100),new THREE.Plane(new THREE.Vector3(0,1,0),0)];this._shadowMaterial=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,transparent:!0,opacity:this._opacityMat,depthWrite:!1,map:g,clippingPlanes:v,clipIntersection:!1}),this.arrDataSempl=[],this.arrDataSempl.push(new o(0,200,3,1));var y=new THREE.Group;this.content3d.add(y);var x=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:g,transparent:!0}));x.scale.set(1,30,1),x.rotation.z=-Math.PI/2,y.add(x),y.visible=!1,this.helpers=y,this.setConstMax=function(t){v[0].constant=t},this.setConstMin=function(t){v[1].constant=-t},this.addObj=function(t){if(-1==e.arrObj.indexOf(t)){t.updateMatrixWorld();var i=t.clone();!function t(e,i){e.userData.targetObject=i;for(var n=0;n<e.children.length;n++){if(!i.children[n])throw new Error("обекты не одинаковы");t(e.children[n],i.children[n])}}(i,t),function(t){var i=[];!function t(e,i){"Mesh"==e.type&&i.push(e);for(var n=0;n<e.children.length;n++)"Mesh"==e.type?i.push(e.children[n]):t(e.children[n],i)}(t,i);for(var n=0;n<i.length;n++)i[n].material=e._shadowMaterial}(i),e.arrShadowMesh.push(i),e.arrObj.push(t),e.shadowContent3d.add(i),this.dirty=!0}},this.removeObj=function(t){var i=e.arrObj.indexOf(t);-1!=i&&(e.arrObj.splice(i,1),e.shadowContent3d.remove(e.arrShadowMesh[i]),e.arrShadowMesh.splice(i,1),this.dirty=!0)},this.clear=function(){for(var t=0;(t=e.arrObj.length)>0;)if(e.removeObj(e.arrObj[t-1]),t===e.arrObj.length)throw new Error("object not remove")},this.intRend=1,this.intRendOk=1,this.upDate=function(){e.opacityMat&&(e.dunamic&&(e.intRend=e.intRendOk),e.intRend==e.intRendOk&&(e.dirty||function(){for(var t=0;t<e.arrShadowMesh.length;t++)if((e._isDinamFotoRect||_(e.arrShadowMesh[t]))&&w(e.arrShadowMesh[t]))return!0;return!1}())&&e.render(),e.intRend++)};function _(t){var i=!1,n=!1,s=r.min.x,a=r.min.z,o=r.max.x-r.min.x,h=r.max.z-r.min.z;if(r.setFromObject(t.userData.targetObject),i=j(s=r.min.x,a=r.min.z,o=r.max.x-r.min.x,h=r.max.z-r.min.z,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH),r.setFromObject(t),n=j(s=r.min.x,a=r.min.z,o=r.max.x-r.min.x,h=r.max.z-r.min.z,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH),!i&&!n)return!1;i=!1,n=!1;for(var l=0;l<t.children.length;l++)if(r.setFromObject(t.children[l].userData.targetObject),s=r.min.x,a=r.min.z,o=r.max.x-r.min.x,h=r.max.z-r.min.z,i=i||j(s,a,o,h,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH),r.setFromObject(t.children[l]),s=r.min.x,a=r.min.z,o=r.max.x-r.min.x,h=r.max.z-r.min.z,n=n||j(s,a,o,h,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH),i||n)return!0;return!0}function w(t){if(!function(t,e){if(t.position.equals(e.position)&&t.quaternion.equals(e.quaternion)&&t.scale.equals(e.scale)&&t.visible===e.visible)return!0;return!1}(t,t.userData.targetObject))return!0;for(var e=0;e<t.children.length;e++)if(w(t.children[e]))return!0;return!1}function A(t){!function(t,e){t.position.copy(e.position),t.quaternion.copy(e.quaternion),t.scale.copy(e.scale),t.visible=e.visible}(t,t.userData.targetObject);for(var e=0;e<t.children.length;e++)A(t.children[e])}this.render=function(){e.isTime&&console.time("render "+i),e.dirty=!1,function(){s.w=.001,b.position.set(s.x,s.y,s.z);for(var t=0;t<e.arrShadowMesh.length;t++)A(e.arrShadowMesh[t]);S()}(),u.addObjFoto(e.shadowContent3d),d=e.fotoWH,c.x=e.fotoPosition.x,c.y=e.fotoPosition.y,e.isDinamFotoRect&&(r.setFromObject(e.shadowContent3d),c.x=r.min.x,c.y=r.min.z,d=Math.max(r.max.x-r.min.x,r.max.z-r.min.z),c.x-=100,c.y-=100,d+=200),u.moveToRect(c.x,c.y,d,d),function(){var t=u.getCanvas(e.imgWH);p.setCanvas(t),0==e.arrDataSempl.length&&p.update();for(var i=0;i<e.arrDataSempl.length;i++)e.setConstMin(e.arrDataSempl[i].min*e._scaleShadow+e._offsetY),e.setConstMax(e.arrDataSempl[i].max*e._scaleShadow+e._offsetY),u.render(),p._blur=e.arrDataSempl[i].blur+(e._scaleShadow>1?e._scaleShadow:0),p._alpha=e.arrDataSempl[i].alpha,p.update();e.setConstMin(-999999),e.setConstMax(999999),f.needsUpdate=!0}(),e.meshPlan.scale.set(d,d,1),e.meshPlan.position.set(c.x+d/2,0,c.y+d/2),e.isTime&&console.timeEnd("render "+i),e.onUpdate&&e.onUpdate()};var T=new THREE.Box3(new THREE.Vector3,new THREE.Vector3(300,300,300));this.boundingBoxUv=T;var P=new THREE.Vector3;function E(t){if("Mesh"===t.type){var i=!1,n=t.getWorldPosition(t.position),s=t.getWorldQuaternion(t.quaternion),a=e.maxHeight;n.y-=e._offsetY,t.userData.pos?t.userData.pos.y!=n.y?i=!0:t.userData.rot.equals(s)?t.userData.maxHeight!==a?i=!0:t.userData.scaleShadow!==e._scaleShadow&&(i=!0):i=!0:i=!0,e._isDinamFotoRect||(r.setFromObject(t),j(r.min.x,r.min.z,r.max.x-r.min.x,r.max.z-r.min.z,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH)||(i=!1)),i&&(!function(t){t.geometry.uuid===t.userData.targetObject.geometry.uuid&&(t.geometry=t.userData.targetObject.geometry.clone());var i=T,n=0;if(t.geometry instanceof THREE.Geometry){for(var s=t.geometry.faces,a=t.geometry.vertices,r=t.geometry.faceVertexUvs[0],o=0;o<s.length;o++)P.set(a[s[o].a].x,a[s[o].a].y,a[s[o].a].z),t.localToWorld(P),n=1-D(P.y-e._offsetY,i.min.y,i.min.y+i.max.y)/100,r[o][0].set(n,n),P.set(a[s[o].b].x,a[s[o].b].y,a[s[o].b].z),t.localToWorld(P),n=1-D(P.y-e._offsetY,i.min.y,i.min.y+i.max.y)/100,r[o][1].set(n,n),P.set(a[s[o].c].x,a[s[o].c].y,a[s[o].c].z),t.localToWorld(P),n=1-D(P.y-e._offsetY,i.min.y,i.min.y+i.max.y)/100,r[o][2].set(n,n);t.geometry.uvsNeedUpdate=!0}else{var h=t.geometry.attributes.position.array;t.geometry.attributes.uv||(arrUvAttribut=new Float32Array(h.length/3*2),t.geometry.addAttribute("uv",new THREE.BufferAttribute(arrUvAttribut,2)));var l=t.geometry.attributes.uv.array,u=(t.geometry.attributes.uv.itemSize,t.geometry.index.array),c=t.geometry.index.count;for(o=0;o<c;o++){var d=u[o],p=3*d,f=2*d;P.set(h[p],h[p+1],h[p+2]),t.localToWorld(P),n=1-D(P.y-e._offsetY,i.min.y,i.min.y+i.max.y*e._scaleShadow)/100,l[f]=n,l[f+1]=n}t.geometry.attributes.uv.needsUpdate=!0}}(t),t.userData.pos=n,t.userData.rot=s,t.userData.maxHeight=a,t.userData.scaleShadow=e._scaleShadow)}for(var o=0;o<t.children.length;o++)E(t.children[o])}function S(){x.scale.x=(e.boundingBoxUv.max.y||1)*e._scaleShadow,x.position.y=x.scale.x/2+e.boundingBoxUv.min.y;for(var t=0;t<e.arrShadowMesh.length;t++)(e._isDinamFotoRect||(r.setFromObject(e.arrShadowMesh[t]),j(r.min.x,r.min.z,r.max.x-r.min.x,r.max.z-r.min.z,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH)))&&E(e.arrShadowMesh[t])}this.updateShadowUv=S,this.updateShadowTexture=function(){this.canvasGG.update(),this.textureShadow.needsUpdate=!0},this.setShadowColor=function(t,i,n){m.r=t,m.g=i,m.b=n,e.updateShadowTexture()},this.getConfig=function(){var t={};return t.imgWH=e.imgWH,t.fotoPosition={x:e._fotoPosition.x,y:e._fotoPosition.y},t.fotoWH=e.fotoWH,t.maxHeight=e.maxHeight,t.isDinamFotoRect=e.isDinamFotoRect,t.arrDataSempl=e.arrDataSempl,t.opacityMat=e.opacityMat,t.dunamic=e.dunamic,t.canvasGG={arrColorStopTranspanent:e.canvasGG.arrColorStopTranspanent,arrProcent:e.canvasGG.arrProcent},t},this.setConfig=function(t){e.canvasGG.arrColorStopTranspanent=t.canvasGG.arrColorStopTranspanent,e.canvasGG.arrProcent=t.canvasGG.arrProcent,e.fotoPosition.x=t.fotoPosition.x,e.fotoPosition.y=t.fotoPosition.y,e.fotoWH=t.fotoWH,e.isDinamFotoRect=t.isDinamFotoRect,e.arrDataSempl=t.arrDataSempl,e.opacityMat=t.opacityMat,e.imgWH=t.imgWH,e.dunamic=t.dunamic,e.updateShadowTexture(),e.maxHeight=t.maxHeight};var C={imgWH:1024,fotoPosition:{x:0,y:0},fotoWH:150,maxHeight:300,isDinamFotoRect:!1,arrDataSempl:[{min:0,max:6,blur:.8,alpha:.25},{min:4,max:15,blur:3,alpha:.64},{min:10,max:23,blur:4,alpha:.5},{min:15,max:50,blur:15,alpha:1},{min:20,max:198.09,blur:15,alpha:.7},{min:0,max:2,blur:1.02,alpha:1}],opacityMat:1,dunamic:!0,canvasGG:{arrColorStopTranspanent:[0,1,.25],arrProcent:[.4,1,.96]}};function j(t,e,i,n,s,a,r,o){return t<s+r&&e<a+o&&t+i>s&&e+n>a}function D(t,e,i,n){return e=null!=e?e:0,i=null!=i?i:100,n=n||100,isNaN(parseFloat(t))&&(t=e),t<e&&(t=e),t>i&&(t=i),t=Math.round(t*n)/n,e<0?100*(Math.abs(e)+t)/(Math.abs(e)+Math.abs(i)||1):100*(Math.abs(e)-t)/(Math.abs(e)-Math.abs(i)||1)}this.sss=C,this.setConfig(C),this.getBase64=function(){return e.render(),p.canvas.toDataURL()},this.debug=!1}function o(t,e,i,n){this.min=t||0,this.max=e||1,this.blur=i||0,this.alpha=n||1}function h(){var t=this,e=document.createElement("canvas");this.canvas=e,e.width=256,e.height=256;var i=e.getContext("2d"),n=new Image;this.b64=null,this._blur=0,this._blur1=1,this._alpha=1,this.image=new Image,this.setBase64=function(i,s){this.b64=i,(n=new Image).onload=function(){e.clearRect(0,0,e.width,e.height),e.width=n.width,e.height=n.height,t.update(),s&&s(e.toDataURL())},n.src=i},this.setCanvas=function(t){n=t,e.width=t.width,e.height=t.height},this.update=function(){i.filter="blur("+t._blur+"px)",i.globalAlpha=t._alpha,i.drawImage(n,0,0)}}function l(){var t=this,e=document.createElement("canvas");e.width=e.height=256,this.canvas=e;var i=e.getContext("2d");this._blur=0,this._alpha=1,this.arrColorStopTranspanent=[0,1],this.arrProcent=[0,1],this.position=new THREE.Vector2,this.position1=new THREE.Vector2(1,0),this.r=0,this.g=0,this.b=0,this.update=function(){var n=e.width,s=e.height;i.clearRect(0,0,n,s),i.rect(0,0,n,s),i.filter="blur("+t._blur+"px)",i.globalAlpha=t._alpha;for(var a=t.position.x*n,r=t.position.y*s,o=t.position1.x*n,h=t.position1.y*s,l=i.createLinearGradient(a,r,o,h),u=0;u<t.arrColorStopTranspanent.length;u++)l.addColorStop(t.arrProcent[u],"rgba("+t.r+","+t.g+","+t.b+","+t.arrColorStopTranspanent[u]+")");i.fillStyle=l,i.fill()},this.update()}function u(t){this.parent=t;this._active=!1,this._visible=!0,this.WH=512,this._wn=this.WH,this._obj3d=void 0,this.smc=void 0,this.init=function(){null==this.smc&&(this.smc=new r,this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn,this.smc.content3d.rotation.x=-Math.PI/2,this.smc.content3d.position.y=-1,this.smc.content3d.visible=this._visible,this.dergObj())},this.dergActiv=function(){1==this._active?null==this.smc.content3d.parent&&this.parent.parent.groupObject.add(this.smc.content3d):null!=this.smc.content3d.parent&&this.parent.parent.groupObject.remove(this.smc.content3d)},this.render=function(){null!=this.smc&&null!=this.smc.content3d.parent&&this.smc.upDate()},this.dergObj=function(){null!=this.smc&&(null!=this._obj3d?this.smc.arrObj[0]==this._obj3d||(this.smc.clear(),this.smc.addObj(this._obj3d)):this.smc.clear())}}function c(t){var e=this;this.visi3D=t,this.box3=new THREE.Box3,this.rectScreen=new p,this.world=new p(0,0,100,100),this.targetObject=null,this.arrPoint=[],this.isMoveCam=!1,this.isFromGeometry=!1,this._offset=0,this._active=!0,this._debug=!1;var i=new THREE.Vector2,n=new THREE.Vector2,s=new THREE.Vector3;function a(){e.zumeVisi3D(),i.set(e.world.x+e.world.width/2,e.world.y+e.world.height/2),n.set(e.rectScreen.x+e.rectScreen.width/2,e.rectScreen.y+e.rectScreen.height/2),i.sub(n).divideScalar(2)}this.upDate=function(){if(e.active&&(this.updateBound3d(),!e.box3.isEmpty())){if(this.visi3D.xVerh=s.x,this.visi3D.zVerh=s.z,this.visi3D.yVerh=-s.y,e.zumeVisi3D(),e.isMoveCam){a();for(var t=0;i.length()>2&&++t<10;)this.visi3D.position3d.moveCamXY(i),a()}e.debugFocus&&e.debugFocus.upDate()}},this.zumeVisi3D=function(){for(var t,i,n=0,s=6e4,a=0;n<s&&!(++a>20)&&(i=t=(n+s)/2,e.visi3D.zume=i,!(Math.abs(n-t)<.01||Math.abs(s-t)<.01||t<.01));)e.updateRectScreen(),e.isZoomIn()?s=t:n=t+1},this.updateBound3d=function(){if(e.box3.makeEmpty(),e.targetObject)e.box3.copy(e.getCompoundBoundingBox(e.targetObject));else for(var t=0;t<e.arrPoint.length;t++)e.box3.expandByPoint(e.arrPoint[t]);e.box3.getCenter(s)},this.updateRectScreen=function(){if(this.visi3D.camera.updateMatrixWorld(),this.visi3D.scene.updateMatrixWorld(),e.targetObject&&e.isFromGeometry){var t=e.getBoxObject(e.targetObject);e.box3.copy(t.box3),e.box3.getCenter(s),e.setRectFromBox(e.rectScreen,t.box2)}else e.setRectFromBox(e.rectScreen,e.boxToScreen(e.box3));e.updateWorldSize()},this.setRectFromBox=function(t,e){t.x=e.min.x,t.y=e.min.y,t.width=e.max.x-e.min.x,t.height=e.max.y-e.min.y},this.getCompoundBoundingBox=function(){var t=new THREE.Box3,e=new THREE.Box3;function i(i){var n=i.geometry;void 0!==n&&(n.boundingBox||n.computeBoundingBox(),e.copy(n.boundingBox),e.applyMatrix4(i.matrixWorld),t.union(e))}return function(e){return e.updateMatrixWorld(!0),t.makeEmpty(),e.traverseVisible(i),t}}(),this.boxToScreen=function(){for(var t=new THREE.Box2,i=[],n=0;n<8;n++)i[n]=new THREE.Vector3;return function(n){t.makeEmpty(),i[0].set(n.min.x,n.min.y,n.min.z),i[1].set(n.min.x,n.max.y,n.min.z),i[2].set(n.max.x,n.min.y,n.min.z),i[3].set(n.max.x,n.max.y,n.min.z),i[4].set(n.min.x,n.min.y,n.max.z),i[5].set(n.min.x,n.max.y,n.max.z),i[6].set(n.max.x,n.min.y,n.max.z),i[7].set(n.max.x,n.max.y,n.max.z);for(var s=0;s<i.length;s++)t.expandByPoint(e.toScreenXY(i[s]));return t}}(),this.getBoxObject=function(){var t,i,n=new THREE.Box2,s=new THREE.Box3,a={box2:n,box3:s},r=new THREE.Vector3;function o(a){var o=a.geometry;if(void 0!==o)if(o.isGeometry){var h=o.vertices;for(t=0,i=h.length;t<i;t++)r.copy(h[t]).applyMatrix4(a.matrixWorld),s.expandByPoint(r),n.expandByPoint(e.toScreenXY(r))}else if(o.isBufferGeometry){var l=o.attributes.position;if(void 0!==l)for(t=0,i=l.count;t<i;t++)r.fromBufferAttribute(l,t).applyMatrix4(a.matrixWorld),s.expandByPoint(r),n.expandByPoint(e.toScreenXY(r))}}return function(t){return t.updateMatrixWorld(!0),n.makeEmpty(),s.makeEmpty(),t.traverseVisible(o),a}}();var r=new THREE.Vector2,o=new THREE.Vector3;this.toScreenXY=function(t){return o.copy(t),o.project(e.visi3D.camera),r.x=Math.round((o.x+1)*e.visi3D._width/2),r.y=Math.round((1-o.y)*e.visi3D._height/2),r},this.updateWorldSize=function(){e.world.x=e.offset,e.world.y=e.offset,e.world.width=this.visi3D._width-2*e.offset,e.world.height=this.visi3D._height-2*e.offset},this.isZoomIn=function(){return e.rectScreen.x>e.world.x&&e.rectScreen.x+e.rectScreen.width<e.world.x+e.world.width&&e.rectScreen.y>e.world.y&&e.rectScreen.y+e.rectScreen.height<e.world.y+e.world.height}}function d(t){var e=this;this.mFocus=t;var i=visi3D.scene,n=main.stage,s=new BoxHelper(1,materialAlphaRed);i.add(s);var a=new PIXI.Graphics;a.hitArea=new PIXI.Rectangle(0,0,0,0),n.addChild(a),e.active=!1,s.visible=a.visible=e.active,this.upDate=function(){s.visible=a.visible=e.active,e.active&&(a.clear(),a.position.set(visi3D._x,visi3D._y),a.lineStyle(1,0,1),a.drawRect(t.world.x,t.world.y,t.world.width,t.world.height),a.lineStyle(1,16711680,1),a.drawRect(t.rectScreen.x,t.rectScreen.y,t.rectScreen.width,t.rectScreen.height),s.width=t.box3.max.x-t.box3.min.x,s.depth=t.box3.max.y-t.box3.min.y,s.height=t.box3.max.z-t.box3.min.z,t.box3.getCenter(s.position))}}function p(t,e,i,n,s){this._x=t||0,this._y=e||0,this._width=void 0!==i?i:100,this._height=void 0!==n?n:100,this.angel=0,this.p=new f,this.fun,this.set=function(t,e,i,n){this._x=t||0,this._y=e||0,this._width=void 0!==i?i:100,this._height=void 0!==n?n:100},this.setRect=function(t){this._x=t.x,this._y=t.y,this._width=t.width,this._height=t.height,this.p.setPoint(t.p),this.angel=t.angel}}function f(t,e,i){this._x=t||0,this._y=e||0,this._z=i||0,this.xx=0,this.yy=0,this.zz=0,this.set=function(t,e,i){this._x=t||0,this._y=e||0,void 0!==i&&(this._z=i)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new f(this._x,this._y,this._z)}}function m(t){var e=this;this.parent=t,this._debug=!1,this.debugInit=!1,this.shadowHelper=void 0,this.spotLightHelper=void 0,this.gridHelper=void 0,this.FIXATION=!1,this.ROTATION_X=0,this.ROTATION_Z=0,this.DISTANCE=this.parent.DISTANCE,this.CUB_HEIGHT=this.parent.CUB_HEIGHT,this.CUB_WIDTH=this.parent.CUB_WIDTH,this.SKY_X=0,this.SKY_Y=0,this.SKY_Z=0,this._fixation=this.FIXATION,this._rotationX=this.ROTATION_X,this._rotationZ=this.ROTATION_Z,this._distance=this.DISTANCE,this._cubHeight=this.CUB_HEIGHT,this._cubWidth=this.CUB_WIDTH,this.sky=new s(this),this.smc=new u(this),this.focus=new c(this.parent),this.funDebug=function(){1!=this.debugInit&&(this.debugInit=!0,this.plane=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e3,1e3).rotateX(-Math.PI),new THREE.MeshPhongMaterial({color:11316396,transparent:!0,opacity:.5})),this.plane.castShadow=this.plane.receiveShadow=!0,this.plane.position.z=2,this.plane.renderOrder=1,this.gridHelper=new THREE.GridHelper(1e3,10),this.gridHelper.rotation.x=-Math.PI/2,this.shadowHelper=new THREE.CameraHelper(this.parent.sunLight.shadow.camera),this.parent.sunLight&&(this.spotLightHelper=new THREE.DirectionalLightHelper(this.parent.sunLight))),1==this._debug?(null==this.gridHelper.parent&&this.parent.groupObject.add(this.gridHelper),null==this.plane.parent&&this.parent.groupObject.add(this.plane),null==this.shadowHelper.parent&&this.parent.scene.add(this.shadowHelper),this.parent.sunLight&&(null!=this.parent.sunLight.parent||(null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper)))):(null!=this.gridHelper.parent&&this.parent.groupObject.remove(this.gridHelper),null!=this.plane.parent&&this.parent.groupObject.remove(this.plane),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper),this.parent.sunLight&&null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper))},this.render=function(){1==this._debug&&null!=this.spotLightHelper&&this.spotLightHelper.update(),this.smc.render(),this.sky.render(),this.focus.upDate(),this.dragSunLight()};var i=0;this.dragSunLight=function(){var t;null!=this.parent.sunLight&&(null!=this.parent.sunLight.parent&&(!0===e._fixation?(i=this._distance+2*this._cubHeight,e.parent.sunLight.position.set(0,i,0),e.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),e._rotationX),e.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),e._rotationZ-e.parent._rotationZ)):(i=this._distance+this._cubHeight,this.parent.sunLight.position.set(0,i,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ),this.parent.staticShadow&&(t=new THREE.Vector3(e.parent.xVerh,e.parent.yVerh,e.parent.zVerh),e.parent.sunLight.position.add(t),e.parent.sunLight.target.position.copy(t),n.distanceTo(t)>e.distanceUpdateShadow&&(n.copy(t),e.parent.shadowNeedsUpdate=!0)))))};var n=new THREE.Vector3;this.distanceUpdateShadow=500,this.dragSunLight2=function(){null!=this.parent.sunLight&&null!=this.parent.sunLight.parent&&(!0===this._fixation||(i=this._distance+2*this._cubHeight,this.parent.sunLight.position.set(0,i,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ)))},this.dragSunLight3=function(){this.parent.sunLight&&(this.parent.sunLight.shadow.camera.near=0+this._cubHeight,this.parent.sunLight.shadow.camera.far=2*this._cubHeight+this._cubHeight,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update())},this.sunActiv=function(t){this.parent.objShadow(this.parent.group,t),1==t?null==this.parent.sunLight.parent&&(this.parent.scene.add(this.parent.sunLight),this.parent.scene.add(e.parent.sunLight.target)):null!=this.parent.sunLight.parent&&(this.parent.scene.remove(this.parent.sunLight),this.parent.scene.remove(e.parent.sunLight.target)),this.funDebug()},this.ambientActiv=function(t){1==t?null==this.parent.ambientLight.parent&&this.parent.scene.add(this.parent.ambientLight):null!=this.parent.ambientLight.parent&&this.parent.scene.remove(this.parent.ambientLight)}}s.prototype={set x(t){this._x!==t&&(this._x=t,this.cont3d.position.x=t,this.parent.parent.intRend=1)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t,this.cont3d.position.y=t,this.parent.parent.intRend=1)},get y(){return this._y},set z(t){this._z!==t&&(this._z=t,this.cont3d.position.z=t,this.parent.parent.intRend=1)},get z(){return this._z},set active(t){this._active!==t&&(this._active=t,this.init(),this.dergActiv())},get active(){return this._active},set radius(t){this._radius!==t&&(this._radius=t,null!=this.mesh&&this.mesh.scale.set(this._radius,this._radius,this._radius))},get radius(){return this._radius},set link(t){this._link!==t&&(this._link=t,this.init(),this.dergLink())},get link(){return this._link},set color(t){if(this._color!==t){this._color=t,this.init();var e=this._color;if("string"==typeof e&&-1!=e.indexOf("x")){var i=e.split("x");e="#"+i[1]}this.material.color=new THREE.Color(e)}},get color(){return this._color}},Object.defineProperties(r.prototype,{scaleShadow:{set:function(t){this.dirty=!0,this._scaleShadow=t},get:function(){return this._scaleShadow}},debug:{set:function(t){this.helpers.visible=t},get:function(){return this.helpers.visible}},offsetY:{set:function(t){this._offsetY=t,this.dirty=!0},get:function(){return this._offsetY}},maxHeight:{set:function(t){this.dirty=!0,this.boundingBoxUv.max.y=t,this.updateShadowUv()},get:function(){return this.boundingBoxUv.max.y}},dunamic:{set:function(t){this.dirty=!0,this._dunamic=t},get:function(){return this._dunamic}},fotoPosition:{set:function(t){this.dirty=!0,this._fotoPosition=t},get:function(){return this._fotoPosition}},fotoWH:{set:function(t){this.dirty=!0,this._fotoWH=t},get:function(){return this._fotoWH}},imgWH:{set:function(t){this.dirty=!0,this._imgWH=t},get:function(){return this._imgWH}},imgBlur:{set:function(t){this.dirty=!0,this._imgBlur=t},get:function(){return this.dirty=!0,this._imgBlur}},imgAlpha:{set:function(t){this.dirty=!0,this._imgAlpha=t},get:function(){return this._imgAlpha}},isDinamFotoRect:{set:function(t){this.dirty=!0,this._isDinamFotoRect=t},get:function(){return this._isDinamFotoRect}},opacityMat:{set:function(t){this.dirty=!0,this._opacityMat=t,this.matPlan.opacity=this._opacityMat},get:function(){return this._opacityMat}},shadowMaterial:{set:function(t){if(t!==this._shadowMaterial){this._shadowMaterial=t;for(var e=0;e<this.arrShadowMesh.length;e++)if(this.arrShadowMesh[e]instanceof THREE.ShadowMesh)this.arrShadowMesh[e].material=this._shadowMaterial;else for(var i=0;i<this.arrShadowMesh[e].children.length;i++)this.arrShadowMesh[e].children[i]instanceof THREE.ShadowMesh&&(this.arrShadowMesh[e].children[i].material=this._shadowMaterial)}},get:function(){return this._shadowMaterial}},lightPosition4D:{set:function(t){this._lightPosition4D.set(t.x,t.y,t.z,.001)},get:function(){return this._lightPosition4D}}}),Object.defineProperties(h.prototype,{blur:{set:function(t){this._blur=t},get:function(){return this._blur}},alpha:{set:function(t){this._alpha=t},get:function(){return this._alpha}}}),Object.defineProperties(l.prototype,{}),u.prototype={set active(t){this._active!==t&&(this._active=t,this.init(),this.dergActiv())},get active(){return this._active},set visible(t){this._visible!==t&&(this._visible=t,null!=this.smc&&(this.smc.content3d.visible=t))},get visible(){return this._visible},set obj3d(t){this._obj3d!==t&&(this._obj3d=t,this.dergObj())},get obj3d(){return this._obj3d},set wh(t){this._wh!==t&&(this._wh=t,null!=this.smc&&(this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn))},get wh(){return this._wh}},c.prototype={set offset(t){this._offset=t||0},get offset(){return this._offset},set debug(t){this._debug=t,t&&!this.debugFocus&&(this.debugFocus=new d(this)),this.debugFocus&&(this.debugFocus.active=t)},get debug(){return this._debug},set active(t){this._active=t,t||(this.debug=!1)},get active(){return this._active}},p.prototype={set x(t){this._x!==t&&(this._x=t)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t)},get y(){return this._y},set width(t){this._width!==t&&(this._width=t)},get width(){return this._width},set height(t){this._height!==t&&(this._height=t)},get height(){return this._height}},f.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},i.d(e,"a",function(){return m}),m.prototype={set debug(t){this._debug!==t&&(this._debug=t,this.funDebug())},get debug(){return this._debug},set rotationX(t){this._rotationX!==t&&(this._rotationX=t,null!=this.spotLightHelper&&(this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.spotLightHelper.update()),this.dragSunLight2())},get rotationX(){return this._rotationX},set rotationZ(t){this._rotationZ!==t&&(this._rotationZ=t,this.sky.shadRotZ=t,null!=this.spotLightHelper&&this.spotLightHelper.update(),this.dragSunLight2())},get rotationZ(){return this._rotationZ},set fixation(t){this._fixation!==t&&(this._fixation=t,this.dragSunLight2())},get fixation(){return this._fixation},set distance(t){this._distance!==t&&(this._distance=t,this.dragSunLight3(),this.dragSunLight2())},get distance(){return this._distance},set cubHeight(t){this._cubHeight!==t&&(this._cubHeight=t,this.dragSunLight3(),this.dragSunLight2())},get cubHeight(){return this._cubHeight},set cubWidth(t){this._cubWidth!==t&&(this._cubWidth=t,this.parent.sunLight&&(this.parent.sunLight.shadow.camera.right=this._cubWidth,this.parent.sunLight.shadow.camera.left=-this._cubWidth,this.parent.sunLight.shadow.camera.top=this._cubWidth,this.parent.sunLight.shadow.camera.bottom=-this._cubWidth,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update()))},get cubWidth(){return this._cubWidth}}},function(t,e,i){"use strict";function n(){this.event=void 0,this.arrSobName=["up","down","move","out","over","wheel"],this.arrSob=[[],[],[],[],[],[]],this.pozSob=void 0,this.dispatcherEvent=function(t,e){for(var i=0;i<this.arrSobName.length;i++)if(this.arrSobName[i]==t){e&&(e.type=t);for(var n=0;n<this.arrSob[i].length;n++)this.arrSob[i][n](e)}},this.removeEvent=function(t,e){for(var i=0;i<this.arrSobName.length;i++)if(this.arrSobName[i]==t)for(var n=0;n<this.arrSob[i].length;n++)this.arrSob[i][n]==e&&this.arrSob[i].splice(n,1)},this.addEvent=function(t,e){for(var i=0;i<this.arrSobName.length;i++)this.arrSobName[i]==t&&this.arrSob[i].push(e)}}function s(){this.target=void 0,this.face=void 0,this.point=void 0,this.faceIndex=void 0,this.type=void 0,this.uv=void 0,this.originalEvent=void 0,this.copy=function(){var t=new s;return t.target=this.target,t.face=this.face,t.point=this.point,t.faceIndex=this.faceIndex,t.type=this.type,t.uv=this.uv,t.originalEvent=this.originalEvent,t}}function a(t,e,i,a){this.parent=t;var r,o,h=this;this.camera=e,this.raycaster=new THREE.Raycaster,this.intersects,this.devas=t.devas,this.point=new THREE.Vector2(0,0),this.pointWH=new THREE.Vector2(0,0),this.arrChild=[],this.uuid="nullMy",this.obj3d,this.eventSob=new n,this.event3D=new s,this.xzNull="xzNull",this.poiskName="xzPoisk",this.tokoName="null",this._activ=!0,this.rect={x:0,y:0,width:100,height:100},this.cont=void 0,this.div=void 0,this.setRect=function(t,e,i,n){this.rect.x=t,this.rect.y=e,this.rect.width=i,this.rect.height=n},this.removeChild=function(t){r=null;for(var e=0;e<this.arrChild.length;e++)t.uuid==this.arrChild[e].uuid&&(r=this.arrChild.splice(e,1),(e-=1)<0&&(e=0));return r},this.addChild=function(t){this.removeChild(t),this.arrChild.push(t)},this.boolNum=-1,this.boolNumOld=-1,this.event,this.mouseRay=function(){0!=this._activ&&(this.rayPusk(),this.boolNum=this.getGoodParam(),-1==this.boolNum?"nullMy"!=this.uuid&&(this.eventSob.dispatcherEvent("out",this.event3D),this.uuid="nullMy"):"nullMy"!=this.uuid?this.uuid!=this.intersects[this.boolNum].object.uuid?(this.eventSob.dispatcherEvent("out",this.event3D),this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("over",this.event3D)):(this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("move",this.event3D)):(this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("over",this.event3D)),this.boolNumOld=this.boolNum)},this.getPosition=function(t){var e=this.poiskName;if(this.poiskName=null!=t?t:"xzPoisk",this.restartPoint(),this.rayPusk(),this.poiskName=e,0!=this.intersects.length){var i=this.intersects.length-1;return-1==i&&(i=0),this.intersects[i]}return null};var l=new s;this.getNameEvent=function(t){if(this.restartPoint(),this.rayPusk(),0!=this.intersects.length)for(var e=0;e<this.intersects.length;e++)if(null!=this.intersects[e].object.parent&&this.intersects[e].object.name==t)return l.target=this.intersects[this.boolNum].object,l.face=this.intersects[this.boolNum].face,l.point=this.intersects[this.boolNum].point,l.faceIndex=this.intersects[this.boolNum].faceIndex,l.uv=this.intersects[this.boolNum].uv,l.originalEvent=h.event,l;return null},this.testVisiParam=function(t){return 0!=t.visible&&(!t.notEvent&&(null!=t.parent?this.testVisiParam(t.parent):"Scene"==t.type))},this.getGoodParam=function(){if(0!=this.intersects.length){var t;for(t=0;t<this.intersects.length;t++)0!=this.testVisiParam(this.intersects[t].object)&&null!=this.intersects[t].object.notActiv&&(this.intersects.splice(t,1),t=0);if(0==this.intersects.length)return-1;for(t=0;t<this.intersects.length;t++)if(0!=this.testVisiParam(this.intersects[t].object)&&this.intersects[t].object.name==this.poiskName)return t;for(t=0;t<this.intersects.length;t++)if(0!=this.testVisiParam(this.intersects[t].object)&&this.intersects[t].object.name!=this.xzNull)return t}return-1},this.rayPusk=function(){(o=new THREE.Vector3).setFromMatrixPosition(this.camera.matrixWorld),this.raycaster.ray.origin.copy(o),this.raycaster.ray.direction.set(this.point.x,this.point.y,.5).unproject(this.camera).sub(o).normalize(),this.intersects=this.raycaster.intersectObjects(this.arrChild,!0)},this.naCont=!1,this.mousemove=function(t){0==h.devas&&0==h.naCont||(null!=t.data?h.event=t.data.originalEvent:h.event=t,0!=h._activ&&(h.restartPoint(t),h.mouseRay(),h.intersects.length&&0==h.devas&&h.event.preventDefault()))},this.zdvigX=0,this.scale=1,this.pV=new THREE.Vector2(0,0);var u={x:0,y:0};this.restartPoint=function(t){t&&t.target&&(u=t.target.getBoundingClientRect()),0==h.devas?(h.pV.x=t.clientX,h.pV.y=t.clientY):(h.pV.x=t.touches[0].clientX,h.pV.y=t.touches[0].clientY),h.pV.x-=u.x,h.pV.y-=u.y,1==h.isRect(h.pV)?(h.point.x=-(this.rect.x-h.pV.x)/this.rect.width*2-1,h.point.y=-(-(this.rect.y-h.pV.y)/this.rect.height*2-1)):99999!=h.point.x&&(h.point.x=99999)},this.isRect=function(t){return t.x>=this.rect.x&&t.x<=this.rect.x+this.rect.width&&t.y>=this.rect.y&&t.y<=this.rect.y+this.rect.height},this.mouseup=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.intersects&&0!=h._activ&&(0==h.devas?(-1==h.boolNumOld?h.eventSob.dispatcherEvent("up",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("up",h.event3D)),h.intersects.length&&h.event.preventDefault()):(h.mouseRay(),-1==h.boolNumOld?h.eventSob.dispatcherEvent("up",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("up",h.event3D),h.uuid="nullMy")))},this.mousedown=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.restartPoint(t),0!=h._activ&&(0==h.devas?(-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("down",h.event3D)),h.intersects.length&&h.event.preventDefault()):(h.mouseRay(),-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("down",h.event3D))))},this.mouseout=function(t){h.naCont=!1,h.restartPoint(t),h.point.x=99999,h.mouseRay()},this.mouseover=function(t){h.naCont=!0,h.restartPoint(t),h.mouseRay()},this.touchend=function(t){},this.mousewheel=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.restartPoint(t),0!=h._activ&&(-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("wheel",t)))},this.addDragEvent=function(t,e){this.cont=t,this.div=e,0==h.devas?(window.addEventListener("mouseup",h.mouseup),e.addEventListener("mousedown",h.mousedown),e.addEventListener("mouseout",h.mouseout),e.addEventListener("mouseover",h.mouseover)):(window.addEventListener("touchend",h.mouseup),e.addEventListener("touchstart",h.mousedown))},this.sizeWindow=function(t,e){this.pointWH.x=t,this.pointWH.y=e}}i.d(e,"a",function(){return a}),a.prototype={set activ(t){this._activ!=t&&(this._activ=t)},get activ(){return this._activ}}},function(t,e,i){"use strict";i.r(e),function(t){var n=i(1);i.d(e,"Main",function(){return n.a}),t.Main=n.a}.call(this,i(10))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i}]);